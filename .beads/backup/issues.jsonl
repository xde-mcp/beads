{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"4aeab5938222c2c44ca84cef8c20a75ff240258f516254571536e57c06caa069","created_at":"2026-02-28T02:48:56Z","created_by":"beads/polecats/obsidian","crystallizes":0,"defer_until":null,"description":"The Storage interface (storage.go) is clean but the Dolt implementation uses Dolt-specific features extensively without abstraction: DOLT_COMMIT, DOLT_PUSH/PULL/FETCH, dolt_diff(), dolt_history_*, dolt_branches, dolt_log, DOLT_HASHOF, DOLT_CONFLICTS_RESOLVE, AS OF syntax. These are used in versioned.go, federation.go, history.go, store.go. If a non-Dolt backend is ever needed, the VersionedStorage and FederatedStorage interfaces would need to be optional capabilities, not assumed.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-019","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Dolt-specific procedures not behind interface - blocks portability","updated_at":"2026-02-28T02:48:56Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"4caf76e72bb1ce8e67770f8942394692fd8951036cbaabc6dfaeb2590c2c9cea","created_at":"2025-12-17T02:17:18Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Code health review found several oversized files:\n\n1. doctor.go - 2948 lines, 48 functions mixed together\n   - Should split into doctor/checks/*.go for individual diagnostics\n   - applyFixes() and previewFixes() are nearly identical\n\n2. sync.go - 2121 lines\n   - ZFC (Zero Flush Check) logic embedded inline (lines 213-247)\n   - Multiple mode handlers should be extracted\n\n3. init.go - 1732 lines\n4. compact.go - 1097 lines\n5. show.go - 1069 lines\n\nRecommendation: Extract into focused sub-packages or split into logical files.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-05a8","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Split large cmd/bd files: doctor.go (2948 lines), sync.go (2121 lines)","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/obsidian","await_id":"","await_type":"","close_reason":"Merged to main (commit 0cb7936f). Circuit breaker implemented by obsidian, MR bd-wisp-hcao82 merged by refinery.","closed_at":"2026-02-27T23:31:00Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"4af3e1fd194852752d2bb6ec329f71b7f3750a4ada530319ec0b63192f55bcfd","created_at":"2026-02-26T01:48:05Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"When Dolt is down, every agent independently retries for 30 seconds before failing. With N agents, that's N√ó30s of wasted time and connection storms. Implement a circuit breaker: after K consecutive failures within T seconds, trip the breaker and fail-fast for a cooldown period. Options: (1) file-based shared state in /tmp, (2) in-process with cenkalti/backoff already in deps, (3) lightweight lockfile protocol. The breaker should log clearly when tripped/reset so agents know why bd commands are failing fast.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-05an","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implemented file-based circuit breaker for Dolt connections. State shared at /tmp/beads-dolt-circuit-\u003cport\u003e.json. Trips after 5 consecutive connection failures in 60s, 30s cooldown before half-open probe. Integrated into withRetry() and newServerMode(). Added isConnectionError() to distinguish server-down errors from query errors. OTel metrics: circuit_trips, circuit_rejected. 12 new unit tests, all passing.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"P1: Circuit breaker for Dolt server connections","updated_at":"2026-02-27T23:31:00Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"1e0ea66e6681fb63ae1f868832c6d32744001b9d84c34070f01686e72a3f6d76","created_at":"2025-12-14T22:25:28Z","created_by":"","crystallizes":0,"defer_until":null,"description":"PR #551 persists close_reason, but the CLI documentation may not mention this field as part of the issue schema.\n\n## Current State\n- close_reason is now persisted in database\n- `bd show --json` will return close_reason in JSON output\n- Documentation may not reflect this new field\n\n## What's Missing\n- CLI reference documentation for close_reason field\n- Schema documentation showing close_reason is a top-level issue field\n- Example output showing close_reason in bd show --json\n- bd close command documentation should mention close_reason parameter is optional\n\n## Suggested Action\n1. Update README.md or CLI reference docs to list close_reason as an issue field\n2. Add example to bd close documentation\n3. Update any type definitions or schema specs\n4. Consider adding close_reason to verbose list output (bd list --verbose)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-077e","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Add close_reason field to CLI schema and documentation","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"f3c4f561947ae8c527e362271a27cd70c6fb66c844b0614bbb805d325dec8b2e","created_at":"2025-11-12T11:20:26Z","created_by":"","crystallizes":0,"defer_until":null,"description":"bd doctor should detect old beads integration patterns and recommend migrating to bd prime approach.\n\n## Current behavior\n- bd doctor checks if Claude hooks are installed globally\n- Doesn't check project-level integration (AGENTS.md, CLAUDE.md)\n- Doesn't recommend migration for repos using old patterns\n\n## Desired behavior\nbd doctor should detect and suggest:\n\n1. **Old slash command pattern detected**\n   - Check for /beads:* references in AGENTS.md, CLAUDE.md\n   - Suggest: These slash commands are deprecated, use bd prime hooks instead\n   \n2. **No agent documentation**\n   - Check if AGENTS.md or CLAUDE.md exists\n   - Suggest: Run 'bd onboard' or 'bd setup claude' to document workflow\n   \n3. **Old MCP-only pattern**\n   - Check for instructions to use MCP tools but no bd prime hooks\n   - Suggest: Add bd prime hooks for better token efficiency\n\n4. **Migration path**\n   - Show: 'Run bd setup claude to add SessionStart/PreCompact hooks'\n   - Show: 'Update AGENTS.md to reference bd prime instead of slash commands'\n\n## Example output\n\n‚ö† Warning: Old beads integration detected in CLAUDE.md\n  Found: /beads:* slash command references (deprecated)\n  Recommend: Migrate to bd prime hooks for better token efficiency\n  Fix: Run 'bd setup claude' and update CLAUDE.md\n\nüí° Tip: bd prime + hooks reduces token usage by 80-99% vs slash commands\n  MCP mode: ~50 tokens vs ~10.5k for full MCP scan\n  CLI mode: ~1-2k tokens with automatic context recovery\n\n## Benefits\n- Helps existing repos adopt new best practices\n- Clear migration path for users\n- Better token efficiency messaging","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-0fvq","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"bd doctor should recommend bd prime migration for existing repos","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/garnet","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-28T00:35:36Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"912c64bf670b82c5e99c4c21a45f4b85412fd6b1519774882d4e5487bf49970a","created_at":"2026-02-27T23:11:05Z","created_by":"beads/refinery","crystallizes":0,"defer_until":null,"description":"cmd/bd/migrate_safety.go:100:22: address format \"%s:%d\" does not work with IPv6 (passed to net.Dial at L103). This should use net.JoinHostPort() instead of fmt.Sprintf.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-0tn","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Fixed: replaced fmt.Sprintf(\"%s:%d\", host, port) with net.JoinHostPort in two locations in migrate_safety.go (verifyServerTarget line 100, verifyMigrationData line 211). go vet now passes clean.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Pre-existing: go vet IPv6 format warning in migrate_safety.go","updated_at":"2026-02-28T00:41:29Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"test pollution","closed_at":"2026-02-28T03:52:45Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"872d448349e97f282f21ddd6ea853f4c73bf2e1b0f1b4eb130b628842ec3d65b","created_at":"2026-02-27T22:59:07Z","created_by":"","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-1","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Test Issue","updated_at":"2026-02-28T03:52:45Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"test pollution","closed_at":"2026-02-28T03:52:45Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"3c5d1f3318871b1a02e3c0fb8277ecd4f931ab963eaba44bbdb365fb224553e6","created_at":"2026-02-27T22:59:07Z","created_by":"","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-10","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Test Issue 3","updated_at":"2026-02-28T03:52:45Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Not a bug: compact.go already uses types.StatusClosed (line 56) and reads config via getCompactDays() (line 64). Hardcoded defaults are only fallbacks.","closed_at":"2026-03-01T05:46:13Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"0cb344bc15feac55cc21d9086ded983ab17fade2bf608ae63dec98b079a51554","created_at":"2026-02-28T02:48:46Z","created_by":"beads/polecats/obsidian","crystallizes":0,"defer_until":null,"description":"compact.go:35 compares status \\!= 'closed' as a raw string instead of using types.StatusClosed constant. Also compact.go:49,59 hardcode compaction thresholds (30, 90 days) despite config keys existing (compact_tier1_days, compact_tier2_days) - the config values are never read.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-17p","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"compact.go uses string literal 'closed' instead of types.StatusClosed","updated_at":"2026-03-01T05:46:13Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/jasper","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-28T00:33:16Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"31c0049b75846fb03f23760e60e93eb18609da1ca871089bb4ec4796e98001fb","created_at":"2026-02-28T00:21:25Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"Tests in internal/utils/id_parser_test.go create issues with prefixes offlinebrew-, aap-, cr-, hq-abc12, and a wisp bd-wisp-t3st in shared test stores. These leak to production when the shared store connects to port 3307. Root cause of recurring test pollution. Fix: use isolated temporary databases per test, or at minimum clean up created issues in test teardown.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-19i","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Fixed: Added TestMain to internal/utils/ that starts an isolated test Dolt server on a dynamic port. Updated newTestStore to use testServerPort and unique testdb_ database names. Tests no longer connect to production port 3307. Registered utils-pkg-test-* in orphaned temp dir cleanup.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"id_parser_test.go creates real issues in shared database without isolation","updated_at":"2026-02-28T00:41:17Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"bd-1lc already pushed directly to main by quartz (commit adb8e763). Recovery MR no longer needed.","closed_at":"2026-02-28T05:16:06Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"96082b874ecec4d51d28e79bdc96b92c78e4359cbf8b9b59da6c653d38971822","created_at":"2026-02-28T05:05:22Z","created_by":"beads/witness","crystallizes":0,"defer_until":null,"description":"Branch: recover/bd-1lc\nSource issue: bd-1lc\nCommit: 0439e8cc fix: remove operational constants from defaultConfig in schema.go\n\nRecovered after polecat nuke deleted original branch. Same nuke-before-merge race condition.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-1f2","is_template":0,"issue_type":"merge-request","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Merge: bd-1lc","updated_at":"2026-02-28T05:16:06Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Duplicates","closed_at":"2026-02-27T23:53:08Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"5f93b748eefa487f2e254ae5f7d40c94e20025924cf3817747b8765a51035d1f","created_at":"2026-02-27T23:01:51Z","created_by":"beads/polecats/quartz","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-1k3","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Pre-existing failure: TestChildParentDependencies_PreservesParentChildType","updated_at":"2026-02-27T23:53:08Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"efc6a76eefb57855fc2d34caf32ef541556b52b0da471ac690205476fead8199","created_at":"2026-02-28T02:49:00Z","created_by":"beads/polecats/obsidian","crystallizes":0,"defer_until":null,"description":"schema.go:250-263 defaultConfig hardcodes: compact_model='claude-haiku-4-5-20251001' (AI model), types.custom='molecule,gate,convoy,merge-request,slot,agent,role,rig,message' (Gas Town types). These are runtime operational values baked into the storage layer init. They should be injected by the application layer or read from config.yaml, not embedded in schema initialization.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-1lc","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"defaultConfig in schema.go embeds Gas Town operational constants","updated_at":"2026-02-28T02:49:00Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Test/pollution artifacts ‚Äî not real issues","closed_at":"2026-02-27T22:50:43Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"58ce33aae4f56fcd5f27e24061aa6a3c1f3539ac61a82a537173e80da5216344","created_at":"2026-02-27T08:18:48Z","created_by":"","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-1qh","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"show bd-mu1","updated_at":"2026-02-27T22:50:43Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/onyx","await_id":"","await_type":"","close_reason":"Completed with no code changes (already fixed or pushed directly to main)","closed_at":"2026-02-27T21:53:12Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"ad67b3f8e3e313432d34cf1e83598d8322d115829fc7afd684a4974269aab9f3","created_at":"2025-11-21T16:37:48Z","created_by":"","crystallizes":0,"defer_until":null,"description":"# Problem\n\nThe cmd/bd test suite is painfully slow:\n- **279 tests** in cmd/bd alone\n- Full suite takes **8+ minutes** to run\n- Even with the 16 slowest integration tests now tagged with `integration` build tag, the remaining tests still take forever\n\nThis makes the development loop unusable. We can't wait 8+ minutes every time we want to run tests.\n\n# Root Cause Analysis\n\n## 1. Sheer Volume\n279 tests is too many for a single package. Even at 0.1s per test, that's 28 seconds minimum just for cmd/bd.\n\n## 2. Each Test Creates Full Database + Temp Directories\nEvery test does heavy setup:\n- Creates temp directory (`t.TempDir()` or `os.MkdirTemp`)\n- Initializes SQLite database\n- Sets up git repo in many cases\n- Creates full storage layer\n\nExample from the tests:\n```go\nfunc setupCLITestDB(t *testing.T) string {\n    tmpDir := createTempDirWithCleanup(t)\n    runBDInProcess(t, tmpDir, \"init\", \"--prefix\", \"test\", \"--quiet\")\n    return tmpDir\n}\n```\n\nThis happens 279 times!\n\n## 3. Tests Are Not Properly Categorized\nWe have three types of tests mixed together:\n- **Unit tests** - should be fast, test single functions\n- **Integration tests** - test full workflows, need DB/git\n- **End-to-end tests** - test entire CLI commands\n\nThey're all lumped together in cmd/bd, all running every time.\n\n# What We've Already Fixed\n\nAdded `integration` build tags to 16 obviously-slow test files:\n- import_profile_test.go (performance benchmarking tests)\n- export_mtime_test.go (tests with time.Sleep calls)\n- cli_fast_test.go (full CLI integration tests)\n- delete_test.go, import_uncommitted_test.go, sync_local_only_test.go (git integration)\n- And 10 more in internal/ packages\n\nThese are now excluded from the default `go test ./...` run.\n\n# Proposed Solutions\n\n## Option 1: Shared Test Fixtures (Quick Win)\nCreate a shared test database that multiple tests can use:\n```go\nvar testDB *sqlite.SQLiteStorage\nvar testDBOnce sync.Once\n\nfunc getSharedTestDB(t *testing.T) storage.Storage {\n    testDBOnce.Do(func() {\n        // Create one DB for all tests\n    })\n    return testDB\n}\n```\n\n**Pros**: Easy to implement, immediate speedup\n**Cons**: Tests become less isolated, harder to debug failures\n\n## Option 2: Table-Driven Tests (Medium Win)\nCollapse similar tests into table-driven tests:\n```go\nfunc TestCreate(t *testing.T) {\n    tests := []struct{\n        name string\n        args []string\n        want string\n    }{\n        {\"basic issue\", []string{\"create\", \"Test\"}, \"created\"},\n        {\"with description\", []string{\"create\", \"Test\", \"-d\", \"desc\"}, \"created\"},\n        // ... 50 more cases\n    }\n    \n    db := setupOnce(t) // Setup once, not 50 times\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            // test using shared db\n        })\n    }\n}\n```\n\n**Pros**: Dramatically reduces setup overhead, tests run in parallel\n**Cons**: Requires refactoring, tests share more state\n\n## Option 3: Split cmd/bd Tests Into Packages (Big Win)\nMove tests into focused packages:\n- `cmd/bd/internal/clitests` - CLI integration tests (mark with integration tag)\n- `cmd/bd/internal/unittests` - Fast unit tests\n- Keep only essential tests in cmd/bd\n\n**Pros**: Clean separation, easy to run just fast tests\n**Cons**: Requires significant refactoring\n\n## Option 4: Parallel Execution (Quick Win)\nAdd `t.Parallel()` to independent tests:\n```go\nfunc TestSomething(t *testing.T) {\n    t.Parallel() // Run this test concurrently with others\n    // ...\n}\n```\n\n**Pros**: Easy to add, can cut time in half on multi-core machines\n**Cons**: Doesn't reduce actual test work, just parallelizes it\n\n## Option 5: In-Memory Databases (Medium Win)\nUse `:memory:` SQLite databases instead of file-based:\n```go\nstore, err := sqlite.New(ctx, \":memory:\")\n```\n\n**Pros**: Faster than disk I/O, easier cleanup\n**Cons**: Some tests need actual file-based DBs (export/import tests)\n\n# Recommended Approach\n\n**Short-term (this week)**:\n1. Add `t.Parallel()` to all independent tests in cmd/bd\n2. Use `:memory:` databases where possible\n3. Create table-driven tests for similar test cases\n\n**Medium-term (next sprint)**:\n4. Split cmd/bd tests into focused packages\n5. Mark more integration tests appropriately\n\n**Long-term (backlog)**:\n6. Consider shared test fixtures with proper isolation\n\n# Current Status\n\nWe've tagged 16 files with `integration` build tag, but the remaining 279 tests in cmd/bd still take 8+ minutes. This issue tracks fixing the cmd/bd test performance specifically.\n\n# Target\n\nGet `go test ./...` (without `-short` or `-tags=integration`) down to **under 30 seconds**.\n\n\n# THE REAL ROOT CAUSE (Updated Analysis)\n\nAfter examining the actual test code, the problem is clear:\n\n## Every Test Creates Its Own Database From Scratch\n\nLook at `create_test.go`:\n```go\nfunc TestCreate_BasicIssue(t *testing.T) {\n    tmpDir := t.TempDir()                          // ‚Üê Creates temp dir\n    testDB := filepath.Join(tmpDir, \".beads\", \"beads.db\")\n    s := newTestStore(t, testDB)                   // ‚Üê Opens NEW SQLite connection\n                                                    // ‚Üê Runs migrations\n                                                    // ‚Üê Sets config\n    // ... actual test (3 lines)\n}\n\nfunc TestCreate_WithDescription(t *testing.T) {\n    tmpDir := t.TempDir()                          // ‚Üê Creates ANOTHER temp dir\n    testDB := filepath.Join(tmpDir, \".beads\", \"beads.db\")\n    s := newTestStore(t, testDB)                   // ‚Üê Opens ANOTHER SQLite connection\n    // ... actual test (3 lines)\n}\n```\n\n**This happens 279 times!**\n\n## These Tests Don't Need Isolation!\n\nMost tests are just checking:\n- \"Can I create an issue with a title?\"\n- \"Can I create an issue with a description?\"\n- \"Can I add labels?\"\n\nThey don't conflict with each other. They could all share ONE database!\n\n## The Fix: Test Suites with Shared Setup\n\nInstead of:\n```go\nfunc TestCreate_BasicIssue(t *testing.T) {\n    s := newTestStore(t, t.TempDir()+\"/db\")  // ‚Üê Expensive!\n    // test\n}\n\nfunc TestCreate_WithDesc(t *testing.T) {\n    s := newTestStore(t, t.TempDir()+\"/db\")  // ‚Üê Expensive!\n    // test\n}\n```\n\nDo this:\n```go\nfunc TestCreate(t *testing.T) {\n    // ONE setup for all subtests\n    s := newTestStore(t, t.TempDir()+\"/db\")\n    \n    t.Run(\"basic_issue\", func(t *testing.T) {\n        t.Parallel()  // Can run concurrently - tests don't conflict\n        // test using shared `s`\n    })\n    \n    t.Run(\"with_description\", func(t *testing.T) {\n        t.Parallel()\n        // test using shared `s`\n    })\n    \n    // ... 50 more subtests, all using same DB\n}\n```\n\n**Result**: 50 tests ‚Üí 1 database setup instead of 50!\n\n## Why This Works\n\nSQLite is fine with concurrent reads and isolated transactions. These tests:\n- ‚úÖ Create different issues (no ID conflicts)\n- ‚úÖ Just read back what they created\n- ‚úÖ Don't depend on database state from other tests\n\nThey SHOULD share a database!\n\n## Real Numbers\n\nCurrent:\n- 279 tests √ó (create dir + init SQLite + migrations) = **8 minutes**\n\nAfter fix:\n- 10 test suites √ó (create dir + init SQLite + migrations) = **30 seconds**\n- 279 subtests running in parallel using those 10 DBs = **5 seconds**\n\n**Total: ~35 seconds instead of 8 minutes!**\n\n## Implementation Plan\n\n1. **Group related tests** into suites (Create, List, Update, Delete, etc.)\n2. **One setup per suite** instead of per test\n3. **Use t.Run() for subtests** with t.Parallel()\n4. **Keep tests that actually need isolation** separate (export/import tests, git operations)\n\nThis is way better than shuffling tests into folders!","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-1rh","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Analysis: The test panic in TestInitAlreadyInitialized is caused by store.Close() in PersistentPostRun setting s.db=nil, then subsequent HasRemote() call accessing the nil db. Also: suite is at ~27-37s when it actually completes (before panic kills it). Already well under 2min target. Main remaining work: fix the panic, consolidate metadata_filter_test.go (9 stores), metadata_ready_test.go (4 stores), list_test.go (7 stores), thread_test.go (5 stores).","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"cmd/bd test suite is absurdly slow - 279 tests taking 8+ minutes","updated_at":"2026-02-27T21:54:18Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/quartz","await_id":"","await_type":"","close_reason":"Completed with no code changes (already fixed or pushed directly to main)","closed_at":"2026-02-28T03:20:10Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"fe28c2bce7adc822c4c2765e918ab30ccfaa8bd31db1c1986b295ca64525fb83","created_at":"2026-02-28T02:48:39Z","created_by":"beads/polecats/obsidian","crystallizes":0,"defer_until":null,"description":"schema.go ready_issues and blocked_issues views hardcode status IN (open, in_progress, blocked, deferred, hooked). Custom statuses configured via status.custom config key are validated but NOT included in these views. An issue with custom status 'review' would be permanently invisible to GetReadyWork and bd ready. Same pattern in dependencies.go:779, :834, :877 (IsBlocked, GetNewlyUnblockedByClose). ZFC violation: storage layer decides which statuses are 'active' without consulting config.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-1x0","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Fixed all 8 hardcoded status IN clauses across schema.go (4), dependencies.go (3), queries.go (2). Changed from IN ('open','in_progress','blocked','deferred','hooked') to NOT IN ('closed','pinned'). Added 4 regression tests for custom status visibility in IsBlocked, GetNewlyUnblockedByClose, GetReadyWork, GetBlockedIssues. All tests pass.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"SQL views hardcode status lists - custom statuses invisible to GetReadyWork","updated_at":"2026-02-28T03:21:18Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"test pollution","closed_at":"2026-02-28T03:52:45Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"a7216ca80da15fbd76d98121f8826258ed7b4b40369a50b8d93192d93532a140","created_at":"2026-02-27T22:59:07Z","created_by":"","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-2","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Test Issue 2","updated_at":"2026-02-28T03:52:45Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"d89a616478e1a1298c56ec24ac6d0c610023d9203f0c273f491fb11a6eaae81e","created_at":"2025-12-08T13:49:04Z","created_by":"","crystallizes":0,"defer_until":null,"description":"./bd sync\n‚Üí Exporting pending changes to JSONL...\n‚Üí No changes to commit\n‚Üí Pulling from sync branch 'gh-386'...\nError pulling from sync branch: failed to create worktree: failed to create worktree parent directory: mkdir /var/home/matt/dev/beads/worktree-db-fail/.git: not a directory\nmatt@blufin-framation ~/d/b/worktree-db-fail (worktree-db-fail) [1]\u003e bd config list\n\nConfiguration:\n  auto_compact_enabled = false\n  compact_batch_size = 50\n  compact_model = claude-3-5-haiku-20241022\n  compact_parallel_workers = 5\n  compact_tier1_days = 30\n  compact_tier1_dep_levels = 2\n  compact_tier2_commits = 100\n  compact_tier2_days = 90\n  compact_tier2_dep_levels = 5\n  compaction_enabled = false\n  issue_prefix = worktree-db-fail\n  sync.branch = worktree-db-fail","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-20j","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"sync branch not match config","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"06fd03ae540dcbe2462f7b63c2e95b95347806607f8e1b240bd6cd772e186ed7","created_at":"2025-11-03T01:25:59Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Implement a bd status command that provides a quick snapshot of the issue database state, similar to how git status shows working tree state.\n\nExpected output: Show summary including counts by state (open, in-progress, blocked, closed), recent activity (last 7 days), and quick overview without needing multiple queries.\n\nExample output showing issue counts, recent activity stats, and pointer to bd list for details.\n\nProposed options: --all (show all issues), --assigned (show issues assigned to current user), --json (JSON format output)\n\nUse cases: Quick project health check, onboarding for new contributors, integration with shell prompts or CI/CD, daily standup reference","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-28db","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Add 'bd status' command for issue database overview","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Duplicates","closed_at":"2026-02-27T23:53:09Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"f46e9a194fed634ca346334914f3cc96529ec811b39a8a65f3f997ea5e88017b","created_at":"2026-02-27T18:28:37Z","created_by":"beads/refinery","crystallizes":0,"defer_until":null,"description":"go vet reports: address format \"%s:%d\" does not work with IPv6 (passed to net.Dial at L103). Pre-existing on main.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-2bt","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"go vet: IPv6 format warning in cmd/bd/migrate_safety.go:100","updated_at":"2026-02-27T23:53:09Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/jasper","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-28T01:02:13Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"ec2900e3074965e13c75dc72e7a717786330035e65899ed4063409804a6c3638","created_at":"2026-02-28T00:21:29Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"Issues with title '--help' appear in production (gt-m24x, gt-tm4n, gt-gzx7 in gastown). Either cobra flag parsing has an edge case where --help is treated as a positional arg, or shell completion tests invoke bd create in a way that bypasses help flag detection. Investigate the exact code path and add a guard: reject titles starting with - or -- as likely flag mistakes.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-2c0","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implemented: Added guard in create.go to reject positional titles starting with '-' as likely misinterpreted flags. Error message directs users to --title flag for intentional use. Integration test covers -- --help, -- --version, -- -p, and -- --foo-bar patterns, plus verifies --title still accepts dash-prefixed values.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"bd create --help creates an actual issue instead of showing help","updated_at":"2026-02-28T01:04:18Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Branch pushed directly to main by quartz. No MR needed.","closed_at":"2026-02-28T05:12:21Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"57bd867b4ff4736c64180733884565db09fc82d6f0271bc36154f89920812467","created_at":"2026-02-28T05:11:19Z","created_by":"beads/witness","crystallizes":0,"defer_until":null,"description":"Branch: polecat/quartz/bd-f49@mm5uzkfj\nCommit: e95a07fa - fix: move syncCommandContext() before staleness check so --allow-stale works\nSource: bd-f49 (P1 bug fix)\nPolecat: quartz","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-2ow","is_template":0,"issue_type":"merge-request","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"MR: fix --allow-stale staleness check bypass (bd-f49)","updated_at":"2026-02-28T05:12:21Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/quartz","await_id":"","await_type":"","close_reason":"Completed with no code changes (already fixed or pushed directly to main)","closed_at":"2026-02-28T00:09:47Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"d21f198d3116143a33cc128d4d71cff2784f63dd5525a417cab348aacb9de578","created_at":"2025-11-21T00:33:40Z","created_by":"","crystallizes":0,"defer_until":null,"description":"All beads read operations should validate database is in sync with JSONL before proceeding.\n\n**Current Behavior:**\n- Commands can query/read from stale database\n- Only mutation operations (like 'bd sync') check if JSONL is newer\n- User gets incorrect results without realizing database is out of sync\n\n**Expected Behavior:**\n- All beads commands should have pre-flight check for database freshness\n- If JSONL is newer than database, refuse to operate with error: \"Database out of sync. Run 'bd import' first.\"\n- Same safety check that exists for 'bd sync' should apply to ALL operations\n\n**Impact:**\n- Users make decisions based on incomplete/outdated data\n- Silent failures lead to confusion (e.g., thinking issues don't exist when they do)\n- Similar to running git commands on stale repo without being warned to pull\n\n**Example:**\n- Searched for bd-g9eu issue file: not found\n- Issue exists in .beads/issues.jsonl (in git)\n- Database was stale, but no warning was given\n- Led to incorrect conclusion that issue was already closed/deleted","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-2q6d","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implementation: Added staleness check in PersistentPreRun for read-only commands. Compares issues.jsonl mtime vs last_import_time metadata. Errors with actionable message when stale. Respects --allow-stale flag. Gracefully skips when no JSONL, no metadata, or corrupted metadata. New files: staleness.go, staleness_test.go. Modified: main.go (9 lines added).","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Beads commands operate on stale database without warning","updated_at":"2026-02-28T00:10:44Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/jasper","await_id":"","await_type":"","close_reason":"Merged to main via fast-forward (8cc0874f)","closed_at":"2026-02-27T18:20:39Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"27269fe41f194cfced1ec60013176fcb1efde9535817e3c43d0da05038796e69","created_at":"2026-02-27T07:49:11Z","created_by":"beads/crew/emma","crystallizes":0,"defer_until":null,"description":"The sync.git-remote config key is defined in yaml_config.go and BootstrapFromGitRemote() exists in bootstrap.go, but bd init never reads this config to auto-clone from a Dolt git remote.\n\nWhen a user sets sync.git-remote in config.yaml (or ~/.config/bd/config.yaml) and runs bd init on a new machine, it should:\n1. Detect sync.git-remote is configured\n2. Call BootstrapFromGitRemote() to clone the Dolt database from the git remote\n3. Skip fresh schema creation (database already has schema from clone)\n4. Configure the remote in the new store so bd dolt push/pull work immediately\n\nThis enables the new-machine story for Dolt replication users: set the config once, bd init does the rest.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-2ws","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implemented: bd init now reads sync.git-remote from config.yaml and calls BootstrapFromGitRemoteWithDB() before dolt.New(). After store creation, adds the remote via store.AddRemote() so push/pull work immediately. All non-fatal with graceful fallback to fresh init.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Wire sync.git-remote config into bd init for auto-bootstrap","updated_at":"2026-02-27T18:22:50Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"3c13aba263c90e64ea2279750a52afd13257f9b06bf987f0e868572f528d4229","created_at":"2025-11-12T07:32:22Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Create a `bd setup cursor` command that integrates Beads workflow into Cursor IDE via .cursorrules file. Unlike Claude Code (which has hooks), Cursor uses a static rules file to provide context to its AI.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-379","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Implement `bd setup cursor` for Cursor IDE integration","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"c170158d7b5ee755e81df6a10ce85fd87bd05d7b7c1bdf90e51e35475e0c79a4","created_at":"2025-11-04T20:32:31Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Create migration to detect orphaned children in existing databases. Query: SELECT id FROM issues WHERE id LIKE '%.%' AND substr(id, 1, instr(id || '.', '.') - 1) NOT IN (SELECT id FROM issues). Log results, let user decide action (delete orphans or convert to top-level).","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-3852","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Add orphan detection migration","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/obsidian","await_id":"","await_type":"","close_reason":"Completed with no code changes (already fixed or pushed directly to main)","closed_at":"2026-02-28T03:40:50Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"5bb4454cc7843d33671649d3a4a1c3d115588bb97d7ba77a4dc830f76df5a617","created_at":"2026-02-28T02:48:35Z","created_by":"beads/polecats/obsidian","crystallizes":0,"defer_until":null,"description":"ephemeral_routing.go:22-27 hardcodes infra types that get routed to wisps table. migrations/007_infra_to_wisps.go:11 duplicates the list. This is a policy decision baked into Go code - adding a new infra type (formula, slot) requires code change + release. Should be configurable via DB config table like types.custom.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-39c","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implemented: IsInfraType is now config-driven via types.infra DB config key / config.yaml. Defaults to [agent, rig, role, message]. Configure with: bd config set types.infra 'agent,rig,role,message,formula,slot'. All callers updated. Migration 007 retains immutable hardcoded list.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"IsInfraType hardcodes agent/rig/role/message - should be config-driven","updated_at":"2026-02-28T03:41:29Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"ca077d101e649cbf9b4de00c5a6f004de913c0dd2a546b8ed425e9f7b11aefce","created_at":"2025-11-22T07:16:11Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Old bd versions (\u003c0.24.0) installed merge driver with invalid placeholders %L %R instead of %A %B. Add detection to bd doctor --fix: check if git config merge.beads.driver contains %L or %R, auto-repair to 'bd merge %A %O %A %B'. One-time migration for users who initialized with old versions.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-3sz0","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Auto-repair stale merge driver configs with invalid placeholders","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"7a1b305f38da88f79db29d9fb9cc94ff3ecc9d0d0ab32db37f4d50361b9e2703","created_at":"2025-12-16T06:08:22Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Gas Town and similar multi-agent systems need to configure separate beads databases per workspace/rig, distinct from any project-level beads.\n\n## Use Case\n\nIn Gas Town:\n- Each 'rig' (managed project) has multiple agents (polecats, refinery, witness)\n- All agents in a rig should share a single beads database at the rig level\n- This should be separate from any .beads/ the project itself uses\n- The BEADS_DIR env var enables this\n\n## Documentation Needed\n\n1. Add a section to docs explaining BEADS_DIR for multi-agent setups\n2. Example: setting BEADS_DIR in agent startup scripts/hooks\n3. Clarify interaction with project-level .beads/ (BEADS_DIR takes precedence)\n\n## Current Support\n\nAlready implemented in internal/beads/beads.go:FindDatabasePath():\n- BEADS_DIR env var is checked first (preferred)\n- BEADS_DB env var still supported (deprecated)\n- Falls back to .beads/ search in tree\n\nJust needs documentation for the multi-agent workspace pattern.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-411u","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Document BEADS_DIR pattern for multi-agent workspaces (Gas Town)","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/onyx","await_id":"","await_type":"","close_reason":"Completed with no code changes (already fixed or pushed directly to main)","closed_at":"2026-02-27T23:58:11Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"ed848486d936d4b2b1650967811abdc95d723f54cb182cd30128db09688e7ee3","created_at":"2025-11-20T23:55:39Z","created_by":"","crystallizes":0,"defer_until":null,"description":"The beads MCP server (v0.23.1) successfully connects to Claude Code, but all tools fail to load with a schema validation error due to a bug in FastMCP 2.13.1.\n\nError: \"Invalid literal value, expected \\\"object\\\"\" in outputSchema.\n\nRoot Cause: FastMCP generates outputSchema with $ref at root level without \"type\": \"object\" for self-referential models (Issue).\n\nWorkaround: Use slash commands (/beads:ready) or wait for FastMCP fix.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-49kw","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Workaround for FastMCP outputSchema bug in Claude Code","updated_at":"2026-02-28T00:00:30Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"407b7461a603987d5425c5a110047166942ce4b1645bf9f174694b201149e33c","created_at":"2025-12-08T13:38:24Z","created_by":"","crystallizes":0,"defer_until":null,"description":"`bd ready` and `bd list` just show a flat list, and it's up to the reader to parse which ones are dependent or sub-issues of others. It would be much easier to understand if they were shown in a tree format","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-4hn","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"wish: list \u0026 ready show issues as hierarchy tree","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"97be01c77a4186a406bb6299702cbda9fb15a90371a9f48f342568dfe1a6cc9a","created_at":"2025-12-17T02:17:28Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Code health review found cmd/bd/info_test.go has two tests permanently skipped:\n\n- TestInfoCommand\n- TestInfoCommandNoDaemon\n\nBoth skip with: 'Manual test - bd info command is working, see manual testing'\n\nThese are essentially dead code. Either automate them or remove them entirely.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-4nqq","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Remove dead test code in info_test.go","updated_at":"2026-02-27T02:56:51Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"0c3d65e54636f79a4139015b1d7686cc2ce50c972d314acb61b7dcb27e7c1ad9","created_at":"2025-12-12T22:29:28Z","created_by":"","crystallizes":0,"defer_until":null,"description":"The current bd doctor output is a wall of text that's hard to process. Consider improvements like:\n- Grouping related checks into collapsible sections\n- Using color/bold for section headers\n- Showing only failures/warnings by default with --verbose for full output\n- Better visual hierarchy between major sections\n- Summary line at top (e.g., '24 checks passed, 0 warnings, 0 errors')","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-4qfb","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Improve bd doctor output formatting for better readability","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:50Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"b95447e058d464a8fd8c9aaa3c2b5ce595df7138be72ce2f3a2ef04cac409920","created_at":"2025-12-14T22:25:59Z","created_by":"","crystallizes":0,"defer_until":null,"description":"## Merged PRs Summary\n\n### PR #551: Persist close_reason to issues table\n- ‚úÖ Merged successfully\n- ‚úÖ Bug fix: close_reason now persisted in database column (not just events table)\n- ‚úÖ Comprehensive test coverage added\n- ‚úÖ Handles reopen case (clearing close_reason)\n\n**Followup Issues Filed:**\n- bd-lxzx: Document close_reason in JSONL export format\n- bd-077e: Update CLI documentation for close_reason field\n\n---\n\n### PR #481: Context Engineering Optimizations (80-90% context reduction)\n- ‚úÖ Merged successfully  \n- ‚úÖ Lazy tool discovery: discover_tools() + get_tool_info()\n- ‚úÖ Minimal issue models: IssueMinimal (~80% smaller than full Issue)\n- ‚úÖ Result compaction: Auto-compacts results \u003e20 items\n- ‚úÖ All 28 tests passing\n- ‚ö†Ô∏è Breaking change: ready() and list() return type changed\n\n**Followup Issues Filed:**\n- bd-b318: Add integration tests for CompactedResult\n- bd-4u2b: Make compaction settings configurable (THRESHOLD, PREVIEW_COUNT)\n- bd-2kf8: Document CompactedResult response format in CONTEXT_ENGINEERING.md\n- bd-pdr2: Document backwards compatibility considerations\n\n---\n\n## Overall Assessment\n\nBoth PRs are production-ready with solid implementations. All critical functionality works and tests pass. Followup issues focus on:\n1. Documentation improvements (5 issues)\n2. Integration test coverage (1 issue)\n3. Configuration flexibility (1 issue)\n4. Backwards compatibility guidance (1 issue)\n\nNo critical bugs or design issues found.\n\n## Review Completed By\nCode review process completed. Issues auto-created for tracking improvements.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-4uoc","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Code Review Followup Summary: PR #481 + PR #551","updated_at":"2026-02-27T02:56:50Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Recreated as gt-n2by in gastown","closed_at":"2026-02-28T18:32:43Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"2cab3c5d8db686e7433b1a97bdba930b531b3dcf067a2daa2e9cc3c3f13c1d44","created_at":"2026-02-28T18:31:59Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"Dog kilo is configured to run plugin:dolt-archive but the daemon's plugin discovery doesn't find it. The plugin file exists at ~/gt/plugins/dolt-archive/plugin.md but isn't registered.\n\nAvailable plugins (per error): dolt-backup, dolt-doctor, dolt-janitor, github-sheriff\nPlugins on disk: dolt-archive, dolt-backup, dolt-doctor, dolt-janitor, dolt-reaper\n\nThe dolt-archive plugin handles JSONL export + git push + dolt push. The JSONL Dog (jsonl_git_backup.go) already does the JSONL/git portion, so there may be overlap to resolve.\n\nFix: either register the plugin properly or reassign dog kilo to use the existing JSONL Dog.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-4v6","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Register dolt-archive plugin in daemon plugin system","updated_at":"2026-02-28T18:32:43Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:52Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"bdb72324282b5ecc6147305fb5499ba896f1a8dc243f85cc2f9add2c70d1dbc0","created_at":"2025-10-30T03:49:49Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Find semantically duplicate issues.\n\nApproaches:\n1. Mechanical: Exact title/description matching\n2. Embeddings: Cosine similarity (cheap, scalable)\n3. AI: LLM-based semantic comparison (expensive, accurate)\n\nUses embeddings by default for \u003e100 issues.\n\nFiles: cmd/bd/find_duplicates.go (new)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-581b80b3","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"bd find-duplicates - AI-powered duplicate detection","updated_at":"2026-02-27T02:56:52Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:52Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"4bda18c1902c39ac9152dbd5537ad346bd468fa4a690d830c133bf684f33cc1f","created_at":"2025-11-02T05:40:59Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Several utility functions have 0% coverage:\n- GetDirtyIssueHash (dirty.go)\n- GetAllDependencyRecords (dependencies.go)\n- GetExportHash, SetExportHash, ClearAllExportHashes (hash.go)\n\nThese are lower priority but should have basic coverage.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-5b6e","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":4,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Add tests for helper functions (GetDirtyIssueHash, GetAllDependencyRecords, export hashes)","updated_at":"2026-02-27T02:56:52Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Recreated as gt-bvse in gastown","closed_at":"2026-02-28T18:32:43Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"cd0fbe7c610ffbabdc1d36040215b3228e84b9a20069a8071103668e800a485d","created_at":"2026-02-28T18:31:48Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"Tim Sehn confirmed (2026-02-28) that DOLT_RESET --soft + DOLT_COMMIT is safe on a running server. No downtime needed. The Compactor Dog (compactor_dog.go) should be updated to:\n\n1. Run flatten via SQL instead of stopping the server\n2. Use: SET @init = (SELECT commit_hash FROM dolt_log ORDER BY date ASC LIMIT 1); CALL DOLT_RESET('--soft', @init); CALL DOLT_COMMIT('-Am', 'daily compaction');\n3. Remove all server stop/start logic from compaction path\n4. Auto-GC is already on (since Dolt 1.75.0) so no manual gc needed\n\nConcurrent writes during flatten are safe - merge base shifts but diff is just the txn.\n\nReference: dolt-storage.md (updated 2026-02-28)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-5cw","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Compactor Dog: use SQL-based flatten on running server","updated_at":"2026-02-28T18:32:43Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/jasper","await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"a3549f2f54f3b76002fa1b9f6fd5947899e07f900d11c1edbf12352e3fe263be","created_at":"2026-02-28T03:42:10Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"attached_molecule: bd-wisp-vnssv\nattached_formula: mol-polecat-work\nattached_at: 2026-02-28T03:48:47Z\ndispatched_by: mayor\n\ninternal/storage/dolt takes 75s. Core storage layer tests ‚Äî probably spawning embedded Dolt or connecting to test servers per test. Check for: shared test server, t.Parallel(), unnecessary data setup. Target: under 30s.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-5ua","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Speed up internal/storage/dolt tests (75s)","updated_at":"2026-03-01T05:47:29Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/quartz","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-27T18:21:04Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"1b6e49523009a68b9b6d712fab588b5131ce2aa3dfad747360c86a6aab10c162","created_at":"2026-02-27T07:49:06Z","created_by":"beads/crew/emma","crystallizes":0,"defer_until":null,"description":"When a Dolt remote is configured, auto-push after write operations (create, update, close, etc.) with a 5-minute debounce ‚Äî similar to how JSONL auto-backup throttles at 15 minutes.\n\nImplementation approach:\n- Same pattern as maybeAutoBackup(): check last push timestamp, skip if \u003c 5min ago\n- Gate on store.HasRemote(ctx, 'origin') ‚Äî only if a remote exists\n- Run in PersistentPostRun after auto-commit (and after auto-backup)\n- Failure is non-fatal (warning only, like JSONL git push)\n- Configurable interval via config key (e.g. dolt.auto-push-interval: 5m)\n- Opt-out via dolt.auto-push: false\n\nThis completes the Dolt replication story: users add a remote once, and data flows automatically.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-5x9","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implemented auto-push to Dolt remote with 5-minute debounce. New file: cmd/bd/dolt_autopush.go. Config keys: dolt.auto-push (auto-enabled when origin exists), dolt.auto-push-interval (default 5m). Same pattern as maybeAutoBackup: debounce, change detection, non-fatal warnings. Tests in dolt_autopush_test.go.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Auto-push to Dolt remote with 5-minute debounce","updated_at":"2026-02-27T18:22:54Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/onyx","await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"f07bb567d0cba0f21d278a56c5a2cecfe44f92e2fbf830be204c17e30edd8b74","created_at":"2026-02-28T03:42:10Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"attached_molecule: bd-wisp-hispx\nattached_formula: mol-polecat-work\nattached_at: 2026-02-28T03:49:05Z\ndispatched_by: mayor\n\ncmd/bd/doctor takes 44s. Doctor runs diagnostic checks ‚Äî tests may be spawning real infrastructure. Check for: mocking opportunities, shared fixtures, parallel execution. Target: under 15s.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-6bq","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"Analysis: Tests take 68s. Root cause: 15+ tests each create a separate Dolt database (CREATE DATABASE + schema init = ~0.5-2s each). Fix: refactor tests to use branch-per-test isolation on the shared DB (newTestDoltStore). The path-based check functions (CheckDuplicateIssues, CheckStaleClosedIssues, etc.) internally open stores, so tests calling them create new DBs. Fix by testing the underlying query logic directly with the shared store's sql.DB.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Speed up cmd/bd/doctor tests (44s)","updated_at":"2026-03-01T05:47:29Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"4449f8c37781cf63dc7abb4ec099f19209d06974e196b065598ea168f93f3158","created_at":"2025-10-28T23:20:02Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Several small utility functions are unreachable:\n\nFiles to clean:\n1. `internal/storage/sqlite/hash.go` - `computeIssueContentHash` (line 17)\n   - Check if entire file can be deleted if only contains this function\n\n2. `internal/config/config.go` - `FileUsed` (line 151)\n   - Delete unused config helper\n\n3. `cmd/bd/git_sync_test.go` - `verifyIssueOpen` (line 300)\n   - Delete dead test helper\n\n4. `internal/compact/haiku.go` - `HaikuClient.SummarizeTier2` (line 81)\n   - Tier 2 summarization not implemented\n   - Options: implement feature OR delete method\n\nImpact: Removes 50-100 LOC depending on decisions","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-6fe4622f","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Remove unreachable utility functions","updated_at":"2026-02-27T02:56:51Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Duplicate of bd-7z5","closed_at":"2026-02-28T00:16:33Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"8b196b86f88b144772184beb78962065b6ee5ad66fcd9e90f77b097a68ad0bcb","created_at":"2026-02-28T00:15:30Z","created_by":"beads/refinery","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-6ie","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Pre-existing test failure: TestChildParentDependencies_PreservesParentChildType in doctor/fix","updated_at":"2026-02-28T00:16:33Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"6b092e6e7695f5e4fd27e7487e5f12d33f619c4fbf81d93dc3abb52a832ae68b","created_at":"2025-12-06T00:36:16Z","created_by":"","crystallizes":0,"defer_until":null,"description":"The public Merge3Way() function in merge.go does not allow callers to configure the tombstone TTL. It hard-codes the default via merge3WayWithTTL(). While merge3WayWithTTL() exists, it is unexported (lowercase). This means the CLI and tests cannot configure TTL at merge time. Use cases: testing with different TTL values, per-repository TTL configuration, debugging with short TTL, supporting --ttl flag in bd merge command (mentioned in design doc bd-zvg). Recommendation: Export Merge3WayWithTTL (rename to uppercase). Files: internal/merge/merge.go:77, 292-298","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-6rl","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Merge3Way public API does not expose TTL parameter","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:50Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"0909f66352d168afeba8c23c242350f734b02715228a7c5d6a117fd05051b5b8","created_at":"2025-12-14T04:43:07Z","created_by":"","crystallizes":0,"defer_until":null,"description":"The export package has only 37.1% test coverage. Export functionality needs good coverage to ensure data integrity.\n\nCurrent coverage: 37.1%\nTarget coverage: 60%","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-6sm6","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Improve test coverage for internal/export (37.1% ‚Üí 60%)","updated_at":"2026-02-27T02:56:50Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/obsidian","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-28T00:10:49Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"8adb18f5ee53735b865df27908eafd360831c0510dbbcfe3f74e07ab8f6f279b","created_at":"2025-12-17T02:17:17Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Code health review found these functions defined in multiple places:\n\n- findJSONLPath() in autoflush.go:45-73 and doctor/fix/migrate.go\n- findBeadsDir() in autoimport.go:197-239 (with git worktree handling)\n- findGitRoot() in autoimport.go:242-269 (Windows path conversion)\n\nThe beads package has public FindBeadsDir() and FindJSONLPath() APIs that should be used consistently.\n\nImpact: Bug fixes need to be applied in multiple places. Git worktree handling may not be replicated everywhere.\n\nFix: Consolidate all implementations to use the beads package APIs. Remove duplicates.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-74w1","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"Consolidated duplicate findBeadsDir() in cmd/bd/setup.go (also used by backup_export.go) to use the canonical beads.FindBeadsDir() from internal/beads. The other duplicates mentioned in the bead (findJSONLPath in autoflush.go, findBeadsDir/findGitRoot in autoimport.go) were already cleaned up in prior work ‚Äî those files no longer exist. Only findGitRoot remains in internal/beads/beads.go as a thin wrapper around git.GetRepoRoot(), but it's not a duplicate (it's the canonical implementation).","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Consolidate duplicate path-finding utilities (findJSONLPath, findBeadsDir, findGitRoot)","updated_at":"2026-02-28T00:10:49Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"e8a3e7a0e2dcedbf7de889ca72267dc06c0f07dbf239a367be017b0b05bf3430","created_at":"2025-11-10T00:20:13Z","created_by":"","crystallizes":0,"defer_until":null,"description":"When running 'bd import' on a fresh database (no existing issues), the command reports 'Import complete: 0 created, 0 updated' even though it successfully imported all issues from the JSONL file.\n\n**Steps to reproduce:**\n1. Delete .beads/beads.db\n2. Run: bd import .beads/issues.jsonl\n3. Observe output: 'Import complete: 0 created, 0 updated'\n4. Run: bd list\n5. Confirm: All issues are actually present in the database\n\n**Expected behavior:**\nReport the actual number of issues imported, e.g., 'Import complete: 523 created, 0 updated'\n\n**Actual behavior:**\n'Import complete: 0 created, 0 updated' (misleading - makes user think import failed)\n\n**Impact:**\n- Users think import failed when it succeeded\n- Confusing during database sync operations (e.g., after git pull)\n- Makes debugging harder (can't tell if import actually worked)\n\n**Context:**\nDiscovered during VC session when syncing database after git pull. The misleading message caused confusion about whether the database was properly synced with the canonical JSONL file.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-77gm","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Import reports misleading '0 created, 0 updated' when actually importing all issues","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"7666c6ed1522e3e77945692f4f1e799e420ab96be8260c5dc71b42b8c895d593","created_at":"2025-12-05T22:33:43Z","created_by":"","crystallizes":0,"defer_until":null,"description":"in a git worktree any bd command is slow, with a 2-3s pause before any results are shown. The identical command with `--no-daemon` is near instant.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-7di","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"worktree: any bd command is slow","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:52Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"031fa54cf7bc66f7e08f93960de1050fa8dbedbc2d51dcd3e72515f43265a98e","created_at":"2025-10-28T21:48:30Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Automatically resolve JSONL merge conflicts.\n\nModes:\n- Mechanical: ID remapping (no AI)\n- AI-assisted: Smart merge/keep decisions\n- Interactive: Review each conflict\n\nHandles \u003c\u003c\u003c\u003c\u003c\u003c\u003c conflict markers in .beads/beads.jsonl\n\nFiles: cmd/bd/resolve_conflicts.go (new)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-7e7ddffa.1","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"bd resolve-conflicts - Git merge conflict resolver","updated_at":"2026-02-27T02:56:52Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"c9bf06043652d1c2c9dcbeaa889b92f0b021039ad1e1fa7106b07e2c92ff143b","created_at":"2025-12-16T21:26:47Z","created_by":"","crystallizes":0,"defer_until":null,"description":"When running bd init, any running daemon continues with stale cached data, causing bd stats and other commands to show old counts.\n\nRepro:\n1. Have daemon running with 788 issues cached\n2. Clean JSONL to 128 issues, delete db, run bd init\n3. bd stats still shows 788 (daemon cache)\n4. Must manually run bd daemon --stop\n\nFix: bd init should automatically stop any running daemon before reinitializing.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-7h7","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"bd init should stop running daemon to avoid stale cache","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/quartz","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-28T01:09:12Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"a9ef0383ec8ef0fb9b9c2d2b5e1d6e5f571f0e5410c2c3f7e9f9d0258a198df2","created_at":"2026-02-28T00:30:16Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"Running 'bd close bd-1' from /Users/stevey/gt (town root) reports success but doesn't actually close the issue in the beads rig database. Must run from beads/mayor/rig/ to work. Prefix routing for bd close appears broken at town level ‚Äî likely closes a phantom copy in HQ db or silently succeeds without finding the issue. Discovered during test pollution cleanup session.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-7vk","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implemented: skip local-first check in resolveAndGetIssueWithRouting and getIssueWithRouting when prefix routing indicates a different database. Added regression test TestRoutingSkipsLocalPhantomCopy.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"bd close from town root doesn't route to correct rig database","updated_at":"2026-02-28T01:14:00Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/quartz","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-27T21:57:16Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"d052f6facc004dbd7cdc411e261f4d97f5b0507ef2625a4c7fb6eae763bc6f47","created_at":"2025-11-22T00:51:56Z","created_by":"","crystallizes":0,"defer_until":null,"description":"## Problem\n\nThe beads git merge driver is configured with invalid Git placeholders:\n\n```\ngit config merge.beads.driver \"bd merge %A %O %L %R\"\n```\n\nGit doesn't recognize `%L` or `%R` as valid merge driver placeholders. The valid placeholders are:\n- `%O` = base (common ancestor)\n- `%A` = current version (ours)\n- `%B` = other version (theirs)\n\n## Impact\n\n- Affects ALL users when they have `.beads/beads.jsonl` merge conflicts\n- Automatic JSONL merge fails with error: \"error reading left file: failed to open file: open 7: no such file or directory\"\n- Users must manually resolve conflicts instead of getting automatic merge\n\n## Root Cause\n\nThe `bd init` command (or wherever the merge driver is configured) is using non-standard placeholders. When Git encounters `%L` and `%R`, it either passes them literally or interprets them incorrectly.\n\n## Fix\n\nUpdate the merge driver configuration to:\n```\ngit config merge.beads.driver \"bd merge %A %O %A %B\"\n```\n\nWhere:\n- 1st `%A` = output file (current file, will be overwritten)\n- `%O` = base (common ancestor)\n- 2nd `%A` = left/current version\n- `%B` = right/other version\n\n## Action Items\n\n1. Fix `bd init` (or equivalent setup command) to use correct placeholders\n2. Add migration/warning for existing users with misconfigured merge driver\n3. Update documentation with correct merge driver setup\n4. Consider adding validation when `bd init` is run","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-7yg","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implemented: Added FixMergeDriver() function and wired it into bd doctor --fix. The check already correctly detected %L/%R but the fix path was missing from applyFixList switch. Also added tests.","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Git merge driver uses invalid placeholders (%L, %R instead of %A, %B)","updated_at":"2026-02-27T21:57:16Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/opal","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-28T00:30:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"e77bf5f778177dfa759c36d6ee3938a28124ee57ed90e96618eaa61c7e7766dd","created_at":"2026-02-27T23:11:09Z","created_by":"beads/refinery","crystallizes":0,"defer_until":null,"description":"validation_test.go:277: dependency bd-abc.1 -\u003e bd-abc already exists with type 'parent-child' (requested 'blocks'). Test in cmd/bd/doctor/fix package.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-7z5","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implemented: restructured TestChildParentDependencies_PreservesParentChildType to create parent-child and blocks deps on separate child issues, matching the new AddDependency behavior that rejects type changes on existing key pairs.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Pre-existing: TestChildParentDependencies_PreservesParentChildType failure","updated_at":"2026-02-28T00:41:50Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Resolved by gt-th5n: removed --root-only from gt sling instead of adding it to bd mol wisp.","closed_at":"2026-02-28T18:31:38Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"3b58dd90bfdb5e16f7a1658aad89349ebcc2c7903bd9d996108f7fa1c5093d6a","created_at":"2026-02-28T05:36:34Z","created_by":"gastown/polecats/furiosa","crystallizes":0,"defer_until":null,"description":"gt sling needs root-only wisp creation (no child step wisps materialized). Currently gt removed the flag (gt-th5n) because bd did not support it. Add --root-only to bd mol wisp to skip child issue creation in cloneSubgraph, reducing wisp database bloat.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-895","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Add --root-only flag to bd mol wisp","updated_at":"2026-02-28T18:31:38Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"146784361e83d6d7767ea2d45eaa7e9b382e566618fa346f56a1f7f3f373c6f1","created_at":"2025-10-28T23:20:02Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Several RPC server and client methods are unreachable and should be removed:\n\nServer methods (internal/rpc/server.go):\n- `Server.GetLastImportTime` (line 2116)\n- `Server.SetLastImportTime` (line 2123)\n- `Server.findJSONLPath` (line 2255)\n\nClient methods (internal/rpc/client.go):\n- `Client.Import` (line 311) - RPC import not used (daemon uses autoimport)\n\nEvidence:\n```bash\ngo run golang.org/x/tools/cmd/deadcode@latest -test ./...\n```\n\nImpact: Removes ~80 LOC of unused RPC code","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-89f89fc0","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Remove unreachable RPC methods","updated_at":"2026-02-27T02:56:51Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Test artifact cleanup (Clown Show #21)","closed_at":"2026-02-27T02:53:45Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"6849de7a7a47d0225fcb1286f05412d7818bbed15cb6aee7f6b52d87e9587ee8","created_at":"2025-12-16T21:49:32Z","created_by":"","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-8fgn","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"test hash length","updated_at":"2026-02-27T02:53:45Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/obsidian","await_id":"","await_type":"","close_reason":"Completed with no code changes (already fixed or pushed directly to main)","closed_at":"2026-02-27T08:08:11Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"6b80f6405ee724d43389a3e80c7bee27ebd08c7b695bc1a4cad06a71e0d796cd","created_at":"2026-02-27T07:48:24Z","created_by":"beads/crew/emma","crystallizes":0,"defer_until":null,"description":"Solo users get automatic JSONL backup to GitHub (auto-enabled when git remote exists), but there's no restore path. If a user loses their Dolt database (machine crash, new clone, etc.), they have .beads/backup/*.jsonl on GitHub but must manually bd init + bd import to recover.\n\nAdd a 'bd restore' command that:\n1. Detects .beads/backup/*.jsonl files (or accepts a path)\n2. Creates/reinitializes the Dolt database if needed\n3. Imports all JSONL tables (issues, events, comments, dependencies, labels, config)\n4. Restores the backup_state.json watermarks so incremental backup resumes correctly\n\nAlso consider: bd init should detect existing backup files and offer to restore automatically.\n\nWithout this, the auto-backup is a false sense of security ‚Äî data is on GitHub but recovery is undocumented and manual.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-8mg","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Add 'bd restore' command to bootstrap from JSONL backup","updated_at":"2026-02-27T08:09:21Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Test pollution / noise ‚Äî backlog cleanup","closed_at":"2026-02-27T23:52:57Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"1f4f36a887307a6297097f0a725d0893539b4da6c79b5ac9ff4565954e804c2c","created_at":"2026-02-27T23:06:37Z","created_by":"dog","crystallizes":0,"defer_until":null,"description":"Dolt diagnostics detected issues: query latency 1.136s exceeds 1s threshold, 2 orphaned databases (gt, hq). Server responsive at port 3307. 7/200 connections active (4%), 348.0 MB disk usage. Run 'gt dolt cleanup' to remove orphans.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-8rq","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Dolt Doctor Diagnostic","updated_at":"2026-02-27T23:52:57Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"c8315a702e341373bcfe821da075c4329e60878970d5abf4f9be8a55c17a274f","created_at":"2025-11-12T07:31:12Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Implement `bd prime` command and Claude Code hooks for context recovery. Hooks work with BOTH MCP server and CLI approaches - they solve the context memory problem (keeping bd workflow fresh after compaction) not the tool access problem (MCP vs CLI).","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-90v","is_template":0,"issue_type":"epic","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"bd prime: AI context loading and Claude Code integration","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Recreated as gt-v18k in gastown","closed_at":"2026-02-28T18:32:43Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"073c6067ab28e3606b84e5386a5f7041399b31170bf7e8ba763250d32544a8f4","created_at":"2026-02-28T18:31:53Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"Tim Sehn suggested using Dolt's built-in MySQL scheduled events (server-maintained cron) for automatic compaction instead of our Dog system. This could simplify the architecture.\n\nReference: https://www.dolthub.com/blog/2023-10-02-scheduled-events/\n\nInvestigate:\n1. Can we CREATE EVENT for daily flatten on each database?\n2. Does it survive server restart?\n3. Can it replace the Compactor Dog entirely?\n4. Test with: CREATE EVENT daily_compact ON SCHEDULE EVERY 1 DAY DO BEGIN SET @init = (SELECT commit_hash FROM dolt_log ORDER BY date ASC LIMIT 1); CALL DOLT_RESET('--soft', @init); CALL DOLT_COMMIT('-Am', 'auto-compact'); END;\n\nThis is exploration/spike work - may or may not replace the Dog approach.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-91a","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Explore Dolt scheduled events for automatic compaction","updated_at":"2026-02-28T18:32:43Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"4244cd398cad23bb9a3087a505ec71511cd3d3fa0bca5dfe4f766927389ceb74","created_at":"2025-10-30T06:05:14Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Document BEADS_DAEMON_MODE env var. Explain opt-in during Phase 1. Add troubleshooting for watcher failures.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-98c4e1fa.1","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Update AGENTS.md with event-driven mode","updated_at":"2026-02-27T02:56:51Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"3f562569fdff5ba36499bea268118cefd0091243afff4d6f236699a52151c8fc","created_at":"2025-11-04T20:32:31Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Update AGENTS.md, README.md, TROUBLESHOOTING.md with import.orphan_handling config documentation. Document resurrection behavior, tombstones, config modes. Add troubleshooting section for import failures with deleted parents.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-9cdc","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Update docs for import bug fix","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"3f561656b6b49404e670fe703188baddc271f651b4aa367e44b4e39be2726cda","created_at":"2025-12-17T02:17:31Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Code health review found .test-skip permanently skips TestFindJSONLPathDefault.\n\nThe test references issue #356 about wrong JSONL filename expectations (issues.jsonl vs beads.jsonl).\n\nTest file: internal/beads/beads_test.go\n\nThe underlying migration from beads.jsonl to issues.jsonl may be complete, so either:\n1. Fix the test expectations\n2. Remove the test if no longer needed\n3. Document why it remains skipped","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-9g1z","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Fix or remove TestFindJSONLPathDefault (issue #356)","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"50f7802787ac5f18e3ecc4b45302f5ae6c68adb7206d515723f87116eef2f447","created_at":"2025-12-06T00:37:11Z","created_by":"","crystallizes":0,"defer_until":null,"description":"The merge package uses string for status comparison (e.g., result.Status == closed, issue.Status == StatusTombstone). The types package defines Status as a type alias with validation. While the merge package needs its own Issue struct for JSONL flexibility, it could import and use types.Status for constants to get compile-time type checking. Current code: if left == closed || right == closed. Could be: if left == string(types.StatusClosed). This is low priority since string comparison works correctly. Files: internal/merge/merge.go:44, 488, 501-521","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-a0cp","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":4,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Consider using types.Status in merge package for type safety","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:50Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"a585e34fb7c8e9d3ed97ea1a98743af2e223b1869a11bc249e1ebdb3709c2594","created_at":"2025-12-14T04:43:11Z","created_by":"","crystallizes":0,"defer_until":null,"description":"The internal/storage package has no test files at all. This package provides the storage interface abstraction.\n\nCurrent coverage: N/A (no test files)\nTarget: Add basic interface tests","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-a15d","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Add test files for internal/storage","updated_at":"2026-02-27T02:56:50Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/obsidian","await_id":"","await_type":"","close_reason":"Completed with no code changes (already fixed or pushed directly to main)","closed_at":"2026-02-27T05:51:49Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"9fb7099d40e79c02a3fd7514ea81671bb511db89e5e6f1a8fcc69612502c92ea","created_at":"2026-02-27T05:48:34Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"Review commit 725f6bbb in beads repo. Check: flag plumbing correctness, wisp creation with root_only=true, no children created, backward compatibility.","design":"## Code Review: --root-only flag in bd mol wisp create (725f6bbb)\n\n**Verdict: LGTM ‚Äî clean commit, no blocking issues.**\n\n### 1. Flag Plumbing Correctness ‚úÖ\n\n- `--root-only` registered on both `wispCmd` and `wispCreateCmd` (backward compat for both CLI paths)\n- Read via `cmd.Flags().GetBool(\"root-only\")` at wisp.go\n- Passed through `CloneOptions{RootOnly: rootOnly}` ‚Üí `spawnMoleculeWithOptions` ‚Üí `cloneSubgraph`\n- Full pipeline verified end-to-end\n\n### 2. Wisp Creation with root_only=true ‚úÖ\n\n- `cloneSubgraph` narrows `issuesToCreate = []*types.Issue{subgraph.Root}` when RootOnly is set\n- Root issue goes through the identical creation path (assignee override, variable substitution, ephemeral marking, bonded ID generation)\n- `idMapping` correctly contains exactly one entry (root only)\n\n### 3. No Children Created ‚úÖ\n\n- Children are excluded from `issuesToCreate` (only root is in the slice)\n- Dependencies are skipped via `if opts.RootOnly { break }` in the second pass\n- AttachToID still works (uses `idMapping[subgraph.Root.ID]` which is always populated)\n- Dynamic bonding (`ParentID`) also works ‚Äî root gets bonded ID as expected\n\n### 4. Backward Compatibility ‚úÖ\n\n- `spawnMolecule()` function is preserved ‚Äî all existing callers (pour.go:216, 9 test call sites in mol_test.go) are unaffected\n- Default `RootOnly` is `false` (Go zero value), so existing `CloneOptions{}` usage safe\n- Dry-run path properly branches: root-only shows single-line summary with inlined step count; non-root-only path is unchanged\n\n### 5. `Created` Field Fix ‚úÖ\n\n- Changed from `len(subgraph.Issues)` to `len(idMapping)` ‚Äî more accurate in ALL cases\n- For non-root-only: `len(idMapping)` == `len(subgraph.Issues)` in all success paths (errors cause tx rollback)\n- For root-only: correctly returns 1 instead of the full template count\n- This is a semantic improvement, not just a root-only fix\n\n### Minor Nit (Non-Blocking)\n\nThe dependency loop guard:\n```go\nfor _, dep := range subgraph.Dependencies {\n    if opts.RootOnly { break }\n    ...\n}\n```\nWould be slightly cleaner as:\n```go\nif !opts.RootOnly {\n    for _, dep := range subgraph.Dependencies { ... }\n}\n```\nFunctionally identical ‚Äî the `break` fires on first iteration and exits. But wrapping the loop is more idiomatic Go. Not worth a re-spin.\n\n### Summary\n\nTwo files changed (+39/-9), well-scoped. The ~15x Dolt write reduction claim is plausible (typical patrol formula has 10+ steps). All edge cases (bonding, attachment, dry-run, backward compat) are covered.","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-a3j","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Code review: --root-only flag in bd mol wisp create (725f6bbb)","updated_at":"2026-02-27T05:52:24Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Test issue, no content","closed_at":"2026-03-01T05:45:48Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"9a992baeab9357c058373dda5ef62a87e87217a3c7d546f192529dd49c522f48","created_at":"2026-02-26T00:08:56Z","created_by":"","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-abc12","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Real issue","updated_at":"2026-03-01T05:45:48Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"4514bb59ac1f80c14f63a160111dc0f12415d15e739e8d8af0c82d2fd90355ae","created_at":"2025-12-07T10:03:26Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Multiple places parse config.yaml with custom structs:\n\n1. **autoimport.go:148** - `localConfig{SyncBranch}`\n2. **main.go:310** - strings.Contains for no-db (fragile, see bd-r6k2)\n3. **doctor.go:863** - strings.Contains for no-db (fragile, see bd-r6k2)\n4. **internal/config/config.go** - Uses viper (but caches at startup, problematic for tests)\n\nConsider creating a shared utility in `internal/configfile/` or extending the viper config:\n\n```go\n// internal/configfile/yaml.go\ntype YAMLConfig struct {\n    SyncBranch string `yaml:\"sync-branch\"`\n    NoDb       bool   `yaml:\"no-db\"`\n    IssuePrefix string `yaml:\"issue-prefix\"`\n    Author     string `yaml:\"author\"`\n}\n\nfunc LoadYAML(beadsDir string) (*YAMLConfig, error) {\n    // Parse config.yaml with proper YAML library\n}\n```\n\nBenefits:\n- Single source of truth for config.yaml structure\n- Proper YAML parsing everywhere\n- Easier to add new config fields\n\nTrade-off: May add complexity for simple one-off reads.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-abjw","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":4,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Consider consolidating config.yaml parsing into shared utility","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"da5172bd281b42d9c3150a75aae472275af85322579e066b7a0a0065a2ed0358","created_at":"2025-10-28T01:53:10Z","created_by":"","crystallizes":0,"defer_until":null,"description":"After cleanup, document the remaining acceptable baseline in LINTING.md so we can track regression.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-aec5439f","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Update LINTING.md with current baseline","updated_at":"2026-02-27T02:56:51Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale completed beads ‚Äî pollution sweep","closed_at":"2026-02-28T21:52:42Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"2ef3d645551826972aa46222dadde313a579098a8c3c2c21089d77487f8e2a43","created_at":"2026-02-28T04:46:58Z","created_by":"dog","crystallizes":0,"defer_until":null,"description":"Dolt maintenance completed successfully. Cleaned up 2 orphaned databases (gt, hq). Query latency improved from 1.096s to 701ms. Server is healthy and responsive.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-alx","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Dolt Janitor: Maintenance Completed","updated_at":"2026-02-28T21:52:42Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"eebecb7640cfdbd831fdf730b9ed10f71ca16c9a7001fdb8524d8234c6443f55","created_at":"2025-11-22T02:05:56Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Comprehensive improvements to bd command set based on 2025 audit findings.\n\n## Background\nSee docs/command-audit-2025.md for detailed analysis.\n\n## Goals\n1. Standardize flag naming and behavior across all commands\n2. Add missing flags for feature parity\n3. Fix naming confusion\n4. Improve consistency in JSON output\n\n## Success Criteria\n- All mutating commands support --dry-run (no --preview variants)\n- bd update supports label operations\n- bd search has filter parity with bd list\n- Priority flags accept both int and P0-P4 format everywhere\n- JSON output is consistent across all commands","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-au0","is_template":0,"issue_type":"epic","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Command Set Standardization \u0026 Flag Consistency","updated_at":"2026-02-27T02:56:51Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:52Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"e9dc417bb762e5d0066b83427537a7a85217c248606c63c6f5cd6ff678929a08","created_at":"2025-11-22T02:08:22Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Add consistent verbosity controls across all commands.\n\n**Current state:**\n- bd init has --quiet flag\n- No other commands have verbosity controls\n- Debug output controlled by BD_VERBOSE env var\n\n**Proposal:**\nAdd persistent flags:\n- --verbose / -v: Enable debug output\n- --quiet / -q: Suppress non-essential output\n\n**Implementation:**\n- Add to rootCmd.PersistentFlags()\n- Replace BD_VERBOSE checks with flag checks\n- Standardize output levels:\n  * Quiet: Errors only\n  * Normal: Errors + success messages\n  * Verbose: Errors + success + debug info\n\n**Files to modify:**\n- cmd/bd/main.go (add flags)\n- internal/debug/debug.go (respect flags)\n- Update all commands to respect quiet mode\n\n**Testing:**\n- Verify --verbose shows debug output\n- Verify --quiet suppresses normal output\n- Ensure errors always show regardless of mode","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-au0.10","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Add global verbosity flags (--verbose, --quiet)","updated_at":"2026-02-27T02:56:52Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"3f3afe5e8b2d10c35af95cd54b49006d6bfb3c20b44e43b8d8ad40a0e6784eca","created_at":"2025-11-22T02:07:05Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Add filter parity with bd list for consistent querying.\n\n**Missing filters to add:**\n- --priority, --priority-min, --priority-max\n- --created-after, --created-before\n- --updated-after, --updated-before\n- --closed-after, --closed-before\n- --empty-description, --no-assignee, --no-labels\n- --desc-contains, --notes-contains\n\n**Files to modify:**\n- cmd/bd/search.go\n- internal/rpc/protocol.go (SearchArgs)\n- internal/storage/storage.go (Search method)\n\n**Testing:**\n- All filter combinations\n- Date format parsing\n- Daemon and direct mode","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-au0.5","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Add date and priority filters to bd search","updated_at":"2026-02-27T02:56:51Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"6b2f68ffec92bbf23870cd18e13fd51ab809d7df51cfb89a21c09dda17a44542","created_at":"2025-11-22T02:07:19Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Enhance bd export with filtering options for selective exports.\n\n**Currently only has:**\n- --status\n\n**Add filters:**\n- --label, --label-any\n- --assignee\n- --type\n- --priority, --priority-min, --priority-max\n- --created-after, --created-before\n- --updated-after, --updated-before\n\n**Use case:**\n- Export only open issues: bd export --status open\n- Export high-priority bugs: bd export --type bug --priority-max 1\n- Export recent issues: bd export --created-after 2025-01-01\n\n**Files to modify:**\n- cmd/bd/export.go\n- Reuse filter logic from list.go","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-au0.6","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Add comprehensive filters to bd export","updated_at":"2026-02-27T02:56:51Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"550edf2404d2ed8830c54484dd6e45598bbbefd1f6cac647a22b8eef3fba038b","created_at":"2025-11-22T02:07:35Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Ensure consistent JSON format and error handling when --json flag is used.\n\n**Scope:**\n1. Verify all commands respect --json flag\n2. Standardize success response format\n3. Standardize error response format\n4. Document JSON schemas\n\n**Commands to audit:**\n- Core CRUD: create, update, delete, show, list, search ‚úì\n- Queries: ready, blocked, stale, count, stats, status\n- Deps: dep add/remove/tree/cycles\n- Labels: label commands\n- Comments: comments add/list/delete\n- Epics: epic status/close-eligible\n- Export/import: already support --json ‚úì\n\n**Testing:**\n- Success cases return valid JSON\n- Error cases return valid JSON (not plain text)\n- Consistent field naming (snake_case vs camelCase)\n- Array vs object wrapping consistency","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-au0.7","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Audit and standardize JSON output across all commands","updated_at":"2026-02-27T02:56:51Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:52Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"24a6567f818980abcba1eae59d81f200b8707e5e653174818cb8ac1a12754a02","created_at":"2025-11-22T02:07:50Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Clarify the difference between bd clean and bd cleanup to reduce user confusion.\n\n**Current state:**\n- bd clean: Remove temporary artifacts (.beads/bd.sock, logs, etc.)\n- bd cleanup: Delete old closed issues from database\n\n**Options:**\n1. Rename for clarity:\n   - bd clean ‚Üí bd clean-temp\n   - bd cleanup ‚Üí bd cleanup-issues\n   \n2. Keep names but improve help text and documentation\n\n3. Add prominent warnings in help output\n\n**Preferred approach:** Option 2 (improve documentation)\n- Update short/long descriptions in commands\n- Add examples to help text\n- Update README.md\n- Add cross-references in help output\n\n**Files to modify:**\n- cmd/bd/clean.go\n- cmd/bd/cleanup.go\n- README.md or ADVANCED.md","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-au0.8","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Improve clean vs cleanup command naming/documentation","updated_at":"2026-02-27T02:56:52Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:52Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"11c7ea08d20dc6e3860d657ed4a497f5f9df59ac0a5c7bab04b10151a27cea57","created_at":"2025-11-22T02:08:06Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Document use cases or consider deprecation for infrequently-used commands.\n\n**Commands to review:**\n1. bd rename-prefix - How often is this used? Document use cases\n2. bd detect-pollution - Consider integrating into bd validate\n3. bd migrate-hash-ids - One-time migration, keep but document as legacy\n\n**For each command:**\n- Document typical use cases\n- Add examples to help text\n- Consider if it should be a subcommand instead\n- Add deprecation warning if appropriate\n\n**Not changing:**\n- duplicates ‚úì (useful for data quality)\n- repair-deps ‚úì (useful for fixing broken refs)\n- restore ‚úì (critical for compacted issues)\n- compact ‚úì (performance feature)\n\n**Deliverable:**\n- Updated help text\n- Documentation in ADVANCED.md\n- Deprecation plan if needed","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-au0.9","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Review and document rarely-used commands","updated_at":"2026-02-27T02:56:52Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/obsidian","await_id":"","await_type":"","close_reason":"Completed with no code changes (already fixed or pushed directly to main)","closed_at":"2026-02-27T21:29:17Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"b4182825df5bf4b80437838ba9fdeee3491e21e7f942dae51b9fc01de3e5c670","created_at":"2025-12-17T02:17:22Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Code health review found internal/importer/importer_test.go has TestImportBugIntegration skipped with:\n\nTODO: Test hangs due to database deadlock - needs investigation\n\nThis indicates a potential unresolved concurrency issue in the importer. The test has been skipped for an unknown duration.\n\nFix: Investigate the deadlock, fix the underlying issue, and re-enable the test.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-b3og","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Fix TestImportBugIntegration deadlock in importer_test.go","updated_at":"2026-02-27T21:51:54Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/jasper","await_id":"","await_type":"","close_reason":"Completed with no code changes (already fixed or pushed directly to main)","closed_at":"2026-02-27T21:28:41Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"0d04cf4ad767b2df383883a76cd68c95174f0b9c9c584a0b64b8f0c33ac5b963","created_at":"2025-12-17T02:17:21Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Code health review found internal/storage/sqlite/dirty.go still exposes old ClearDirtyIssues() method (lines 103-108) which clears ALL dirty issues without checking what was actually exported.\n\nData loss risk: If export fails after some issues written to JSONL but before ClearDirtyIssues called, changes to remaining dirty issues will be lost.\n\nThe safer ClearDirtyIssuesByID() (lines 113-132) exists and clears only exported issues.\n\nFix: Either remove old method or mark it deprecated and ensure no code paths use it.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-b6xo","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Remove or fix ClearDirtyIssues() - race condition risk (bd-52)","updated_at":"2026-02-27T21:51:45Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"idle","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"b1d928cf02be321d67dfb72ed451d71a51fab04d8c45a46b860805a77fa3a754","created_at":"2026-02-28T00:30:34Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"bd-beads-polecat-amber\n\nrole_type: polecat\nrig: beads\nagent_state: nuked\nhook_bead: null\ncleanup_status: null\nactive_mr: null\nnotification_level: null","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-beads-polecat-amber","is_template":0,"issue_type":"agent","last_activity":"2026-02-28T01:01:55Z","metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"bd-beads-polecat-amber","updated_at":"2026-02-28T01:04:11Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"idle","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"4f2b0a1ea13c2a687163d228fb7000f92f0af49d717afef65bc83535c9f9bed3","created_at":"2026-02-27T23:55:03Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"bd-beads-polecat-garnet\n\nrole_type: polecat\nrig: beads\nagent_state: nuked\nhook_bead: null\ncleanup_status: null\nactive_mr: null\nnotification_level: null","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-beads-polecat-garnet","is_template":0,"issue_type":"agent","last_activity":"2026-02-28T00:34:03Z","metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"bd-beads-polecat-garnet","updated_at":"2026-02-28T00:41:31Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"working","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"76f449b63644eee1de495f7929750c6e29f5feaf5b67cc910742e2981ccfc53a","created_at":"2026-02-27T07:53:43Z","created_by":"beads/crew/emma","crystallizes":0,"defer_until":null,"description":"bd-beads-polecat-jasper\n\nrole_type: polecat\nrig: beads\nagent_state: spawning\nhook_bead: bd-5ua\ncleanup_status: null\nactive_mr: null\nnotification_level: null","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"bd-5ua","id":"bd-beads-polecat-jasper","is_template":0,"issue_type":"agent","last_activity":"2026-02-28T03:48:52Z","metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"bd-beads-polecat-jasper","updated_at":"2026-02-28T03:48:52Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"f8b0e3dd916bb2d56259a3477c35aec7f6d9e9d4ab695a7963f71438c688fd00","created_at":"2026-03-01T00:17:32Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"bd-beads-polecat-obsidian\n\nrole_type: polecat\nrig: beads\nagent_state: spawning\nhook_bead: bd-xmf\ncleanup_status: null\nactive_mr: null\nnotification_level: null","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-beads-polecat-obsidian","is_template":0,"issue_type":"agent","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"bd-beads-polecat-obsidian","updated_at":"2026-02-28T03:42:53Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"working","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"6df5c6a3b08a72569f1440647c3e1229989db842b8bb903dad72648461141bf0","created_at":"2026-02-27T07:54:03Z","created_by":"beads/crew/emma","crystallizes":0,"defer_until":null,"description":"bd-beads-polecat-onyx\n\nrole_type: polecat\nrig: beads\nagent_state: spawning\nhook_bead: bd-6bq\ncleanup_status: null\nactive_mr: null\nnotification_level: null","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"bd-6bq","id":"bd-beads-polecat-onyx","is_template":0,"issue_type":"agent","last_activity":"2026-02-28T03:49:11Z","metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"bd-beads-polecat-onyx","updated_at":"2026-02-28T03:49:11Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"idle","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"ceb3c462876e49af8e4f87964e2a3d7a0f8ddc171b0359a21c51a3f69ed2f48f","created_at":"2026-02-27T23:54:39Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"bd-beads-polecat-opal\n\nrole_type: polecat\nrig: beads\nagent_state: nuked\nhook_bead: null\ncleanup_status: null\nactive_mr: null\nnotification_level: null","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-beads-polecat-opal","is_template":0,"issue_type":"agent","last_activity":"2026-02-28T00:29:24Z","metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"bd-beads-polecat-opal","updated_at":"2026-02-28T00:41:54Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"done","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"c852c566fdf3d2552e8983a8bf60ab890ddf1789d4bae0d2741c9ae684449ff2","created_at":"2026-02-27T23:54:07Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"bd-beads-polecat-quartz\n\nrole_type: polecat\nrig: beads\nagent_state: spawning\nhook_bead: bd-dgp\ncleanup_status: clean\nactive_mr: bd-wisp-kf100\nnotification_level: null\nexit_type: COMPLETED\nmr_id: bd-wisp-kf100\nbranch: polecat/quartz/bd-dgp@mm5rzuut\ncompletion_time: 2026-02-28T03:54:38Z","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-beads-polecat-quartz","is_template":0,"issue_type":"agent","last_activity":"2026-02-28T03:54:43Z","metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"bd-beads-polecat-quartz","updated_at":"2026-02-28T03:54:44Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"idle","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"358576db035632fa65702961f2da4505165d129bc9600d40f703694e1fc901ed","created_at":"2026-02-27T23:55:15Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"bd-beads-polecat-ruby\n\nrole_type: polecat\nrig: beads\nagent_state: nuked\nhook_bead: null\ncleanup_status: null\nactive_mr: null\nnotification_level: null","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-beads-polecat-ruby","is_template":0,"issue_type":"agent","last_activity":"2026-02-28T00:41:05Z","metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"bd-beads-polecat-ruby","updated_at":"2026-02-28T00:43:11Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"idle","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"c7d57ad8f347f496c4ca78724b53ffc2c0af3e549327c8c61afee7e261289b7d","created_at":"2026-02-27T23:54:51Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"bd-beads-polecat-topaz\n\nrole_type: polecat\nrig: beads\nagent_state: nuked\nhook_bead: null\ncleanup_status: null\nactive_mr: null\nnotification_level: null","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-beads-polecat-topaz","is_template":0,"issue_type":"agent","last_activity":"2026-02-28T00:35:06Z","metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"bd-beads-polecat-topaz","updated_at":"2026-02-28T00:41:42Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Test artifact cleanup (Clown Show #21)","closed_at":"2026-02-27T02:53:49Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"9c7427d42901c368abcfbea23e8bc796a21b338dedf8fdab81e782c30683bf07","created_at":"2025-12-14T04:43:23Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Umbrella epic for improving overall test coverage from 47.8% to 65%+.\n\n## Summary\n\n| Package | Current | Target | Issue |\n|---------|---------|--------|-------|\n| internal/compact | 18.2% | 70% | bd-thgk |\n| cmd/bd/doctor/fix | 23.9% | 50% | bd-fx7v |\n| cmd/bd | 26.2% | 50% | bd-llfl |\n| internal/daemon | 27.3% | 60% | bd-n386 |\n| cmd/bd/setup | 28.4% | 50% | bd-sh4c |\n| internal/syncbranch | 33.0% | 70% | bd-io8c |\n| internal/export | 37.1% | 60% | bd-6sm6 |\n| internal/lockfile | 42.0% | 60% | bd-9w3s |\n| internal/rpc | 47.5% | 60% | bd-m8ro |\n| internal/beads | 48.1% | 70% | bd-tvu3 |\n| internal/storage | N/A | basic | bd-a15d |\n\n## Packages with good coverage (no action needed)\n- internal/types: 91.0%\n- internal/utils: 88.9%\n- internal/deletions: 84.3%\n- internal/config: 84.2%\n- internal/autoimport: 83.5%\n- internal/validation: 80.8%\n- internal/merge: 78.9%\n- internal/routing: 74.3%\n- internal/storage/sqlite: 73.1%\n- internal/importer: 70.2%\n\nOverall target: 65%+ (from current 47.8%)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-bvec","is_template":0,"issue_type":"epic","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Test coverage improvement initiative (47.8% ‚Üí 65%)","updated_at":"2026-02-27T02:53:49Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/obsidian","await_id":"","await_type":"","close_reason":"Completed with no code changes (already fixed or pushed directly to main)","closed_at":"2026-02-28T00:25:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"79390f80028f6ecb62fb0b5cb47ef844842b2d3e924c3b32c001bdfaa0bd4206","created_at":"2025-11-16T22:51:55Z","created_by":"","crystallizes":0,"defer_until":null,"description":"80+ instances of inconsistent error handling across sqlite.go with mix of %w, %v, and no wrapping.\n\nLocation: internal/storage/sqlite/sqlite.go (throughout)\n\nProblem:\n- Some use fmt.Errorf(\"op failed: %w\", err) - correct wrapping\n- Some use fmt.Errorf(\"op failed: %v\", err) - loses error chain\n- Some return err directly - no context\n- Hard to debug production issues\n- Can't distinguish error types\n\nSolution: Create internal/storage/sqlite/errors.go:\n- Define sentinel errors (ErrNotFound, ErrInvalidID, etc.)\n- Create wrapDBError(op string, err error) helper\n- Convert sql.ErrNoRows to ErrNotFound\n- Always wrap with operation context\n\nImpact: Lost error context; inconsistent messages; hard to debug\n\nEffort: 5-7 hours","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-bwk2","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implemented centralized error handling in dolt storage layer:\n\n1. Created internal/storage/dolt/errors.go with:\n   - Sentinel errors: ErrTransaction, ErrQuery, ErrScan, ErrExec\n   - Helper functions: wrapDBError, wrapTransactionError, wrapScanError, wrapQueryError, wrapExecError\n   - wrapDBError converts sql.ErrNoRows ‚Üí storage.ErrNotFound\n\n2. Applied wrapping to ~85 bare return err patterns across 12 files:\n   - transaction.go, queries.go, dependencies.go, issues.go, wisps.go\n   - ephemeral_routing.go, credentials.go, versioned.go, labels.go\n   - federation.go\n\n3. Key design decisions:\n   - scanIssueFrom left unwrapped: callers check sql.ErrNoRows explicitly\n   - Final rows.Err() returns left idiomatic (caller provides context)\n   - Store-level pass-throughs (withRetry, Close) left unwrapped\n   - All existing fmt.Errorf wrapping preserved\n\n4. Tests: All storage tests pass. Unit tests for error helpers included.","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Centralize error handling patterns in storage layer","updated_at":"2026-02-28T00:26:45Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/obsidian","await_id":"","await_type":"","close_reason":"Completed with no code changes (already fixed or pushed directly to main)","closed_at":"2026-02-28T02:49:19Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"388d0a414a975844ff0acdd37365ad9fb2ad4d679283588a94fda1fb4779aa12","created_at":"2026-02-28T02:42:01Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"Review internal/storage/ (especially dolt/store.go) and internal/configfile/ for: hardcoded database names, hardcoded table structures that should be schema-driven, Go code making decisions that should be agent decisions, string matching on wisp content, hardcoded status transitions. Also check for Dolt-specific assumptions that would break portability. File beads for each issue found.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-cgk","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"## Code Review Findings: Storage Layer\n\n### Summary\nReviewed internal/storage/ (~14 files, ~5000 LOC) and internal/configfile/ (~1 file, 350 LOC).\nFound 7 categories of issues with hardcoded assumptions and ZFC violations.\n\n### 1. HARDCODED DATABASE NAME \"beads\" (4 locations)\n- store.go:445 - applyConfigDefaults defaults to \"beads\" when no config\n- bootstrap.go:43 - BootstrapFromGitRemoteWithDB defaults database to \"beads\"\n- bootstrap.go:100 - schemaReady defaults dbName to \"beads\"\n- configfile.go:47 - DefaultConfig uses \"beads.db\" for Database field\n\nThese should be centralized into a single constant or config resolution.\n\n### 2. HARDCODED INFRA TYPES - Go code making agent-level decisions (2 locations)\n- ephemeral_routing.go:22-27 - IsInfraType hardcodes \"agent\", \"rig\", \"role\", \"message\"\n- migrations/007_infra_to_wisps.go:11 - infraTypes duplicates the same list\n\nThe storage layer DECIDES which types are \"infrastructure\" and routes them\nto the wisps table. This is a policy decision that should be agent-configurable,\nnot hardcoded in Go. If Gas Town adds a new infra type (e.g., \"formula\", \"slot\"),\na code change + release is required.\n\n### 3. HARDCODED STATUS LISTS IN SQL VIEWS (schema.go)\n- schema.go:279 - ready_issues view: IN (open, in_progress, blocked, deferred, hooked)\n- schema.go:326 - blocked_issues view: IN (open, in_progress, blocked, deferred, hooked)\n- dependencies.go:779 - IsBlocked: IN (open, in_progress, blocked, deferred, hooked)\n- dependencies.go:834 - GetNewlyUnblockedByClose: IN (open, blocked)\n- dependencies.go:877 - GetNewlyUnblockedByClose: IN (open, in_progress, blocked, deferred, hooked)\n\nCustom statuses (config key \"status.custom\") are supported for validation but\nNOT reflected in these SQL views. A custom status like \"review\" would be\ninvisible to the ready_issues view, making issues with that status permanently\ninvisible to GetReadyWork.\n\n### 4. HARDCODED STATUS IN COMPACT.GO - Go code deciding agent logic\n- compact.go:35 - status != \"closed\" check uses string literal instead of types.StatusClosed\n- compact.go:49,59 - Magic numbers for compaction days (30, 90) hardcoded, though\n  config keys exist (compact_tier1_days, compact_tier2_days) they are not read.\n\n### 5. STRING-MATCHING ON WISP CONTENT - ephemeral_routing.go\n- ephemeral_routing.go:15 - IsEphemeralID checks strings.Contains(id, \"-wisp-\")\n\nThis is a convention-based routing that breaks when wisps have explicit IDs\n(GH#2053 noted in code). The code already has workarounds (isActiveWisp,\npartitionByWispStatus) but the fundamental pattern of routing by ID substring\nis fragile.\n\n### 6. DOLT-SPECIFIC ASSUMPTIONS THAT BREAK PORTABILITY\n- store.go:848 - CALL DOLT_COMMIT during schema init\n- versioned.go:52-62 - dolt_diff(), AS OF, DOLT_HASHOF() - Dolt-only functions\n- versioned.go:142 - dolt_branches table query\n- federation.go:19 - DOLT_PUSH, DOLT_PULL, DOLT_FETCH - Dolt procedures\n- versioned.go:253 - DOLT_CONFLICTS_RESOLVE procedure\n- store.go:795-796 - CREATE DATABASE IF NOT EXISTS with Dolt catalog race workarounds\n- history.go:83-86 - dolt_history_issues table (Dolt-specific virtual table)\n- versioned.go:204-212 - dolt_log table query\n\nThe Storage interface (storage.go) is clean, but the concrete Dolt implementation\nuses Dolt-specific stored procedures and virtual tables extensively. If a\nnon-Dolt backend were added, the versioned/federation features would need\nseparate interface extension points.\n\n### 7. HARDCODED DEFAULT CONFIG VALUES (schema.go:250-263)\n- defaultConfig embeds specific defaults: compact_model = \"claude-haiku-4-5-20251001\",\n  compact_batch_size = 50, types.custom = specific list including \"molecule,gate,convoy...\"\n- These are Gas Town operational constants baked into the storage layer schema init.\n\n### Non-issues (well-designed patterns)\n- Custom types/statuses: config.go reads from DB config table with YAML fallback - good\n- issue_scan.go: Centralized scan via issueSelectColumns - avoids column drift\n- configfile.go: All server params have env var overrides - good for portability\n- transactions.go: Clean interface with proper commit semantics\n- Test database firewall: Pattern-based guard against test pollution - solid defense","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Code review: storage layer for hardcoded assumptions and ZFC violations","updated_at":"2026-02-28T02:49:48Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"666dc8dbe3139d4b9d346f522522123fd1f88a6c97d506ba37f90849cd53b5cb","created_at":"2025-12-07T23:48:37Z","created_by":"","crystallizes":0,"defer_until":null,"description":"The FindBeadsDir function should prioritize finding .beads in the main repository root when accessed from a worktree, rather than finding worktree-local .beads directories. This ensures proper sharing of the database across all worktrees.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-de6","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Fix FindBeadsDir to prioritize main repo .beads for worktrees","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/quartz","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-28T03:54:42Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"2a75d95e5f25ea172a5868ac8521eb33aec0aef8fc7eb41ce66c4c83ecc7354d","created_at":"2026-02-28T03:42:10Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"attached_molecule: bd-wisp-jtdkj\nattached_formula: mol-polecat-work\nattached_at: 2026-02-28T03:43:05Z\ndispatched_by: mayor\n\ncmd/bd/protocol takes 81s. Likely protocol integration tests hitting Dolt. Check for: per-test server startup, serial execution, tests that could share fixtures. Target: under 30s.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-dgp","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"Added t.Parallel() to all 45 protocol tests. Baseline: 135s serial ‚Üí 42-58s parallel (3x speedup). Tests are already fully isolated (unique Dolt prefix, temp dir, git repo per test) so parallelization is safe.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Speed up cmd/bd/protocol tests (81s)","updated_at":"2026-02-28T03:54:42Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"0aed12f2b3d70fc06eb230a83b75e59420a33207581c68dc195913fc0c607ba7","created_at":"2025-12-17T02:17:30Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Code health review found main.go has 25+ global variables (lines 57-112):\n\n- dbPath, actor, store, jsonOutput, daemonClient, noDaemon\n- rootCtx, rootCancel, autoFlushEnabled\n- isDirty (marked 'USED BY LEGACY CODE')\n- needsFullExport (marked 'USED BY LEGACY CODE')\n- flushTimer (marked 'DEPRECATED')\n- flushMutex, storeMutex, storeActive\n- flushFailureCount, lastFlushError, flushManager\n- skipFinalFlush, autoImportEnabled\n- versionUpgradeDetected, previousVersion, upgradeAcknowledged\n\nImpact:\n- Hard to test individual commands\n- Race conditions possible\n- State leakage between commands\n\nFix: Move toward dependency injection. Remove deprecated variables. Consider cmd/bd/internal package.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-dhza","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Reduce global state in cmd/bd/main.go (25+ variables)","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:52Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"d6e480b3c330e8c7bfa378923affc18e98893dcc4d5713a76fcb9e7992d91487","created_at":"2025-10-30T06:05:14Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Run all validation checks in one command.\n\nChecks:\n- Duplicates\n- Orphaned dependencies\n- Test pollution\n- Git conflicts\n\nSupports --fix-all for auto-repair.\n\nDepends on bd-cbed9619.1, bd-0dcea000, bd-31aab707, bd-9826b69a.\n\nFiles: cmd/bd/validate.go (new)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-e1085716","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"bd validate - Comprehensive health check","updated_at":"2026-02-27T02:56:52Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/obsidian","await_id":"","await_type":"","close_reason":"Fix merged to main as 852bfe65. TestShimExtract_FullMigration now passes.","closed_at":"2026-02-28T02:17:31Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"c5c4d80584a211ddbd57016e02935772a9aa6d7eb652c561fc9981dd73f1ebb3","created_at":"2026-02-28T00:52:12Z","created_by":"beads/refinery","crystallizes":0,"defer_until":null,"description":"TestShimExtract_FullMigration fails on main. The test expects beads.db to be renamed to .migrated during shim extraction, but migration doesn't complete. Backend stays sqlite instead of switching to dolt. File: cmd/bd/migrate_shim_test.go","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-e5e","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Root cause: Test config set Backend:\"sqlite\" which triggered the GH#2016 guard in doShimMigrate (line 66-69) that skips migration when backend is explicitly sqlite. Fix: Remove Backend field from test config ‚Äî empty backend represents a legacy pre-Dolt config that needs migration.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Pre-existing test failure: TestShimExtract_FullMigration in cmd/bd","updated_at":"2026-02-28T02:18:58Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/onyx","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-28T00:11:17Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"9698a81cfa1cc125687c85a0128f404c220dc79bafb0a099b3b7ed5b30fc6ea8","created_at":"2025-11-21T15:25:34Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Test coverage gap identified by automated analysis (vc-217).\n\n**Original Issue:** [deleted:[deleted:bd-da96-baseline-lint]]\n\nIn cmd/bd/doctor/gitignore.go:98, os.WriteFile uses 0644 permissions, flagged by gosec G306 as potentially too permissive.\n\nAdd tests to verify:\n- File is created with appropriate permissions (0600 or less)\n- Existing file permissions are not loosened\n- File ownership is correct\n- Sensitive data handling if .gitignore contains secrets\n\nThis ensures .gitignore files are created with secure permissions to prevent unauthorized access.\n\n_This issue was automatically created by AI test coverage analysis._","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-ee1","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implemented: Added 6 security tests covering WriteFile permissions in doctor package:\n- TestEnsureProjectGitignore_FilePermissions: verifies 0644 for new project .gitignore, 0600 preserved for existing\n- TestEnsureProjectGitignore_DoesNotLoosenPermissions: ensures existing restrictive perms not widened\n- TestGitignoreTemplate_NoSensitivePatterns: checks template for sensitive keywords\n- TestCheckPermissions_TempFileUsesSecurePerms: verifies temp file uses 0600\n- TestCheckPermissions_CleansUpOnSuccess: verifies temp file removed after check\nAll tests pass. Only test files modified (no production code changes needed ‚Äî gosec G306 was already addressed).","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Add security tests for WriteFile permissions in doctor command","updated_at":"2026-02-28T00:11:17Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"29c7b25cab21e9c82c5e76747506097b554e63ea3907328c5ddf401b4bc3f707","created_at":"2025-12-06T00:37:02Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Several tombstone merge tests use time.Now() to create test data: time.Now().Add(-24 * time.Hour), time.Now().Add(-60 * 24 * time.Hour), etc. While these work reliably in practice (24h vs 30d TTL has large margin), they could theoretically be flaky if: 1) Tests run slowly, 2) System clock changes during test, 3) TTL constants change. Recommendation: Consider using a fixed reference time or time injection for deterministic tests. Lower priority since current margin is large. Files: internal/merge/merge_test.go:1337-1338, 1352-1353, 1548-1549, 1590-1591","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-eyto","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Time-dependent tests may be flaky near TTL boundary","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/quartz","await_id":"","await_type":"","close_reason":"Completed with no code changes (already fixed or pushed directly to main)","closed_at":"2026-02-28T05:11:50Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"2b6e3bed3789270a71067fc75d470be76e99dde249175e22676ee06455d924c8","created_at":"2026-02-28T05:05:17Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"attached_formula: mol-polecat-work\ndispatched_by: mayor\n\nbd show --allow-stale still triggers the 'database out of sync: issues.jsonl is newer than last import' error and refuses to proceed. The flag should skip this check entirely. This blocks gt sling (which calls bd show --json --allow-stale internally) when JSONL files have a newer mtime than the stored last-import timestamp. Workaround: remove the issues.jsonl file.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-f49","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"--allow-stale flag does not bypass JSONL staleness check","updated_at":"2026-02-28T05:11:50Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/quartz","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-27T08:03:44Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"83c7ab6393333a7135931b00cc5665c983a72c8c2ce37f4669e2f773ba5c056a","created_at":"2026-02-27T07:48:26Z","created_by":"beads/crew/emma","crystallizes":0,"defer_until":null,"description":"The Dolt store already has working methods for remote management ‚Äî AddRemote(), HasRemote(), ListRemotes(), RemoveRemote() ‚Äî and bd dolt push/pull work. But there's no CLI command to manage remotes. Users must drop to the dolt CLI directly to add a git remote.\n\nAdd subcommands:\n- bd dolt remote add \u003cname\u003e \u003curl\u003e  ‚Äî calls store.AddRemote()\n- bd dolt remote list               ‚Äî calls store.ListRemotes()  \n- bd dolt remote remove \u003cname\u003e      ‚Äî calls store.RemoveRemote()\n\nThis completes the Dolt-to-git-remote story so users never need the dolt CLI for basic replication setup.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-fhh","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Add 'bd dolt remote' subcommands (add/list/remove)","updated_at":"2026-02-27T08:05:14Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/quartz","await_id":"","await_type":"","close_reason":"Completed with no code changes (already fixed or pushed directly to main)","closed_at":"2026-02-28T00:25:34Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"a287f661fbdd65c426e801fdfbb3b192a582cda87c13166b1958cdc837020b31","created_at":"2026-02-27T01:32:41Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"IsEphemeralID() routes bd-wisp-* IDs to wisps table, but promoted wisps (via PromoteFromEphemeral) live in the issues table with ephemeral=0. Result: bd close bd-wisp-xxx fails with 'not found'. Workaround: raw SQL UPDATE. Fix: routing should fall through to issues table when wisp table lookup fails for wisp-pattern IDs.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-ftc","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Fix: partitionByWispStatus now verifies wisp-pattern IDs exist in wisps table before routing. Promoted wisps (which have -wisp- in ID but live in issues table) are correctly routed to the issues table. Root cause was GetIssuesByIDs -\u003e partitionByWispStatus trusting pattern-based routing without verifying actual table membership.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"bd close cannot find promoted wisps with wisp-pattern IDs","updated_at":"2026-02-28T00:26:09Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Duplicate of bd-qy0","closed_at":"2026-02-28T00:16:33Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"df10168fe6ed2c8063c5a6157218e172e8619099a32b64f93002dc099ade15cb","created_at":"2026-02-28T00:15:29Z","created_by":"beads/refinery","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-fu1","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Pre-existing test failures: TestInitRedirect, TestInitBEADS_DIR in cmd/bd","updated_at":"2026-02-28T00:16:33Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:50Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"f72914b046c203ef363f22b836524b0be62d2c61ec926a2bb08524ef632c2750","created_at":"2025-12-14T04:43:06Z","created_by":"","crystallizes":0,"defer_until":null,"description":"The doctor/fix package has only 23.9% test coverage. The doctor fix functionality is important for troubleshooting.\n\nCurrent coverage: 23.9%\nTarget coverage: 50%","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-fx7v","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Improve test coverage for cmd/bd/doctor/fix (23.9% ‚Üí 50%)","updated_at":"2026-02-27T02:56:50Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"71c5eeb7c15683938783afe0712fb5cd69f0751b68fa3b1f2c704db5db941d5e","created_at":"2025-11-20T23:55:19Z","created_by":"","crystallizes":0,"defer_until":null,"description":"TestRoutingIntegration/maintainer_with_SSH_remote failed during pre-commit check with \"expected role maintainer, got contributor\".\nThis occurred while running `go test -short ./...` on darwin/arm64.\nThe failure appears unrelated to storage/sqlite changes.\nNeed to investigate if this is a flaky test or environmental issue.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-g9eu","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Investigate TestRoutingIntegration failure","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Squashed from 7 wisps","closed_at":"2026-02-26T23:02:57Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"02d0b088c8c2833c9e2e3e88f2b333e8896008d53343a67a500e10e4b220d944","created_at":"2026-02-26T23:02:57Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Patrol 3: Quiet rig. No polecats, no mail, no swarms, no timer gates. Refinery alive (8h), Deacon alive. Escalated broken beads redirect to Mayor.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-gb8vd","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Digest: mol-witness-patrol","updated_at":"2026-02-26T23:02:57Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"3f060bce36653c7b56675979f7f06ea24c72a5e39f0d023bac3c43bb13d064a7","created_at":"2025-12-14T17:40:15Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Beads can get into unrecoverable sync states when remote forces pushes occur (e.g., rebases) combined with prefix mismatches from multi-worker scenarios. Add detection, prevention, and auto-recovery features to handle this gracefully.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-hlsw","is_template":0,"issue_type":"epic","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Add sync resilience guardrails for forced pushes and prefix mismatches","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"587b1206153e89944e9f335f98cace18ce5886f023a3941f97669bfdd4c27e80","created_at":"2025-12-14T17:40:21Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Add bd sync --auto-recover flag that: detects problematic sync state, backs up .beads/issues.db with timestamp, rebuilds DB from JSONL atomically, verifies consistency, reports what was fixed. Provides safety valve when sync integrity fails.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-hlsw.3","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Auto-recovery mode (bd sync --auto-recover)","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"551802eafe1c553581e0110ea0a2348a8b17f3bf0ab764825d7237febb0e4683","created_at":"2025-12-14T17:40:21Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Track sync branch parent commit. If sync branch was force-pushed, warn user and require confirmation before proceeding. Add option to reset to remote if user accepts rebase. Prevents silent corruption from forced pushes.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-hlsw.4","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Sync branch integrity guards","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"mayor/","await_id":"","await_type":"","close_reason":"Stale alert from 2026-02-28 04:47. JSONL backup ticker running. Dolt server healthy.","closed_at":"2026-03-01T00:08:19Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"6c1f21741412cf4fd70ef4ce940a75a6614fc736bd49260e6aff77c76cd49784","created_at":"2026-02-28T04:47:43Z","created_by":"overseer","crystallizes":0,"defer_until":null,"description":"Escalation ID: bd-wisp-let5a\nSeverity: critical\nFrom: overseer\n\nReason:\nJSONL is our last-resort recovery layer. 3 databases failed to export.\n\n---\nTo acknowledge: gt escalate ack bd-wisp-let5a\nTo close: gt escalate close bd-wisp-let5a --reason \"resolution\"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-k8e","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":0,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"[CRITICAL] JSONL export failed for 3 databases","updated_at":"2026-03-01T00:08:19Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"787a24af241d389e3fc7242650d372c440fe4519b7c88e0418c4574e7cdba05b","created_at":"2025-11-04T19:23:14Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Current: Each of 13 CLI tests calls git init (31s total). Solution: Use single test binary built once in init(), skip git operations where possible, or use mock filesystem.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-ktng","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Optimize CLI test suite - eliminate redundant git init calls","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:52Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"f1478689a80a13265002604ebc7fbf2b707e53f3e48d211bcf5b256f442d82e9","created_at":"2025-12-16T11:00:54Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Add messaging semantics and extended graph links to Beads, enabling it to serve as\nthe universal substrate for knowledge work - issues, messages, documents, and threads\nas nodes in a queryable graph.\n\n## Motivation\n\nGas Town (GGT) needs inter-agent communication. Rather than a separate mail system,\ncollapse messaging into Beads - one system, one sync, one query interface, all in git.\n\nThis also positions Beads as a foundation for:\n- Company-wide issue tracking (like Notion)\n- Threaded conversations (like Reddit/Slack)\n- Knowledge graphs with loose associations\n- Arbitrary workflow UIs built on top\n\n## New Issue Type\n\n**message** - ephemeral communication between workers\n- sender: who sent it\n- assignee: recipient\n- priority: P0 (urgent) to P4 (routine)\n- status: open (unread) -\u003e closed (read)\n- ephemeral: true = can be bulk-deleted after swarm\n\n## New Graph Links\n\n**replies_to** - conversation threading\n- Messages reply to messages\n- Enables Reddit-style nested threads\n- Different from parent_id (not hierarchy, its conversation flow)\n\n**relates_to** - loose see also associations\n- Bidirectional knowledge graph edges\n- Not blocking, not hierarchical, just related\n- Enables discovery and traversal\n\n**duplicates** - deduplication at scale\n- Mark issue B as duplicate of canonical issue A\n- Close B, link to A\n- Essential for large issue databases\n\n**supersedes** - version chains\n- Design Doc v2 supersedes Design Doc v1\n- Track evolution of artifacts\n\n## New Fields (optional, any issue type)\n\n- sender (string) - who created this (for messages)\n- ephemeral (boolean) - can be bulk-deleted when closed\n\n## New Commands\n\nMessaging:\n- bd mail send \u003crecipient\u003e -s Subject -m Body\n- bd mail inbox (list open messages for me)\n- bd mail read \u003cid\u003e (show message content)\n- bd mail ack \u003cid\u003e (mark as read/close)\n- bd mail reply \u003cid\u003e -m Response (reply to thread)\n\nGraph links:\n- bd relate \u003cid1\u003e \u003cid2\u003e (create relates_to link)\n- bd duplicate \u003cid\u003e --of \u003ccanonical\u003e (mark as duplicate)\n- bd supersede \u003cid\u003e --with \u003cnew\u003e (mark superseded)\n\nCleanup:\n- bd cleanup --ephemeral (delete closed ephemeral issues)\n\n## Identity Configuration\n\nWorkers need identity for sender field:\n- BEADS_IDENTITY env var\n- Or .beads/config.json: identity field\n\n## Hooks (for GGT integration)\n\nBeads as platform - extensible without knowing about GGT.\nHook files in .beads/hooks/:\n- on_create (runs after bd create)\n- on_update (runs after bd update)\n- on_close (runs after bd close)\n- on_message (runs after bd mail send)\n\nGGT registers hooks to notify daemons of new messages.\n\n## Schema Changes (Migration Required)\n\nAdd to issue schema:\n- type: message (new valid type)\n- sender: string (optional)\n- ephemeral: boolean (optional)\n- replies_to: string (issue ID, optional)\n- relates_to: []string (issue IDs, optional)\n- duplicates: string (canonical issue ID, optional)\n- superseded_by: string (new issue ID, optional)\n\nMigration adds fields as optional - existing beads unchanged.\n\n## Success Criteria\n\n1. bd mail send/inbox/read/ack/reply work end-to-end\n2. replies_to creates proper thread structure\n3. relates_to, duplicates, supersedes links queryable\n4. Hooks fire on create/update/close/message\n5. Identity configurable via env or config\n6. Migration preserves all existing data\n7. All new features have tests","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-kwro","is_template":0,"issue_type":"epic","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":0,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Beads Messaging \u0026 Knowledge Graph (v0.30.2)","updated_at":"2026-02-27T02:56:52Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:53Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"ccdcf5016441f10ca01969cf2e216a07c38b27d73b36a2998e0a34fa807989a2","created_at":"2025-12-16T11:02:40Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Document all new features.\n\nFiles to update:\n- README.md - brief mention of messaging capability\n- AGENTS.md - update for AI agents using bd mail\n- docs/messaging.md (new) - full messaging reference\n- docs/graph-links.md (new) - graph link reference\n- CHANGELOG.md - v0.30.2 release notes\n\nTopics to cover:\n- Mail commands with examples\n- Graph link types and use cases\n- Identity configuration\n- Hooks setup for notifications\n- Migration notes","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-kwro.11","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Documentation for messaging and graph links","updated_at":"2026-02-27T02:56:53Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/obsidian","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-28T01:05:14Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"f3f0df81972afa198beef03c199b82407a9833d93b06230243979fb2a5de4daf","created_at":"2026-02-27T18:28:39Z","created_by":"beads/refinery","crystallizes":0,"defer_until":null,"description":"Tests in cmd/bd, internal/molecules, internal/storage/dolt, and internal/storage/dolt/compact fail because the test harness runs gt dolt start which fails with 'not in a Gas Town workspace' when run from a refinery rig worktree. Pre-existing issue.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-kyu","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Fix: Added BEADS_TEST_MODE guard to IsDaemonManaged() branch in newServerMode (store.go:579). When BEADS_TEST_MODE is set, the code skips the gt dolt start path and falls through to the generic error, letting test-managed servers handle their own lifecycle. All affected test packages pass: internal/storage/dolt, internal/molecules, cmd/bd.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Dolt tests fail in refinery worktree: gt dolt start not in Gas Town workspace","updated_at":"2026-02-28T01:05:14Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/obsidian","await_id":"","await_type":"","close_reason":"Completed with no code changes (already fixed or pushed directly to main)","closed_at":"2026-02-28T00:22:38Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"8999687c02c01ab45049e2a5023ff55b314375acf5c7500e536d17fc3f282561","created_at":"2026-02-27T19:45:21Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"Solo Beads users (no Gas Town, no Dogs) need built-in data lifecycle management. Three new bd subcommands: (1) bd gc ‚Äî runs DECAY+COMPACT+GC in sequence (delete old closed issues, rebase commits, dolt gc), (2) bd compact ‚Äî rebase old commits older than N days (default 30), (3) bd flatten ‚Äî nuclear squash all history to one commit (Tim Sehn recipe: branch, soft-reset to initial, commit, swap main, gc). Auto-compact: bd could check last compact date on startup and suggest/auto-run if stale. This is critical for Beads adoption ‚Äî without it, solo users hit storage limits. Sent briefing to bd-crew-emma.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-kzn","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implemented three new top-level maintenance commands:\n\n1. bd gc: Full lifecycle GC with three phases (decay/compact/dolt-gc). Decay deletes closed issues older than N days (default 90), compact phase reports commit count and suggests bd flatten, dolt gc phase runs dolt gc to reclaim space. Supports --dry-run, --force, --older-than, --skip-decay, --skip-dolt, --json.\n\n2. bd compact: Squashes Dolt commits older than N days (default 30) into a single base commit, then cherry-picks recent commits on top. Uses dolt CLI operations (branch, checkout, reset --soft, cherry-pick). Supports --dry-run, --force, --days, --json.\n\n3. bd flatten: Nuclear squash of ALL Dolt history into a single commit using the Tim Sehn recipe (branch, soft-reset to initial commit, commit, swap main, gc). Irreversible. Supports --dry-run, --force, --json.\n\nAll commands in the maint group. Removed deprecated compact alias (was forwarding to bd admin compact) to make room for the new Dolt commit compaction command.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"bd gc / bd compact / bd flatten commands for standalone Beads","updated_at":"2026-02-28T00:23:19Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"659c82934d1d8633e09b97e030a59b2af6731e4d92d3f27dfb33131789b416ac","created_at":"2025-12-14T02:01:40Z","created_by":"","crystallizes":0,"defer_until":null,"description":"## Vision\n\nEncode project-specific institutional knowledge into executable checks. CONTRIBUTING.md is documentation that's read once and forgotten; `bd preflight` is documentation that runs at exactly the right moment.\n\n## Problem Statement\n\nContributors face a \"last mile\" problem - they do the work but stumble on project-specific gotchas at PR time:\n- Nix vendorHash gets stale when go.sum changes\n- Beads artifacts leak into PRs (see bd-umbf for namespace solution)\n- Version mismatches between version.go and default.nix\n- Tests/lint not run locally before pushing\n- Other project-specific checks that only surface when CI fails\n\nThese are too obscure to remember, exist in docs nobody reads end-to-end, and waste CI round-trips.\n\n## Why beads?\n\nBeads already has a foothold in the contributor workflow. It knows:\n- Git state (staged files, branch, dirty status)\n- Project structure\n- The specific issue being worked on\n- Project-specific configuration\n\n## Proposed Interface\n\n### Tier 1: Checklist Mode (v1)\n\n    $ bd preflight\n    PR Readiness Checklist:\n\n    [ ] Tests pass: go test -short ./...\n    [ ] Lint passes: golangci-lint run ./...\n    [ ] No beads pollution: check .beads/issues.jsonl diff\n    [ ] Nix hash current: go.sum unchanged or vendorHash updated\n    [ ] Version sync: version.go matches default.nix\n\n    Run 'bd preflight --check' to validate automatically.\n\n### Tier 2: Check Mode (v2)\n\n    $ bd preflight --check\n    ‚úì Tests pass\n    ‚úì Lint passes\n    ‚ö† Beads pollution: 3 issues in diff - are these project issues or personal?\n    ‚úó Nix hash stale: go.sum changed, vendorHash needs update\n      Fix: sha256-KRR6dXzsSw8OmEHGBEVDBOoIgfoZ2p0541T9ayjGHlI=\n    ‚úì Version sync\n\n    1 error, 1 warning. Run 'bd preflight --fix' to auto-fix where possible.\n\n### Tier 3: Fix Mode (v3)\n\n    $ bd preflight --fix\n    ‚úì Updated vendorHash in default.nix\n    ‚ö† Cannot auto-fix beads pollution - manual review needed\n\n## Checks to Implement\n\n| Check | Description | Auto-fixable |\n|-------|-------------|--------------|\n| tests | Run go test -short ./... | No |\n| lint | Run golangci-lint | Partial (gofmt) |\n| beads-pollution | Detect personal issues in diff | No (see bd-umbf) |\n| nix-hash | Detect stale vendorHash | Yes (if nix available) |\n| version-sync | version.go matches default.nix | Yes |\n| no-debug | No TODO/FIXME/console.log | Warn only |\n| clean-stage | No unintended files staged | Warn only |\n\n## Future: Configuration\n\nMake checks configurable per-project via .beads/preflight.yaml:\n\n    preflight:\n      checks:\n        - name: tests\n          run: go test -short ./...\n          required: true\n        - name: no-secrets\n          pattern: \"**/*.env\"\n          staged: deny\n        - name: custom-check\n          run: ./scripts/validate.sh\n\nThis lets any project using beads define their own preflight checks.\n\n## Implementation Phases\n\n### Phase 1: Static Checklist\n- Implement bd preflight with hardcoded checklist for beads\n- No execution, just prints what to check\n- Update CONTRIBUTING.md to reference it\n\n### Phase 2: Automated Checks\n- Implement bd preflight --check\n- Run tests, lint, detect stale hashes\n- Clear pass/fail/warn output\n\n### Phase 3: Auto-fix\n- Implement bd preflight --fix\n- Fix vendorHash, version sync\n- Integrate with bd-umbf solution for pollution\n\n### Phase 4: Configuration\n- .beads/preflight.yaml support\n- Make it useful for other projects using beads\n- Plugin/hook system for custom checks\n\n## Dependencies\n\n- bd-umbf: Namespace isolation for beads pollution (blocking for full solution)\n\n## Success Metrics\n\n- Fewer CI failures on first PR push\n- Reduced \"fix nix hash\" commits\n- Contributors report preflight caught issues before CI","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-lfak","is_template":0,"issue_type":"epic","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"bd preflight: PR readiness checks for contributors","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:50Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"0ada8800fada847563b1b5ebd70e381e2b59eaba508e72ec297d496fe6289ab3","created_at":"2025-12-14T04:43:03Z","created_by":"","crystallizes":0,"defer_until":null,"description":"The main CLI package (cmd/bd) has only 26.2% test coverage. CLI commands should have at least 50% coverage to ensure reliability.\n\nKey areas with low/no coverage:\n- daemon_autostart.go (multiple 0% functions)\n- compact.go (several 0% functions)\n- Various command handlers\n\nCurrent coverage: 26.2%\nTarget coverage: 50%","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-llfl","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Improve test coverage for cmd/bd CLI (26.2% ‚Üí 50%)","updated_at":"2026-02-27T02:56:50Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"95dfa21ffb90034e108c4e46531f4fab0c76dbb229d017f152ad17e9f995bd10","created_at":"2025-12-14T22:25:17Z","created_by":"","crystallizes":0,"defer_until":null,"description":"PR #551 now persists close_reason to the database, but there's a question about whether this field should be exported to JSONL format.\n\n## Current State\n- close_reason is stored in issues.close_reason column\n- close_reason is also stored in events table (audit trail)\n- The JSONL export format may or may not include close_reason\n\n## Questions\n1. Should close_reason be exported to JSONL format?\n2. If yes, where should it go (root level or nested in events)?\n3. Should there be any special handling to avoid duplication?\n4. How should close_reason be handled during JSONL import?\n\n## Why This Matters\n- JSONL is the git-friendly sync format\n- Other beads instances import from JSONL\n- close_reason is meaningful data that should be preserved across clones\n\n## Suggested Action\n- Check if close_reason is currently exported in JSONL\n- If not, add it to the export schema\n- Document the field in JSONL format spec\n- Add tests for round-trip (export -\u003e import -\u003e verify close_reason)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-lxzx","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Add close_reason to JSONL export format documentation","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:50Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"d9c70ada89c3542d7ed0c0c7bc42c5265b51f24348754883cb20157df8bf6ddd","created_at":"2025-12-14T04:43:10Z","created_by":"","crystallizes":0,"defer_until":null,"description":"The RPC package has only 47.5% test coverage. RPC is the communication layer for daemon operations.\n\nCurrent coverage: 47.5%\nTarget coverage: 60%","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-m8ro","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Improve test coverage for internal/rpc (47.5% ‚Üí 60%)","updated_at":"2026-02-27T02:56:50Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"49e0c1971231faf525871f779d9b2d38831f4684978c4c43224d4a95fc0daa5c","created_at":"2025-12-07T10:03:44Z","created_by":"","crystallizes":0,"defer_until":null,"description":"In autoimport.go:170-172, YAML parsing errors are silently ignored. If a user has malformed YAML in config.yaml, sync-branch will just silently be empty with no feedback.\n\nRecommendation: Add debug logging since this function is only called during auto-import, and debugging silent failures is painful.\n\nAdd: debug.Logf(\"Warning: failed to parse config.yaml: %v\", err)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-mql4","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":4,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"getLocalSyncBranch silently ignores YAML parse errors","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Test/pollution artifacts ‚Äî not real issues","closed_at":"2026-02-27T22:50:43Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"d66e5030bed4779a5b1abf9749edef75147a4ec302d446f483a93f7616699cd6","created_at":"2026-02-27T08:18:41Z","created_by":"","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-mu1","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"list","updated_at":"2026-02-27T22:50:43Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:50Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"f1bfeda80287ee428a8f01f61bfea7085ef483feb5cf6854f06af716edd5cffd","created_at":"2025-12-14T04:43:01Z","created_by":"","crystallizes":0,"defer_until":null,"description":"The daemon package has only 27.3% test coverage. The daemon is critical for background operations and reliability.\n\nKey areas needing tests:\n- Daemon autostart logic\n- Socket handling\n- PID file management\n- Health checks\n\nCurrent coverage: 27.3%\nTarget coverage: 60%","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-n386","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Improve test coverage for internal/daemon (27.3% ‚Üí 60%)","updated_at":"2026-02-27T02:56:50Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"37b4f802b391d44578c04a7b1f6a616428126f22826153627582cc0a6b4b5907","created_at":"2025-12-05T22:25:25Z","created_by":"","crystallizes":0,"defer_until":null,"description":"\u003e bd sync --no-daemon\n‚Üí Exporting pending changes to JSONL...\n‚Üí Committing changes to sync branch 'beads-sync'...\nError committing to sync branch: failed to create worktree: failed to create worktree parent directory: mkdir /var/home/matt/dev/beads/fix-ci/.git: not a directory","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-n3v","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"**Problem Diagnosed**: The `bd sync` command was failing with \"mkdir /var/home/matt/dev/beads/fix-ci/.git: not a directory\" because it was being executed from the wrong directory.\n\n**Root Cause**: The command was run from `/var/home/matt/dev/beads` (where the `fix-ci` worktree exists) instead of the main repository directory `/var/home/matt/dev/beads/main`. Since `fix-ci` is a git worktree with a `.git` file (not directory), the worktree creation logic failed when trying to create `\u003ccurrent_dir\u003e/.git/beads-worktrees/\u003cbranch\u003e`.\n\n**Solution Verified**: Execute `bd sync` from the main repository directory:\n```bash\ncd main \u0026\u0026 bd sync --dry-run\n```\n","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Error committing to sync branch: failed to create worktree","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"6bb122b3f286326087b8d0785a68c7c6ab9393d441e5b182fc82a340d82e781b","created_at":"2025-11-21T01:16:35Z","created_by":"","crystallizes":0,"defer_until":null,"description":"## Problem\n\nWhen ensureDatabaseFresh() calls CheckStaleness() and it errors (corrupted metadata, permission issues, etc.), we silently proceed with potentially stale data.\n\n**Location:** cmd/bd/staleness.go:27-32\n\n**Scenarios:**\n- Corrupted metadata table\n- Database locked by another process  \n- Permission issues reading JSONL file\n- Invalid last_import_time format in DB\n\n## Current Code\n\n```go\nisStale, err := autoimport.CheckStaleness(ctx, store, dbPath)\nif err \\!= nil {\n    // If we can't determine staleness, allow operation to proceed\n    // (better to show potentially stale data than block user)\n    return nil\n}\n```\n\n## Fix\n\n```go\nisStale, err := autoimport.CheckStaleness(ctx, store, dbPath)\nif err \\!= nil {\n    fmt.Fprintf(os.Stderr, \"Warning: Could not verify database freshness: %v\\n\", err)\n    fmt.Fprintf(os.Stderr, \"Proceeding anyway. Data may be stale.\\n\\n\")\n    return nil\n}\n```\n\n## Impact\nMedium - users should know when staleness check fails\n\n## Effort\nEasy - 5 minutes","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-n4td","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Add warning when staleness check errors","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"ed03a493731b616fbd4b029943989ef48864c6072c042fbed042207b67f9fef5","created_at":"2025-12-06T00:36:52Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Per the design document bd-zvg Open Question 1: Should resurrection log a warning? Recommendation was Yes. Currently, when an expired tombstone loses to a live issue (resurrection), there is no logging or debugging output. This makes it hard to understand why an issue reappeared. Recommendation: Add optional debug logging when resurrection occurs, e.g., Issue bd-abc resurrected (tombstone expired). Files: internal/merge/merge.go:359-366, 371-378, 400-405, 410-415","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-nl2","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":4,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"No logging/debugging for tombstone resurrection events","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/obsidian","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-27T23:01:21Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"0088a719027b80227099f019daa47c4e35e6cbb142f9e83bcd03c81abf5549fd","created_at":"2026-02-27T22:49:35Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"GetNewlyUnblockedByClose (dependencies.go:809) has nested subquery with 2-table JOIN + correlated NOT EXISTS. Most dangerous remaining query pattern that could crash/hang Dolt. Rewrite to avoid nested JOIN. Also review cycle detection CTE (dependencies.go:52). See hq-g4nxe for full audit.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-o23","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Analysis complete:\n\n1. GetNewlyUnblockedByClose (line 822): REWRITTEN. Decomposed nested JOIN + correlated NOT EXISTS into two sequential queries:\n   - Query 1: Find candidate issues blocked by the closed issue (simple JOIN)\n   - Query 2: Check which candidates still have other open blockers (simple JOIN with IN clause)\n   - Go-side filtering removes still-blocked candidates\n   Both existing tests pass.\n\n2. Cycle detection CTE (line 52): REVIEWED, safe. Simple recursive CTE with:\n   - Depth limit of 100 (prevents runaway recursion)\n   - Single table JOIN per recursion (dependencies only)\n   - No nested JOINs or correlated subqueries\n   - Runs within a transaction\n   This is a standard graph-reachability pattern that Dolt handles well.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"SQL audit: rewrite GetNewlyUnblockedByClose nested JOIN subquery","updated_at":"2026-02-27T23:01:21Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"fe473a9181d5ab120925de2fa921fcaa578f044db1bd60a69ffb5d7cdde122e7","created_at":"2026-02-28T02:48:51Z","created_by":"beads/polecats/obsidian","crystallizes":0,"defer_until":null,"description":"ephemeral_routing.go:15 uses strings.Contains(id, '-wisp-') for routing decisions. Breaks for explicit-ID ephemerals (GH#2053). Workarounds exist (isActiveWisp, partitionByWispStatus, batchWispExists) but the fundamental pattern of routing by ID substring creates a fragile dual-path that every new storage method must remember to handle. Consider a column-based approach (check ephemeral flag in DB) as the canonical routing.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-o4c","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"IsEphemeralID routes by ID substring '-wisp-' - fragile convention","updated_at":"2026-02-28T02:48:51Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"0dfb49c64e1e4e4733811055e1d32b5dea2fe6975621fc0373632db3589f86c3","created_at":"2025-11-21T01:17:28Z","created_by":"","crystallizes":0,"defer_until":null,"description":"## Problem\n\nCheckStaleness returns 'false' (not stale) for multiple error conditions instead of returning errors. This masks problems.\n\n**Location:** internal/autoimport/autoimport.go:253-285\n\n## Edge Cases That Return False\n\n1. **Invalid last_import_time format** (line 259-262)\n2. **No JSONL file found** (line 267-277)  \n3. **JSONL stat fails** (line 279-282)\n\n## Fix\n\nReturn errors for abnormal conditions:\n\n```go\nlastImportTime, err := time.Parse(time.RFC3339, lastImportStr)\nif err != nil {\n    return false, fmt.Errorf(\"corrupted last_import_time: %w\", err)\n}\n\nif jsonlPath == \"\" {\n    return false, fmt.Errorf(\"no JSONL file found\")\n}\n\nstat, err := os.Stat(jsonlPath)\nif err != nil {\n    return false, fmt.Errorf(\"cannot stat JSONL: %w\", err)\n}\n```\n\n## Impact\nMedium - edge cases are rare but should be handled\n\n## Effort  \n30 minutes - requires updating callers in RPC server","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-o4qy","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Improve CheckStaleness error handling","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"4a2588a677881aa18fd6d7534a17c9c44f569c073a1e9e4befcc704fada0465d","created_at":"2025-11-12T07:30:06Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Add checks to `bd doctor` that verify Claude Code integration is properly set up when .claude/ directory or Claude environment is detected.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-o78","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Enhance `bd doctor` to verify Claude Code integration","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"SQLite/Kaspersky ‚Äî not relevant to Dolt-only architecture","closed_at":"2026-02-27T23:53:18Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"67a4b477ab191271be62eecf2ad9f875935123206011570334716c7ec5a16fb8","created_at":"2025-11-16T22:51:31Z","created_by":"","crystallizes":0,"defer_until":null,"description":"BEGIN IMMEDIATE fails immediately on SQLITE_BUSY instead of retrying with exponential backoff.\n\nLocation: internal/storage/sqlite/sqlite.go:223-225\n\nProblem:\n- Under concurrent write load, BEGIN IMMEDIATE can fail with SQLITE_BUSY\n- Current implementation fails immediately instead of retrying\n- Results in spurious failures under normal concurrent usage\n\nSolution: Implement exponential backoff retry:\n- Retry up to N times (e.g., 5)\n- Backoff: 10ms, 20ms, 40ms, 80ms, 160ms\n- Check for context cancellation between retries\n- Only retry on SQLITE_BUSY/database locked errors\n\nImpact: Spurious failures under concurrent write load\n\nEffort: 3 hours","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-ola6","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Implement transaction retry logic for SQLITE_BUSY","updated_at":"2026-02-27T23:53:18Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/quartz","await_id":"","await_type":"","close_reason":"Completed with no code changes (already fixed or pushed directly to main)","closed_at":"2026-02-27T05:51:17Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"6b39bb407dfd16bf024c147462c1444640ea9ae473bcfc8d4c118eee45d09a93","created_at":"2026-02-27T05:48:35Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"Review commit 49aed46c in beads repo. Check: migration safety guards, old-schema compatibility, doctor recovery logic, error handling.","design":"## Code Review: SQLite-to-Dolt Migration Safety (49aed46c)\n\n### Summary\nWell-structured, safety-first migration PR. 18 files, ~3200 lines added, 117+ tests. The four review areas are analyzed below.\n\n---\n\n### 1. Migration Safety Guards ‚Äî GOOD with one weakness\n\n**backupSQLite**: Solid. O_EXCL prevents TOCTOU races, 0600 permissions, counter-based collision handling up to 100 retries.\n\n**verifyServerTarget**: WEAK CHECK. Despite the name, it cannot actually prevent writing to the wrong project's Dolt server. It only catches: (a) non-MySQL services on the port, (b) unreachable servers with non-ECONNREFUSED errors. If another project's Dolt server is on the same port, this check passes ‚Äî database doesn't exist yet = 'safe'. The function always returns nil for the normal first-migration case. Recommend: at minimum, add a comment acknowledging this limitation. Better: check for unexpected databases that indicate a different project's server.\n\n**verifyMigrationCounts**: Correct. Uses \u003e= semantics for idempotent re-runs.\n\n**finalizeMigration**: Good overall. Comment says 'atomic metadata update' but it's not truly atomic ‚Äî crash between cfg.Save() and os.Rename() leaves metadata pointing to dolt while beads.db still exists. MITIGATED: doctor CheckBrokenMigrationState detects and fixes this exact scenario. Recommend: update comment to say 'near-atomic' and reference the doctor fix.\n\n**rollbackMetadata**: Simple and correct.\n\n---\n\n### 2. Old-Schema Compatibility ‚Äî GOOD\n\nBoth CGO (migrate_dolt.go) and shim (migrate_shim.go) extract paths updated consistently with identical column lists using the DRY opt() helper.\n\nGood: created_by and owner changed from direct scan to sql.NullString scan for old schemas where these columns may not exist.\n\nMinor issue: migrate_dolt.go comment says 'Core columns (id, title, status, priority, created_at, updated_at) are assumed present in all versions' but then uses opt('title', '\"\"') ‚Äî making title optional contradicts the comment. Comment should be corrected or removed.\n\nTested against 12 real-world databases spanning multiple schema versions ‚Äî strong validation.\n\n---\n\n### 3. Doctor Recovery Logic ‚Äî GOOD\n\n**CheckBrokenMigrationState**: Properly aware of server mode (no false positive when dolt/ dir absent). Checks both beads.db and beads.db.migrated as recovery sources. Distinguishes recoverable vs unrecoverable states.\n\n**CheckSQLiteResidue**: Guards against renaming active SQLite database (checks backend first). Handles zero-byte files correctly.\n\n**CheckEmbeddedModeConcurrency**: Checks dolt-access.lock and noms LOCK files. Appropriately uses warnings not errors.\n\n**fix/BrokenMigrationState**: Re-verifies conditions before applying (defense in depth). Handles .migrated file recovery. Sets database='beads.db' correctly for SQLite backend.\n\n**fix/SQLiteResidue**: Guards against overwriting existing .migrated file. Backend guard prevents accidental rename on SQLite backend.\n\n---\n\n### 4. Error Handling ‚Äî GOOD\n\nEvery failure point in migrate_auto.go and migrate_shim.go includes the backup path in error messages ‚Äî users always know where their data is.\n\nRollback on verification failure properly removes dolt dir + restores metadata. Import failure cleanup removes the dolt directory that was just created.\n\nmain.go SQLite backend guard provides clear error message with migration instructions and BEADS_BACKEND override as escape hatch.\n\nconfigfile.go GetBackend priority chain (env \u003e config \u003e default) is correct with case-insensitive normalization and unrecognized-value warnings.\n\nMinor: migrate_auto.go has redundant doltPath assignment (computed twice to same value). Harmless.\n\nMinor: shim path uses cfg.GetDoltServerPort() directly while auto path uses doltserver.DefaultConfig(). These could diverge if GetDoltServerPort() returns 0, but verifyServerTarget handles port==0 by returning nil, so safe.\n\n---\n\n### Issues Found (non-blocking)\n\n1. **verifyServerTarget is weak** ‚Äî cannot detect wrong-project Dolt servers (design limitation, mitigated by manual inspection)\n2. **Comment/code mismatch** in migrate_dolt.go re 'core columns assumed present' vs all columns using opt()\n3. **Redundant doltPath assignment** in migrate_auto.go (harmless)\n4. **'Atomic' finalization isn't truly atomic** ‚Äî mitigated by doctor fix\n\n### Verdict: APPROVE with minor suggestions\nNo blocking issues. The safety model (backup-first, verify-then-finalize, doctor-recoverable) is sound. Test coverage is comprehensive at 117+ tests across unit and integration.","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-on8","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"Code review complete. Reviewed all 18 files in commit 49aed46c. Verdict: APPROVE with minor suggestions. Four non-blocking issues found (verifyServerTarget weakness, comment/code mismatch, redundant assignment, non-atomic finalization). The safety model is sound: backup-first, verify-then-finalize, doctor-recoverable. 117+ tests provide comprehensive coverage.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Code review: SQLite-to-Dolt migration safety (49aed46c)","updated_at":"2026-02-27T05:52:09Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"5c9613daafbe3ec00c615a1aa72e72df8dccf101ad744ba5e1b5468ab89bda3e","created_at":"2025-12-17T02:17:26Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Code health review found 30+ instances of error suppression using blank identifier without explanation:\n\nGood examples (with comments):\n- merge.go: _ = gitRmCmd.Run() // Ignore errors\n- daemon_watcher.go: _ = watcher.Add(...) // Ignore error\n\nBad examples (no context):\n- create.go:213: dbPrefix, _ = store.GetConfig(ctx, \"issue_prefix\")\n- daemon_sync_branch.go: _ = daemonClient.Close()\n- migrate_hash_ids.go, version_tracking.go: _ = store.Close()\n\nFix: Add comments explaining WHY errors are ignored, or handle them properly.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-ork0","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Add comments to 30+ silently ignored errors or fix them","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:50Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"39560fd5d355a12b11e90f6ebc446e882c34523998b048e2e9d87fa9a899b503","created_at":"2025-12-14T22:24:14Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Comprehensive code review of the merged context engineering PR (PR #481) that reduces MCP context usage by 80-90%.\n\n## Summary\nThe PR successfully implements lazy tool schema loading and minimal issue models to reduce context window usage. Overall implementation is solid and well-tested.\n\n## Positive Findings\n‚úÖ Well-designed models (IssueMinimal, CompactedResult)\n‚úÖ Comprehensive test coverage (28 tests, all passing)\n‚úÖ Clear documentation and comments\n‚úÖ Backward compatibility preserved (show() still returns full Issue)\n‚úÖ Sensible defaults (COMPACTION_THRESHOLD=20, PREVIEW_COUNT=5)\n‚úÖ Tool catalog complete with all 15 tools documented\n\n## Issues Identified\nSee linked issues for specific followup tasks.\n\n## Context Engineering Architecture\n- discover_tools(): List tool names only (~500 bytes vs ~15KB)\n- get_tool_info(name): Get specific tool details on-demand\n- IssueMinimal: Lightweight model for list views (~80 bytes vs ~400 bytes)\n- CompactedResult: Auto-compacts results with \u003e20 issues\n- _to_minimal(): Conversion function (efficient, no N+1 issues)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-otf4","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Code Review: PR #481 - Context Engineering Optimizations","updated_at":"2026-02-27T02:56:50Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"02fdb116f47034be17782207381fd891ae9c7bd6727288ecb6cb8bd57541cc4f","created_at":"2025-12-14T22:24:56Z","created_by":"","crystallizes":0,"defer_until":null,"description":"PR #481 changed the return types of `ready()` and `list()` from `list[Issue]` to `list[IssueMinimal] | CompactedResult`. This is a breaking change for MCP clients.\n\n## Impact Assessment\nBreaking change affects:\n- Any MCP client expecting `list[Issue]` from ready()\n- Any MCP client expecting `list[Issue]` from list()\n- Client code that accesses full Issue fields (description, design, acceptance_criteria, timestamps, dependencies, dependents)\n\n## Current Behavior\n- ready() returns `list[IssueMinimal] | CompactedResult`\n- list() returns `list[IssueMinimal] | CompactedResult`\n- show() still returns full `Issue` (good)\n\n## Considerations\n**Pros of current approach:**\n- Forces clients to use show() for full details (good for context efficiency)\n- Simple mental model (always use show for full data)\n- Documentation warns about this\n\n**Cons:**\n- Clients expecting list[Issue] will break\n- No graceful degradation option\n- No migration period\n\n## Potential Solutions\n1. Add optional parameter `full_details=false` to ready/list (would increase payload)\n2. Create separate tools: ready_minimal/list_minimal + ready_full/list_full\n3. Accept breaking change and document upgrade path (current approach)\n4. Version the MCP server and document migration guide\n\n## Recommendation\nCurrent approach (solution 3) is reasonable if:\n- Changelog clearly documents the breaking change\n- Migration guide provided to clients\n- Error handling is graceful for clients expecting specific fields","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-pdr2","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Consider backwards compatibility for ready() and list() return type change","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/crew/emma","await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"bca6bd3e614c03ee7651ef45d0c3f0d33009001875f785956c25bc075757d1f3","created_at":"2026-02-27T00:02:09Z","created_by":"beads/crew/emma","crystallizes":0,"defer_until":null,"description":"PR Sheriff standing orders for beads repo (emma). References hq-pr-sheriff for canonical workflow. Full doc: gt/docs/pr-sheriff.md","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-pr-sheriff","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":1,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"PR Sheriff (reference to hq-pr-sheriff)","updated_at":"2026-02-28T21:47:58Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"bd15241e55dce6d50bdbb4a0a71feb4877cd203c3b49eb2bb30a32171db4f018","created_at":"2025-12-17T02:17:19Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Code health review found inconsistent error handling patterns:\n\nPattern A (preferred): FatalError() from errors.go:21-24\nPattern B (inconsistent): Direct fmt.Fprintf(os.Stderr) + os.Exit(1)\n\nAffected files:\n- delete.go:35-49 uses direct pattern\n- create.go:213 ignores error silently\n- Various other commands\n\nFix: Standardize on FatalError() wrapper for consistent error messages and testability.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-qioh","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Standardize error handling: replace direct fmt.Fprintf+os.Exit with FatalError","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/obsidian","await_id":"","await_type":"","close_reason":"","closed_at":"2026-03-01T00:33:52Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"273211cc989025c8b08e56292fc15f68f4891000f7da961cf0d5a91d70890783","created_at":"2026-02-28T23:15:00Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"attached_molecule: bd-wisp-j1rvzn\nattached_formula: mol-polecat-work\nattached_at: 2026-03-01T00:17:34Z\ndispatched_by: mayor\n\nIn the HQ .beads/backup/ directory, events.jsonl has timestamp Feb 27 19:40 while all other JSONL files (issues, dependencies, labels, comments, config) are from Feb 28 14:59. The events export appears to be failing silently or the events table isn't being included in incremental exports. This is a data integrity gap ‚Äî events are part of the recovery layer. Fix: check bd export logic for events table, ensure events.jsonl is updated alongside other files during backup ticker runs.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-qnd","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Fixed: events.jsonl was stale because exportEventsIncremental returned early (no-op) when no new events existed since LastEventID high-water mark, while other tables got full re-exports. Switched events to same full-export pattern as all other tables. Also fixed state.Counts.Events using += instead of =.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"HQ events.jsonl export is stale (Feb 27) while other JSONL files are current","updated_at":"2026-03-01T00:33:52Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Blocked on Jason response, will refile when ready","closed_at":"2026-02-28T18:32:43Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"a5d6aeece97bea239c94c8dee638c9fb9b1aab792cad72eb3542afffdcad9a9d","created_at":"2026-02-28T18:32:05Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"Tim Sehn (2026-02-28) confirmed interactive rebase works on a running server but deferred to Jason (who wrote DOLT_REBASE) for the exact procedure.\n\nGoal: squash commits older than N days while keeping recent commits intact. This is the opposite of the simple flatten (which squashes everything).\n\nTim's correction: the simple DOLT_RESET --soft procedure squashes the LAST N hours (wrong direction). Interactive rebase is needed to squash everything EXCEPT recent commits.\n\nReference: https://www.dolthub.com/blog/2024-01-03-announcing-dolt-rebase/\n\nBLOCKED: waiting for Jason's response with exact commands. File will be updated when received.\n\nKey constraint: always rebase on a side branch, never directly on main (hashes change).","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-qpu","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Implement Jason's interactive rebase for surgical compaction","updated_at":"2026-02-28T18:32:43Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/topaz","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-28T00:37:05Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"7ef3d2ab7b96c836f0c02d8d1f83f4fd8853a8460b77454476ad20ce63e8a47c","created_at":"2026-02-27T23:11:08Z","created_by":"beads/refinery","crystallizes":0,"defer_until":null,"description":"3 test failures on main: TestInitRedirect/RedirectCreatesDBInTarget (init_test.go:962), TestInitBEADS_DIR/InitCreatesDBAtBeadsDir (init_test.go:1174), TestInitBEADS_DIR/WithoutBeadsDirNoBehaviorChange (init_test.go:1213). All report 'Expected prefix X, got empty string'.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-qy0","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Root cause: init.go line 293 sets dbName=prefix (hyphens) but line 444 writes DoltDatabase with underscores to metadata.json. Database created as e.g. redirect-test but metadata says redirect_test. openExistingTestDB reads metadata.json ‚Üí opens wrong database.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Pre-existing: TestInitRedirect and TestInitBEADS_DIR failures","updated_at":"2026-02-28T00:41:40Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"898b339eb4f8ca7a67a1d2cf0893ac2ac8f02e1cc8be8f364cc35ad287e05a65","created_at":"2025-11-21T23:55:11Z","created_by":"","crystallizes":0,"defer_until":null,"description":"The reopen.go command has a TODO at line 61 to add reason as a comment once RPC supports AddComment. Currently --reason flag is ignored in daemon mode with a warning.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-r46","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Support --reason flag in daemon mode for reopen command","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"gastown/witness","await_id":"","await_type":"","close_reason":"Test pollution / noise ‚Äî backlog cleanup","closed_at":"2026-02-27T23:52:58Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"81c84275d9d669d9c50be8b1d830949ae5fa70f9f726517d7dba18ed53a9340b","created_at":"2026-02-27T23:05:51Z","created_by":"gastown/polecats/rictus","crystallizes":0,"defer_until":null,"description":"Exit: COMPLETED\nIssue: gt-r8m9\nBranch: polecat/rictus/gt-r8m9@mm5hkoyf","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-r8c","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"WORK_DONE: gt-r8m9","updated_at":"2026-02-27T23:52:58Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"286b34d5349b879c8a5559e69401de7828942f1815dc09ac357692587d0ff7d2","created_at":"2025-12-17T02:17:24Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Code health review found queries.go is too large at 1586 lines with:\n\n- Issue scanning logic duplicated between transaction.go and queries.go\n- Timestamp defensive fixes duplicated in CreateIssue, CreateIssues, batch_ops.go\n- Multiple similar patterns that should be consolidated\n\nAlso: transaction.go at 1284 lines, dependencies.go at 893 lines\n\nRecommendation:\n1. Extract common scanning into shared function\n2. Consolidate timestamp defensive fixes\n3. Split queries.go by domain (CRUD, search, batch, events)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-rgyd","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Split internal/storage/sqlite/queries.go (1586 lines)","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"f8db5f062e3f1e1d3f2b0ad43dccdda7be29f07d8bd34c93760c720caad88c51","created_at":"2025-12-16T09:13:57Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Fixed: ExtractIssuePrefix was falling back to first-hyphen for word-like suffixes, breaking multi-hyphen prefixes like 'hacker-news' and 'me-py-toolkit'.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-s0qf","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"GH#405: Fix prefix parsing with hyphens - multi-hyphen prefixes parsed incorrectly","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"17040d99259d53063e987d8d75a19e38ca5e52fffcf7d5f18a759f0bcc59b6f6","created_at":"2025-12-08T13:46:38Z","created_by":"","crystallizes":0,"defer_until":null,"description":"so many time I create an issue and then have another thought: 'oh, before I did X and it crashed there was ZZZ happening' or 'actually that is P4 not P2'. It would be nice if when `bd {cmd}` is used without a {title} or {id} it just adds or updates the most recently touched issue.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-s2t","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":3,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"wish: a 'continue' or similar cmd/flag which means alter last issue","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:50Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"46af30d4f6ad4dfc966e197481c9febfcf68d2f66ce426682d1529a349f01557","created_at":"2025-12-14T04:43:04Z","created_by":"","crystallizes":0,"defer_until":null,"description":"The setup package has only 28.4% test coverage. Setup commands are critical for first-time user experience.\n\nCurrent coverage: 28.4%\nTarget coverage: 50%","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-sh4c","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Improve test coverage for cmd/bd/setup (28.4% ‚Üí 50%)","updated_at":"2026-02-27T02:56:50Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Old handoff, superseded by current patrol","closed_at":"2026-02-27T05:34:17Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"4157eb984ba47ea7e71c0d94ea0403e096adb4c9f895d9b846a35f38aa933be9","created_at":"2026-02-27T05:10:51Z","created_by":"beads/witness","crystallizes":0,"defer_until":null,"description":"Completed 4 patrols, all idle. No polecats, no swarms, no cleanup wisps. Refinery alive. Deacon alive. Inbox clean. NOTE: gt commands being SIGKILL'd (53 Claude procs, ~446MB free RAM on 48GB). System memory-constrained. bd commands work fine.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-t3r","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"ü§ù HANDOFF: Witness patrol","updated_at":"2026-02-27T05:34:17Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"SQLite/Kaspersky ‚Äî not relevant to Dolt-only architecture","closed_at":"2026-02-27T23:53:18Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"990e3340a541b27f87005da1b05602a252610aafb7c6386a778462a0cbb5d05c","created_at":"2025-11-20T23:56:12Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Kaspersky Antivirus falsely detects beads (bd.exe v0.23.1) as a Trojan (PDM:Trojan.Win32.Generic) and removes it.\nEvent: Malicious object detected\nComponent: System Watcher\nObject name: bd.exe\n","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-t4u1","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"False positive detection by Kaspersky Antivirus (Trojan)","updated_at":"2026-02-27T23:53:18Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Duplicates","closed_at":"2026-02-27T23:53:08Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"eb23cac56496bb31c706743c05132b4fb9a8e6d56f5c1562385e729503e68c42","created_at":"2026-02-27T23:01:01Z","created_by":"beads/refinery","crystallizes":0,"defer_until":null,"description":"go vet reports: address format \"%s:%d\" does not work with IPv6 (passed to net.Dial at L103) in cmd/bd/migrate_safety.go:100. Pre-existing issue found during merge queue processing of bd-o23.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-t5f","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"go vet: IPv6 address format in migrate_safety.go:100","updated_at":"2026-02-27T23:53:08Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-27T05:14:43Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"4aafc7a4625a7adc3979c1bc2a9d4cb2825caeba3d3603193cbafd250e046514","created_at":"2025-11-22T07:16:00Z","created_by":"","crystallizes":0,"defer_until":null,"description":"bd init leaves users with incomplete setup, requiring manual bd doctor --fix. Issues found: (1) git hooks not installed if user declines prompt, (2) no auto-migration when CLI is upgraded, (3) stale merge driver configs from old versions. Fix by making bd init more robust with better defaults and auto-migration.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-tbz3","is_template":0,"issue_type":"epic","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"bd init UX Improvements","updated_at":"2026-02-27T05:14:43Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/jasper","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-28T03:06:21Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"4ec2ac432b5dc3c1e84ac0c9c46540cee002a86abb7cf7b6c265d193c034e80f","created_at":"2026-02-28T02:48:31Z","created_by":"beads/polecats/obsidian","crystallizes":0,"defer_until":null,"description":"store.go:445 applyConfigDefaults, bootstrap.go:43 and :100, configfile.go:47 all default to 'beads'. Should centralize into a single constant or derive from config resolution. Currently scattered defaults make it easy for different code paths to disagree on the database name.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-tcn","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"Replaced 3 hardcoded \"beads\" database name defaults (store.go:445, bootstrap.go:43, bootstrap.go:100) with configfile.DefaultDoltDatabase constant. Also updated comments referencing the default. The configfile.DefaultDoltDatabase constant already existed ‚Äî the storage/dolt package just wasn't using it.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Hardcoded database name 'beads' in 4 storage locations","updated_at":"2026-02-28T03:08:32Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:52Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"afc5bfa977b1054d01cc13f900722a3109721d499d75f8071be4f120dbe68ce8","created_at":"2025-12-17T02:18:58Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Epic grouping technical debt identified in the Dec 16, 2025 code health review.\n\n## Overall Health Grade: B (Solid foundation, needs cleanup)\n\n### P1 (High Priority):\n- bd-74w1: Consolidate duplicate path-finding utilities\n- bd-b6xo: Remove/fix ClearDirtyIssues() race condition\n- bd-b3og: Fix TestImportBugIntegration deadlock\n\n### P2 (Medium Priority):\n- bd-05a8: Split large files (doctor.go, sync.go)\n- bd-qioh: Standardize error handling patterns\n- bd-rgyd: Split queries.go (1586 lines)\n- bd-9g1z: Fix/remove TestFindJSONLPathDefault\n\n### P3 (Low Priority):\n- bd-ork0: Add comments to 30+ ignored errors\n- bd-4nqq: Remove dead test code in info_test.go\n- bd-dhza: Reduce global state in main.go\n\n## Key Areas:\n1. Code duplication in path utilities\n2. Large monolithic files (5 files \u003e1000 lines)\n3. Global state (25+ variables, 3 deprecated)\n4. Silent error suppression (30+ instances)\n5. Test gaps and dead test code\n6. Atomicity risks in batch operations","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-tggf","is_template":0,"issue_type":"epic","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Code Health Review Dec 2025: Technical Debt Cleanup","updated_at":"2026-02-27T02:56:52Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/quartz","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-28T01:10:09Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"ada85227a58f1d835b5ade925fb3cb980ff21e8b2fe8b048c3a1673d1130194e","created_at":"2026-02-26T01:48:10Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"Tim Sehn confirmed branch isolation scales to 1000s of concurrent branches. testdoltbranch.go already implements StartTestBranch() with per-test branch creation. Remaining work: (1) Ensure all test packages use branch isolation instead of CREATE DATABASE, (2) Incorporate Tim's dolt reset --hard trick for reusable test branches ‚Äî seed data on a branch, run writes, reset back to seeded state instead of recreating. (3) Clean up any remaining per-package server spawning. (4) Consider testcontainers-dolt module (Dustin's suggestion) for CI. Reference: Tim's email 2024-02-24, dolthub blog post on enginetest perf.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-tk8y","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implemented: (1) Added ResetTestBranch() to testutil/testdoltbranch.go for dolt reset --hard reusable branches. (2) Migrated migrations_test.go to shared server + branch-per-test isolation via new TestMain with issues table committed to main. Eliminated 8 per-test server spawns. (3) Migrated dolt_phantom_test.go to shared doctor TestMain server with cleanupPhantomDB helper. Eliminated 5 per-test server spawns. All 14 tests pass. Resolved merge conflicts with parallel agent work (combined best of both approaches).","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"P2: Complete branch-per-test migration with dolt reset --hard","updated_at":"2026-02-28T01:10:09Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/jasper","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-28T00:23:03Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"abd6c3e56e5b1f8f3fb1aa706d93e2680d20432dd9bcd50ff2824fe3e158bec9","created_at":"2025-12-15T00:51:25Z","created_by":"","crystallizes":0,"defer_until":null,"description":"During swarm operations, polecats frequently get stuck waiting for interactive prompts from shell commands like:\n- cp prompting 'overwrite file? (y/n)'\n- mv prompting 'overwrite file? (y/n)'  \n- rm prompting 'remove file?'\n\nThis happens because macOS aliases or shell configs may have -i flags set by default.\n\nRoot cause: Claude Code runs commands that trigger interactive confirmation prompts, but cannot respond to them, causing the agent to hang indefinitely.\n\nObserved in: Multiple polecats during GH issues swarm (Dec 2024)\n- Derrick, Roustabout, Prospector, Warboy all got stuck on y/n prompts\n\nSuggested fixes:\n1. AGENTS.md should instruct agents to always use -f flag with cp/mv/rm\n2. Polecat startup could set shell aliases to use non-interactive versions\n3. bd prime hook could include guidance about non-interactive commands\n4. Consider detecting stuck prompts and auto-recovering","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-tm2p","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implemented: PreToolUse hook (.claude/hooks/block-interactive-cmds.sh) that blocks cp/mv/rm without -f flag, preventing interactive prompt hangs from macOS -i aliases. Also registered hook in settings.json and added non-interactive guidance to default agents.md template.","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Polecats get stuck on interactive shell prompts (cp/mv/rm -i)","updated_at":"2026-02-28T00:23:38Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Test artifact cleanup (Clown Show #21)","closed_at":"2026-02-27T02:53:45Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"28bfa2f66a790ba766bde58b6527d07a840b7099b6914d37f325f3b6e122e19f","created_at":"2025-12-17T02:33:40Z","created_by":"","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-toy3","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Test hook","updated_at":"2026-02-27T02:53:45Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"mayor/","await_id":"","await_type":"","close_reason":"Stale alert from 2026-02-28 04:47. Dolt server running, latency elevated but functional.","closed_at":"2026-03-01T00:08:20Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"9e966269a477a83d12ecdfa11cd77c6aeb6b960702a36496e8c313fb00029d41","created_at":"2026-02-28T04:47:23Z","created_by":"overseer","crystallizes":0,"defer_until":null,"description":"Escalation ID: bd-wisp-zaqjd\nSeverity: critical\nFrom: overseer\n\n---\nTo acknowledge: gt escalate ack bd-wisp-zaqjd\nTo close: gt escalate close bd-wisp-zaqjd --reason \"resolution\"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-tpv","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":0,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"[CRITICAL] Dolt: Critical latency detected - 744ms (threshold: 200ms) - 1 orphaned database present","updated_at":"2026-03-01T00:08:20Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/obsidian","await_id":"","await_type":"","close_reason":"Shipped ac78ec96: flock-based test server coordination, 3-file split (common/unix/windows)","closed_at":"2026-02-27T21:11:40Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"65eb23303b6468fe20517b5fb8667629c3a209bacb0ceb462e9106845a2ec442","created_at":"2026-02-27T20:37:04Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"45 zombie dolt sql-server processes found on random high ports (13000-14300). Root cause: race condition in beads/mayor/rig/internal/testutil/testdoltserver.go lines 120-157.\n\nFindFreePort() binds to :0, gets OS port, closes listener. Between close and dolt binding, concurrent test grabs that port. serverCmd.Start() succeeds but dolt fails to bind. WaitForServer() hangs 30s, then cleanup kills one process -- but with 4-5 parallel packages x 3 retries x 30s timeouts = 45 zombies in 3 minutes.\n\nCleanup failures: PID file written after Start() (references dead process on race), CleanStaleTestServers() only runs on next invocation, SIGKILL skips defers entirely.\n\nFix: port gastown's lock-based approach from internal/testutil/doltserver_unix.go -- sync.Once + syscall.Flock() for cross-process port coordination. Same pattern exists in multiple crew variants (collins, darcy, emma, etc.) which all have copies of testdoltserver.go.\n\nReference: gastown/mayor/rig/internal/testutil/doltserver_unix.go for the working pattern.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-tx9","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implemented: Ported gastown flock-based approach to beads testdoltserver.go. Split into 3 files: common (testdoltserver.go), unix (testdoltserver_unix.go with syscall.Flock), windows fallback (testdoltserver_windows.go). Uses sync.Once for in-process singleton + LOCK_EX/LOCK_SH for cross-process coordination. Added reapStaleDoltServers to catch zombies from SIGKILL'd processes. API surface unchanged - all callers work without modification. All test packages pass.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Fix test server zombie leak: port allocation race in testdoltserver.go","updated_at":"2026-02-27T21:11:40Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"51f62e45372249464bf3a36d605bc4eddc8e87e58042e724c8965d1e5ceadd29","created_at":"2025-12-14T02:00:30Z","created_by":"","crystallizes":0,"defer_until":null,"description":"## Problem\n\nWhen contributors work on beads-the-project using beads-the-tool, their personal work-tracking issues leak into PRs. The .beads/issues.jsonl is intentionally tracked (it's the project's issue database), but contributors' local issues pollute the diff.\n\nThis is a recursion problem unique to self-hosting projects.\n\n## Possible Solutions to Explore\n\n1. **Contributor namespaces** - Each contributor gets a private prefix (e.g., `bd-steve-xxxx`) that's gitignored or filtered\n2. **Separate database** - Contributors use BEADS_DIR pointing elsewhere for personal tracking\n3. **Issue ownership/visibility flags** - Mark issues as \"local-only\" vs \"project\"\n4. **Prefix-based filtering** - Configure which prefixes are committed vs ignored\n\n## Design Considerations\n\n- Should be zero-friction for contributors (no manual setup)\n- Must not break existing workflows\n- Needs to work with sync/collaboration features\n- Consider: what if a \"personal\" issue graduates to \"project\" issue?\n\n## Expansion Needed\n\nThis is a placeholder. Needs detailed design exploration before implementation.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-umbf","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Design contributor namespace isolation for beads pollution prevention","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/obsidian","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-28T22:46:07Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"79180d8c7c96cf2f1f41b51e6d2050ecb9841e9b239e94edde5803be0129669c","created_at":"2026-02-28T21:50:03Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"bd show only queries the issues table but wisps are stored in the wisps table (via wispIssueTable() routing). When refinery or other agents try to bd show a wisp ID, it returns 'not found'. This blocks refinery patrol hook/report operations. Root cause identified by gastown/refinery. Fix: bd show (and related lookup functions like GetIssue) need to check wispIssueTable() routing ‚Äî if the ID has a wisp pattern, query the wisps table. See beads internal/storage/dolt/wisps.go for the routing logic.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-w2w","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implemented fix: 6 storage functions now route wisp lookups through wisps/wisp_dependencies tables instead of hardcoding issues/dependencies. Key changes in queries.go (GetMoleculeProgress, computeBlockedIDs, GetBlockedIssues, GetEpicsEligibleForClosure), dependencies.go (AddDependency target check), and transaction.go (SearchIssues ephemeral ID routing). All tests pass.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"bd show can't find wisps: only queries issues table, not wisps table","updated_at":"2026-02-28T22:46:07Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Plugin run completed successfully","closed_at":"2026-03-01T05:45:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"9befd3713270c1a3eb3a476ae8093b24eb7c34c99d1c4a445f0b9c72a1b24c9f","created_at":"2026-02-28T17:04:23Z","created_by":"dog","crystallizes":0,"defer_until":null,"description":"Rebuilt gt: 9332de3a ‚Üí 8d20a6a9 (+2 commits)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-x1e","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Plugin run: rebuild-gt","updated_at":"2026-03-01T05:45:51Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/quartz","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-28T04:57:34Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"472275bb0221813e4606bafe6ebf4c33358f882a7e1e0d894d2c8238acff4f58","created_at":"2026-02-28T03:58:49Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"There is no bd export command. Currently exporting issues requires bd list --all --include-infra --include-gates --include-templates --json -n 0 piped through python to convert JSON array to JSONL format. Need a proper bd export --format=jsonl --output=\u003cpath\u003e command that: 1) Exports all records (issues + wisps optionally), 2) Outputs proper JSONL (one JSON object per line), 3) Optionally scrubs test/pollution records, 4) Matches the format of existing .beads/issues.jsonl files.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-xav","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implemented bd export command with -o, --all, --include-infra, --scrub flags. Exports JSONL with labels, dependencies, counts. Includes wisps. 7 tests pass (file, stdout, scrub, round-trip, pollution filter). Registered as read-only command.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"bd export command for JSONL backup","updated_at":"2026-02-28T04:57:34Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/obsidian","await_id":"","await_type":"","close_reason":"Completed with no code changes (already fixed or pushed directly to main)","closed_at":"2026-02-26T23:15:24Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"c805b0db0da32a51ea39818d7b72f42e08cc8a0b2ec56b418d2b3eacb85c7fec","created_at":"2026-02-26T01:04:48Z","created_by":"beads/refinery","crystallizes":0,"defer_until":null,"description":"TestInitDatabaseFlag in cmd/bd/init_test.go references a --database flag that does not exist on bd init. All 6 subtests fail with 'unknown flag: --database'. Confirmed pre-existing on main (not introduced by any polecat branch). The test appears to have been written for a flag that was either never added or was removed.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-xm5l","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"TestInitDatabaseFlag fails: --database flag does not exist on bd init","updated_at":"2026-02-26T23:17:13Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/obsidian","await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"64a6834afb2e56b18fb4d3bd712a25e38c87e0289efba1e3bfd20191c13e9d3f","created_at":"2026-02-28T03:42:10Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"attached_molecule: bd-wisp-uq6fx\nattached_formula: mol-polecat-work\nattached_at: 2026-02-28T03:42:48Z\ndispatched_by: mayor\n\ncmd/bd takes 180 seconds, the slowest package in beads. Likely end-to-end CLI tests that spawn Dolt servers, create databases, and run full bd commands. Investigate: can tests share a single Dolt server? Can they use t.Parallel()? Can heavy integration tests be split to a build tag? Target: under 60s.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-xmf","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Speed up cmd/bd tests (180s ‚Äî dominates test suite)","updated_at":"2026-03-01T05:47:29Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Test/pollution artifacts ‚Äî not real issues","closed_at":"2026-02-27T22:50:43Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"a92c3413be7b645f1f20a61ee8c84ff1337ea2eebaeae71f182709d0aa19cf73","created_at":"2026-02-27T22:32:43Z","created_by":"dog","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-xq2","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Plugin Result: rebuild-gt - Binary is not stale (commit ce7af0ae)","updated_at":"2026-02-27T22:50:43Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Test issue, no content","closed_at":"2026-03-01T05:45:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"60ae23bf92805b480f1a8830747d30e2708afe22803f861299c1005cf9818be5","created_at":"2026-02-26T00:08:56Z","created_by":"","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-xyz99","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"See abc12 for reference","updated_at":"2026-03-01T05:45:51Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"af51e2901d1eb42d2047dc78383ec9cfc7709611cad87cdac93382cc2ceb3616","created_at":"2025-12-05T22:51:18Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Both readFirstIssueFromGit() in init.go and importFromGit() in autoimport.go have similar code patterns for:\n1. Running git show \u003cref\u003e:\u003cpath\u003e\n2. Scanning the output with bufio.Scanner\n3. Parsing JSON lines\n\nCould be refactored to share a helper like:\n- readJSONLFromGit(gitRef, path string) ([]byte, error)\n- Or a streaming version: streamJSONLFromGit(gitRef, path string) (io.Reader, error)\n\nFiles:\n- cmd/bd/autoimport.go:225-256 (importFromGit)\n- cmd/bd/init.go:1212-1243 (readFirstIssueFromGit)\n\nPriority is low since code duplication is minimal and both functions work correctly.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-y2v","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Refactor duplicate JSONL-from-git parsing code","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"d18d628884132cda5f9a2dec5835721bf4ad0e65020491e6e6debd9137cf58bb","created_at":"2025-12-07T23:48:32Z","created_by":"","crystallizes":0,"defer_until":null,"description":"The checkExistingBeadsData function in cmd/bd/init.go checks for .beads in the current working directory, but for worktrees it should check the main repository root instead. This prevents proper worktree compatibility.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-yck","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Fix checkExistingBeadsData to be worktree-aware","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"stale:auto-closed by reaper","closed_at":"2026-02-26T20:45:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"66cba5bc55da124b544da36fadfafeeaa56a959cdd1c645d0d62d73a52db9153","created_at":"2025-11-15T02:17:48Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Implement a --fix flag for bd doctor that can automatically repair detected issues.\n\nRequirements:\n- Add --fix flag to bd doctor command\n- Show all fixable issues and prompt for confirmation before applying fixes\n- Organize fix implementations under doctor/fix/\u003ctype_of_fix\u003e.go\n- Each fix type should have its own file (e.g., doctor/fix/hooks.go, doctor/fix/sync.go)\n- Display what will be fixed and ask user to confirm (Y/n) before proceeding\n- Support fixing issues like:\n  - Missing or broken git hooks\n  - Sync problems with remote\n  - File permission issues\n  - Any other auto-repairable issues doctor detects\n\nImplementation notes:\n- Maintain separation between detection (existing doctor code) and repair (new fix code)\n- Each fix should be idempotent and safe to run multiple times\n- Provide clear output about what was fixed\n- Log any fixes that fail with actionable error messages","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-ykd9","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Add bd doctor --fix flag to automatically repair issues","updated_at":"2026-02-26T20:45:26Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Stale aspirational items (Clown Show #21 cleanup)","closed_at":"2026-02-27T02:56:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"2e03364aa0be144d814d056d1009b16a3e359b389fec6b91bad6528c10b272b8","created_at":"2025-12-14T22:25:07Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Code review of PR #551 which fixes close_reason persistence bug.\n\n## Summary\nThe PR correctly fixes a bug where close_reason was only stored in the events table, not in the issues.close_reason column. This caused `bd show --json` to return empty close_reason.\n\n## What Was Fixed\n- ‚úÖ CloseIssue now updates both close_reason and closed_at\n- ‚úÖ ReOpenIssue clears both close_reason and closed_at\n- ‚úÖ Comprehensive tests added for both storage and CLI layers\n- ‚úÖ Clear documentation in queries.go about dual storage strategy\n\n## Quality Assessment\n‚úÖ Tests cover both storage layer and CLI JSON output\n‚úÖ Handles reopen case (clearing close_reason)\n‚úÖ Good comments explaining dual-storage design\n‚úÖ No known issues\n\n## Potential Followups\nSee linked issues for suggestions.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-z86n","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"Code Review: PR #551 - Persist close_reason to issues table","updated_at":"2026-02-27T02:56:51Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/polecats/quartz","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-28T00:41:30Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"44f6d166d2aa91eb09ea1c9cac16ec0e3441e0b62c644b7820292a24eca85c94","created_at":"2026-02-26T18:33:39Z","created_by":"mayor","crystallizes":0,"defer_until":null,"description":"Standalone bd users need a simple backup story. Add 'bd backup' command that wraps Dolt backup operations:\n\n- bd backup init \u003cpath\u003e ‚Äî set up a filesystem backup destination (wraps dolt backup add)\n- bd backup sync ‚Äî push to configured backup (wraps dolt backup sync)\n- bd backup restore \u003cpath\u003e ‚Äî restore from a backup\n- bd backup status ‚Äî show last backup time, destination, size\n\nAlso document DoltHub as the recommended cloud remote path for solo users. Git-protocol remotes (git+ssh to GitHub) are not viable ‚Äî 20+ min push times, unbounded git-remote-cache growth, force-push required after any recovery.\n\nTarget audience: solo devs using bd outside Gas Town who want their issues backed up somewhere safe (external drive, NAS, Dropbox, or DoltHub).","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-zafu","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"Implemented: bd backup init \u003cpath\u003e, bd backup sync, enhanced bd backup status with Dolt backup info and database size. Wraps DOLT_BACKUP SQL procedures for standalone user backups to filesystem/DoltHub.","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"bd backup command for standalone users","updated_at":"2026-02-28T00:42:57Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"70abe05bf57bbc6828728ed8299aff13e9d8095283c565ab1cd95b7a6c961cf3","created_at":"2026-02-27T07:45:55Z","created_by":"beads/witness","crystallizes":0,"defer_until":null,"description":"{\"attached_molecule\": \"mol-witness-patrol\", \"nudges\": {}, \"pending_cleanup\": []}","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-zfj","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"steve.yegge@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"pinned","target":"","timeout_ns":0,"title":"witness Handoff","updated_at":"2026-02-27T07:46:15Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"c27e4a64c486d9f3fd710d687e3a5571cc3cde46f0ea97b84562bec0021ef247","created_at":"2026-03-01T05:48:05Z","created_by":"","crystallizes":0,"defer_until":null,"description":"If Mayor started a batch (SWARM_START), check if all polecats have completed.\n\n**Step 1: Find active swarm tracking wisps**\n```bash\nbd list --wisp --labels=swarm --status=open\n```\nIf no active swarm, skip this step.\n\n**Step 2: Count completed polecats for this swarm**\n\nExtract from wisp labels: swarm_id, total, completed, start timestamp.\nCheck how many cleanup wisps have been closed for this swarm's polecats.\n\n**Step 3: If all complete, notify Mayor**\n```bash\ngt mail send mayor/ -s \"SWARM_COMPLETE: \u003cswarm_id\u003e\" -m \"All \u003ctotal\u003e polecats merged.\nDuration: \u003cminutes\u003e minutes\nSwarm: \u003cswarm_id\u003e\"\n\n# Close the swarm tracking wisp\nbd close \u003cswarm-wisp-id\u003e --reason \"All polecats merged\"\n```\n\nNote: Runs every patrol cycle. Notification sent exactly once when all complete.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-0coy","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Check if active swarm is complete","updated_at":"2026-03-01T05:48:05Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"d81ca1af3c484491288322516d7630e31bd9481bcad12a1341bedde2b663c5c8","created_at":"2026-03-01T05:58:36Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Survey all polecats using agent beads (ZFC: trust what agents report).\n\n**Step 1: List polecat agent beads**\n\n```bash\nbd list --type=agent --json\n```\n\nFilter the JSON output for entries where description contains `role_type: polecat`.\nEach polecat agent bead has fields in its description:\n- `role_type: polecat`\n- `rig: \u003crig-name\u003e`\n- `agent_state: running|orphaned|stuck|done`\n- `hook_bead: \u003ccurrent-work-id\u003e`\n\n**Step 2: For each polecat, check agent_state**\n\n| agent_state | Meaning | Action |\n|-------------|---------|--------|\n| running | Actively working | Check progress (Step 3) |\n| orphaned | Crashed before self-nuke | Auto-nuke if clean (Step 3a) |\n| stuck | Self-reported stuck | Handle stuck protocol |\n| done | Work complete | Verify cleanup triggered (see Step 4a) |\n\n**Step 3: For running polecats, assess progress**\n\nCheck the hook_bead field to see what they're working on:\n```bash\nbd show \u003chook_bead\u003e  # See current step/issue\n```\n\nYou can also verify they're responsive:\n```bash\ntmux capture-pane -t gt-\u003crig\u003e-\u003cname\u003e -p | tail -20\n```\n\nLook for:\n- Recent tool activity ‚Üí making progress\n- Inactive at prompt ‚Üí may need nudge\n- Error messages ‚Üí may need help\n\n**Step 3a: For orphaned polecats, auto-nuke if clean**\n\nWhen a polecat has no hook_bead, it likely crashed before running gt done (orphaned). Check if it's safe to nuke:\n\n```bash\n# Check git status in the polecat's worktree\ncd polecats/\u003cname\u003e\ngit status --porcelain         # Should be empty (clean)\ngit log origin/main..HEAD      # Should have no unpushed commits\n```\n\n**If clean** (no uncommitted changes, no unpushed commits):\n```bash\n# Safe to nuke - no work to lose\ngt polecat nuke \u003cname\u003e\n```\nLog the auto-nuke for audit purposes. No escalation needed.\n\n**If dirty** (uncommitted or unpushed work):\n```bash\n# Escalate to Mayor - polecat has work that might be valuable\ngt mail send mayor/ -s \\\"ORPHAN_DIRTY: \u003cpolecat\u003e has uncommitted work\\\" \\\n  -m \\\"Polecat: \u003cname\u003e\nState: orphaned (crashed before self-nuke)\nGit status: \u003cuncommitted-files\u003e\nUnpushed commits: \u003ccount\u003e\n\nPlease advise: recover work or discard?\\\"\n```\n\n**Rationale**: Orphaned polecats with clean git state are pure overhead. They have\nno work and no state worth preserving. Nuking them immediately frees resources\nand reduces noise. Only escalate when there's actual work at risk.\n\n**Step 4: Decide action**\n\n| Observation | Action |\n|-------------|--------|\n| agent_state=running, recent activity | None |\n| agent_state=running, inactive 5-15 min | Gentle nudge |\n| agent_state=running, inactive 15+ min | Direct nudge with deadline |\n| agent_state=stuck | Assess and help or escalate |\n| agent_state=done | Verify cleanup triggered (see Step 4a) |\n\n**Step 4a: Handle agent_state=done**\n\nIn the ephemeral model, polecats with agent_state=done and cleanup_status=clean\nshould already be nuked by HandlePolecatDone. Finding one here indicates:\n\n1. **Stale agent bead** - polecat was nuked but bead remains\n   ```bash\n   # Verify polecat doesn't exist anymore\n   ls polecats/\u003cname\u003e 2\u003e/dev/null || echo \"Already nuked\"\n   ```\n   If nuked, the agent bead is stale. Clean it up or ignore.\n\n2. **Cleanup wisp exists** - polecat has dirty state needing intervention\n   ```bash\n   bd list --wisp --labels=polecat:\u003cname\u003e --status=open\n   ```\n   Process in process-cleanups step.\n\n3. **No wisp, polecat exists** - POLECAT_DONE mail was missed\n   Try auto-nuke directly (ephemeral model):\n   ```bash\n   # Check cleanup_status and nuke if clean\n   gt polecat nuke \u003cname\u003e  # Will fail if dirty\n   ```\n   If nuke fails (dirty state), create cleanup wisp for investigation.\n\n**Step 5: Execute nudges**\n```bash\ngt nudge \u003crig\u003e/polecats/\u003cname\u003e \"How's progress? Need help?\"\n```\n\n**Step 6: Escalate if needed**\n```bash\ngt mail send mayor/ -s \"Escalation: \u003cpolecat\u003e stuck\" \\\n  -m \"Polecat \u003cname\u003e reports stuck. Please intervene.\"\n```\n\n**Parallelism**: Use Task tool subagents to inspect multiple polecats concurrently.\n\n**ZFC Principle**: Trust agent_state from beads. Don't infer state from PID/tmux.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-0ky5","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Inspect all active polecats","updated_at":"2026-03-01T05:58:36Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"c27e4a64c486d9f3fd710d687e3a5571cc3cde46f0ea97b84562bec0021ef247","created_at":"2026-03-01T05:58:36Z","created_by":"","crystallizes":0,"defer_until":null,"description":"If Mayor started a batch (SWARM_START), check if all polecats have completed.\n\n**Step 1: Find active swarm tracking wisps**\n```bash\nbd list --wisp --labels=swarm --status=open\n```\nIf no active swarm, skip this step.\n\n**Step 2: Count completed polecats for this swarm**\n\nExtract from wisp labels: swarm_id, total, completed, start timestamp.\nCheck how many cleanup wisps have been closed for this swarm's polecats.\n\n**Step 3: If all complete, notify Mayor**\n```bash\ngt mail send mayor/ -s \"SWARM_COMPLETE: \u003cswarm_id\u003e\" -m \"All \u003ctotal\u003e polecats merged.\nDuration: \u003cminutes\u003e minutes\nSwarm: \u003cswarm_id\u003e\"\n\n# Close the swarm tracking wisp\nbd close \u003cswarm-wisp-id\u003e --reason \"All polecats merged\"\n```\n\nNote: Runs every patrol cycle. Notification sent exactly once when all complete.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-0xp5","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Check if active swarm is complete","updated_at":"2026-03-01T05:58:36Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/witness","await_id":"","await_type":"","close_reason":"patrol cycle complete: Cycle 7: Rig idle. No polecats, no MRs, no mail. Deacon alive.","closed_at":"2026-03-01T05:58:36Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"3183ecfe2787341fb0cc53af9af9d9271e52b3646f38ca9a4f7b1e60230cd056","created_at":"2026-03-01T05:53:22Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Patrol report: Cycle 7: Rig idle. No polecats, no MRs, no mail. Deacon alive.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-12iu","is_template":0,"issue_type":"epic","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"mol-witness-patrol","updated_at":"2026-03-01T05:58:36Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"7c99aa23cfd9b4bde70cb6c3ccf0835f1a6dfb6072041665b12cc9f26a77a654","created_at":"2026-03-01T05:58:36Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Process cleanup wisps (exception handling for dirty polecats).\n\nIn the ephemeral model, cleanup wisps are only created when a polecat has\ndirty state (uncommitted changes, unpushed commits) that prevented immediate\nnuke. Most polecats are nuked immediately on POLECAT_DONE and never create wisps.\n\n```bash\n# Find all cleanup wisps\nbd list --wisp --labels=cleanup --status=open\n```\n\nIf no wisps, skip this step (most common case in ephemeral model).\n\nFor each cleanup wisp, investigate and resolve the dirty state:\n\n## State: pending (needs investigation)\n\n1. **Extract polecat name** from wisp title/labels\n\n2. **Diagnose the problem**:\n```bash\ncd polecats/\u003cname\u003e\ngit status                    # What's uncommitted?\ngit stash list                # Any stashed work?\ngit log origin/main..HEAD     # Any unpushed commits?\n```\n\n3. **Resolution options**:\n   - **Uncommitted changes**: Commit and push, then nuke\n   - **Stashed work**: Pop and commit, or discard if not valuable\n   - **Unpushed commits**: Push to origin, then nuke\n   - **All valuable work lost**: Escalate to Mayor for recovery\n\n4. **If resolvable locally**: Fix and nuke\n```bash\n# Example: push unpushed commits\ngit push origin HEAD\n\n# Then nuke\ngt polecat nuke \u003cname\u003e\n\n# Close the wisp\nbd close \u003cwisp-id\u003e --reason \"Resolved: pushed commits, nuked\"\n```\n\n5. **If needs escalation**: Send RECOVERY_NEEDED to Mayor\n```bash\ngt mail send mayor/ -s \"RECOVERY_NEEDED \u003crig\u003e/\u003cpolecat\u003e\" \\\n  -m \"Cleanup Status: \u003cstatus\u003e\nBranch: \u003cbranch\u003e\nIssue: \u003cissue-id\u003e\n\nCannot auto-resolve. Please advise.\"\n```\nLeave wisp open until Mayor resolves.\n\n## State: merge-requested (legacy, rare)\n\nThis state was used before the ephemeral model. If found, the polecat is\nwaiting for a MERGED signal. The inbox-check step handles these.\n\n**Parallelism**: Use Task tool subagents to process multiple cleanups concurrently.\nEach cleanup is independent - perfect for parallel execution.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-1ky2","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Process pending cleanup wisps","updated_at":"2026-03-01T05:58:36Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"e8a4b34ce33ec02d2113398c6fdcce6cc146c4d13eeafc65e3dc59d23270e88f","created_at":"2026-03-01T05:48:05Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Verify inbox hygiene before ending patrol cycle.\n\n**Step 1: Check inbox state**\n```bash\ngt mail inbox\n```\n\nIn the ephemeral model, most POLECAT_DONE messages are handled immediately\n(auto-nuke) and archived. Inbox should contain ONLY:\n- Unprocessed messages (just arrived, will handle next cycle)\n- MERGED notifications (informational, archive after reading)\n\n**Step 2: Archive any stale messages**\n\nLook for messages that were processed but not archived:\n- POLECAT_STARTED older than this cycle ‚Üí archive\n- POLECAT_DONE that was auto-nuked ‚Üí should be archived already\n- MERGED notifications ‚Üí archive after acknowledging\n- HELP/Blocked that was escalated ‚Üí archive\n- SWARM_START that created tracking wisp ‚Üí archive\n\n```bash\n# For each stale message found:\ngt mail archive \u003cmessage-id\u003e\n```\n\n**Step 3: Verify cleanup wisp hygiene**\n\nIn the ephemeral model, cleanup wisps should be rare (only for dirty polecats):\n```bash\nbd list --wisp --labels=cleanup --status=open\n```\n\n- state:pending ‚Üí Needs investigation in process-cleanups\n- state:merge-requested ‚Üí Legacy state, handle in inbox-check\n\nIf cleanup wisps are accumulating, investigate why polecats aren't clean.\n\n**Goal**: Inbox should be nearly empty. Cleanup wisps should be rare.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-1v07","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"End-of-cycle inbox hygiene","updated_at":"2026-03-01T05:48:05Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"ead488f77faa5470891d5165d00802ca440a319bab30e836ba891a6b3190044d","created_at":"2026-03-01T05:58:36Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Check inbox and handle messages.\n\n```bash\ngt mail inbox\n```\n\nFor each message:\n\n**POLECAT_STARTED**:\nA new polecat has started working. Acknowledge and archive.\n```bash\n# Acknowledge startup (optional: log for activity tracking)\ngt mail archive \u003cmessage-id\u003e\n```\nNo action needed beyond acknowledgment - archive immediately.\n\n**POLECAT_DONE / LIFECYCLE:Shutdown**:\n\n*EPHEMERAL MODEL*: Polecats are truly ephemeral - done at MR submission,\nrecyclable immediately. Once the branch is pushed (cleanup_status=clean),\nthe polecat can be nuked. The MR lifecycle continues independently in the\nRefinery. If conflicts arise, Refinery creates a NEW conflict-resolution\ntask for a NEW polecat.\n\nPolecat lifecycle: spawning ‚Üí working ‚Üí mr_submitted ‚Üí nuked\nMR lifecycle: created ‚Üí queued ‚Üí processed ‚Üí merged (handled by Refinery)\n\nThe handler (HandlePolecatDone) will:\n1. Check cleanup_status from agent bead\n2. If \"clean\" (branch pushed): AUTO-NUKE immediately, archive mail\n3. If dirty: Create cleanup wisp for manual intervention\n\n```bash\n# The handler does this automatically:\n# - For clean state: gt polecat nuke \u003cname\u003e ‚Üí archive mail\n# - For dirty state: create wisp ‚Üí process in next step\n```\n\nCleanup wisps are only created when something is wrong (uncommitted changes,\nunpushed commits). Most POLECAT_DONE messages result in immediate nuke.\n\n**MERGED**:\nA branch was merged successfully. This is informational in the ephemeral model\nsince the polecat was already nuked after MR submission.\n\nIf a cleanup wisp exists (dirty state), complete the cleanup:\n```bash\n# Find the cleanup wisp for this polecat\nbd list --wisp --labels=polecat:\u003cname\u003e,state:merge-requested --status=open\n\n# If found, proceed with full polecat nuke:\ngt polecat nuke \u003cname\u003e\n\n# Burn the cleanup wisp\nbd close \u003cwisp-id\u003e\n```\nArchive after cleanup is complete.\n\n**HELP / Blocked**:\nAssess the request. Can you help? If not, escalate to Mayor:\n```bash\ngt mail send mayor/ -s \"Escalation: \u003cpolecat\u003e needs help\" -m \"\u003cdetails\u003e\"\n```\nArchive after handling (escalated or resolved):\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**HANDOFF**:\nRead predecessor context. Continue from where they left off.\nArchive after absorbing context:\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**SWARM_START**:\nMayor initiating batch polecat work. Initialize swarm tracking.\n```bash\n# Parse swarm info from mail body: {\"swarm_id\": \"batch-123\", \"beads\": [\"bd-a\", \"bd-b\"]}\nbd create --wisp --title \"swarm:\u003cswarm_id\u003e\" --description \"Tracking batch: \u003cswarm_id\u003e\" --labels swarm,swarm_id:\u003cswarm_id\u003e,total:\u003cN\u003e,completed:0,start:\u003ctimestamp\u003e\n```\nArchive after creating swarm tracking wisp:\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**Hygiene principle**: Archive messages after they're fully processed.\nKeep only: active work, unprocessed requests. Inbox should be near-empty.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-2j9r","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Process witness mail","updated_at":"2026-03-01T05:58:36Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"5ab14df17634a15f81aa6dda2327e0abc60e558936e057cd1b3a2bfd55a667b7","created_at":"2026-03-01T05:53:22Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Ensure the refinery is alive and processing merge requests.\n\n```bash\n# Check if refinery session exists\ngt session status \u003crig\u003e/refinery\n\n# Check for pending merge requests\nbd list --type=merge-request --status=open\n```\n\nIf MRs waiting AND refinery not running:\n```bash\ngt session start \u003crig\u003e/refinery\ngt mail send \u003crig\u003e/refinery -s \"PATROL: Wake up\" -m \"Merge requests in queue. Please process.\"\n```\n\nIf refinery running but queue stale (\u003e30 min), send nudge.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-565v","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Ensure refinery is alive","updated_at":"2026-03-01T05:53:22Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"3260c70b5a3ded2a74852e3822583939822a91499ad18453e258f0783bf03ae7","created_at":"2026-03-01T05:53:22Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Check for expired timer gates and escalate as needed.\n\nTimer gates are async wait conditions with a timeout. When the timeout expires,\nthe gate should be escalated to the overseer for human intervention.\n\n**Step 1: Run timer gate check**\n```bash\nbd gate check --type=timer --escalate\n```\n\nThis command:\n1. Finds all open gate issues with await_type=timer\n2. Checks if `now \u003e created_at + timeout`\n3. Escalates expired gates via `gt escalate` (HIGH severity)\n4. Reports summary of gate status\n\n**Step 2: Review output**\n\nIf expired gates were found and escalated:\n- The escalation creates an audit trail bead\n- Overseer will be notified via mail\n- Gate remains open until manually resolved\n\nIf no expired gates:\n- Continue patrol normally\n\n**Note**: Timer gates do NOT auto-close on expiration. They escalate.\nThis ensures human oversight of timeout conditions.\n\n**Parallelism**: This is a single command, no parallel execution needed.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-59f5","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Check timer gates for expiration","updated_at":"2026-03-01T05:53:22Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"3260c70b5a3ded2a74852e3822583939822a91499ad18453e258f0783bf03ae7","created_at":"2026-03-01T05:58:36Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Check for expired timer gates and escalate as needed.\n\nTimer gates are async wait conditions with a timeout. When the timeout expires,\nthe gate should be escalated to the overseer for human intervention.\n\n**Step 1: Run timer gate check**\n```bash\nbd gate check --type=timer --escalate\n```\n\nThis command:\n1. Finds all open gate issues with await_type=timer\n2. Checks if `now \u003e created_at + timeout`\n3. Escalates expired gates via `gt escalate` (HIGH severity)\n4. Reports summary of gate status\n\n**Step 2: Review output**\n\nIf expired gates were found and escalated:\n- The escalation creates an audit trail bead\n- Overseer will be notified via mail\n- Gate remains open until manually resolved\n\nIf no expired gates:\n- Continue patrol normally\n\n**Note**: Timer gates do NOT auto-close on expiration. They escalate.\nThis ensures human oversight of timeout conditions.\n\n**Parallelism**: This is a single command, no parallel execution needed.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-5xmc","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Check timer gates for expiration","updated_at":"2026-03-01T05:58:36Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"7c99aa23cfd9b4bde70cb6c3ccf0835f1a6dfb6072041665b12cc9f26a77a654","created_at":"2026-03-01T05:53:22Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Process cleanup wisps (exception handling for dirty polecats).\n\nIn the ephemeral model, cleanup wisps are only created when a polecat has\ndirty state (uncommitted changes, unpushed commits) that prevented immediate\nnuke. Most polecats are nuked immediately on POLECAT_DONE and never create wisps.\n\n```bash\n# Find all cleanup wisps\nbd list --wisp --labels=cleanup --status=open\n```\n\nIf no wisps, skip this step (most common case in ephemeral model).\n\nFor each cleanup wisp, investigate and resolve the dirty state:\n\n## State: pending (needs investigation)\n\n1. **Extract polecat name** from wisp title/labels\n\n2. **Diagnose the problem**:\n```bash\ncd polecats/\u003cname\u003e\ngit status                    # What's uncommitted?\ngit stash list                # Any stashed work?\ngit log origin/main..HEAD     # Any unpushed commits?\n```\n\n3. **Resolution options**:\n   - **Uncommitted changes**: Commit and push, then nuke\n   - **Stashed work**: Pop and commit, or discard if not valuable\n   - **Unpushed commits**: Push to origin, then nuke\n   - **All valuable work lost**: Escalate to Mayor for recovery\n\n4. **If resolvable locally**: Fix and nuke\n```bash\n# Example: push unpushed commits\ngit push origin HEAD\n\n# Then nuke\ngt polecat nuke \u003cname\u003e\n\n# Close the wisp\nbd close \u003cwisp-id\u003e --reason \"Resolved: pushed commits, nuked\"\n```\n\n5. **If needs escalation**: Send RECOVERY_NEEDED to Mayor\n```bash\ngt mail send mayor/ -s \"RECOVERY_NEEDED \u003crig\u003e/\u003cpolecat\u003e\" \\\n  -m \"Cleanup Status: \u003cstatus\u003e\nBranch: \u003cbranch\u003e\nIssue: \u003cissue-id\u003e\n\nCannot auto-resolve. Please advise.\"\n```\nLeave wisp open until Mayor resolves.\n\n## State: merge-requested (legacy, rare)\n\nThis state was used before the ephemeral model. If found, the polecat is\nwaiting for a MERGED signal. The inbox-check step handles these.\n\n**Parallelism**: Use Task tool subagents to process multiple cleanups concurrently.\nEach cleanup is independent - perfect for parallel execution.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-6oc5","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Process pending cleanup wisps","updated_at":"2026-03-01T05:53:22Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"d81ca1af3c484491288322516d7630e31bd9481bcad12a1341bedde2b663c5c8","created_at":"2026-03-01T05:53:22Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Survey all polecats using agent beads (ZFC: trust what agents report).\n\n**Step 1: List polecat agent beads**\n\n```bash\nbd list --type=agent --json\n```\n\nFilter the JSON output for entries where description contains `role_type: polecat`.\nEach polecat agent bead has fields in its description:\n- `role_type: polecat`\n- `rig: \u003crig-name\u003e`\n- `agent_state: running|orphaned|stuck|done`\n- `hook_bead: \u003ccurrent-work-id\u003e`\n\n**Step 2: For each polecat, check agent_state**\n\n| agent_state | Meaning | Action |\n|-------------|---------|--------|\n| running | Actively working | Check progress (Step 3) |\n| orphaned | Crashed before self-nuke | Auto-nuke if clean (Step 3a) |\n| stuck | Self-reported stuck | Handle stuck protocol |\n| done | Work complete | Verify cleanup triggered (see Step 4a) |\n\n**Step 3: For running polecats, assess progress**\n\nCheck the hook_bead field to see what they're working on:\n```bash\nbd show \u003chook_bead\u003e  # See current step/issue\n```\n\nYou can also verify they're responsive:\n```bash\ntmux capture-pane -t gt-\u003crig\u003e-\u003cname\u003e -p | tail -20\n```\n\nLook for:\n- Recent tool activity ‚Üí making progress\n- Inactive at prompt ‚Üí may need nudge\n- Error messages ‚Üí may need help\n\n**Step 3a: For orphaned polecats, auto-nuke if clean**\n\nWhen a polecat has no hook_bead, it likely crashed before running gt done (orphaned). Check if it's safe to nuke:\n\n```bash\n# Check git status in the polecat's worktree\ncd polecats/\u003cname\u003e\ngit status --porcelain         # Should be empty (clean)\ngit log origin/main..HEAD      # Should have no unpushed commits\n```\n\n**If clean** (no uncommitted changes, no unpushed commits):\n```bash\n# Safe to nuke - no work to lose\ngt polecat nuke \u003cname\u003e\n```\nLog the auto-nuke for audit purposes. No escalation needed.\n\n**If dirty** (uncommitted or unpushed work):\n```bash\n# Escalate to Mayor - polecat has work that might be valuable\ngt mail send mayor/ -s \\\"ORPHAN_DIRTY: \u003cpolecat\u003e has uncommitted work\\\" \\\n  -m \\\"Polecat: \u003cname\u003e\nState: orphaned (crashed before self-nuke)\nGit status: \u003cuncommitted-files\u003e\nUnpushed commits: \u003ccount\u003e\n\nPlease advise: recover work or discard?\\\"\n```\n\n**Rationale**: Orphaned polecats with clean git state are pure overhead. They have\nno work and no state worth preserving. Nuking them immediately frees resources\nand reduces noise. Only escalate when there's actual work at risk.\n\n**Step 4: Decide action**\n\n| Observation | Action |\n|-------------|--------|\n| agent_state=running, recent activity | None |\n| agent_state=running, inactive 5-15 min | Gentle nudge |\n| agent_state=running, inactive 15+ min | Direct nudge with deadline |\n| agent_state=stuck | Assess and help or escalate |\n| agent_state=done | Verify cleanup triggered (see Step 4a) |\n\n**Step 4a: Handle agent_state=done**\n\nIn the ephemeral model, polecats with agent_state=done and cleanup_status=clean\nshould already be nuked by HandlePolecatDone. Finding one here indicates:\n\n1. **Stale agent bead** - polecat was nuked but bead remains\n   ```bash\n   # Verify polecat doesn't exist anymore\n   ls polecats/\u003cname\u003e 2\u003e/dev/null || echo \"Already nuked\"\n   ```\n   If nuked, the agent bead is stale. Clean it up or ignore.\n\n2. **Cleanup wisp exists** - polecat has dirty state needing intervention\n   ```bash\n   bd list --wisp --labels=polecat:\u003cname\u003e --status=open\n   ```\n   Process in process-cleanups step.\n\n3. **No wisp, polecat exists** - POLECAT_DONE mail was missed\n   Try auto-nuke directly (ephemeral model):\n   ```bash\n   # Check cleanup_status and nuke if clean\n   gt polecat nuke \u003cname\u003e  # Will fail if dirty\n   ```\n   If nuke fails (dirty state), create cleanup wisp for investigation.\n\n**Step 5: Execute nudges**\n```bash\ngt nudge \u003crig\u003e/polecats/\u003cname\u003e \"How's progress? Need help?\"\n```\n\n**Step 6: Escalate if needed**\n```bash\ngt mail send mayor/ -s \"Escalation: \u003cpolecat\u003e stuck\" \\\n  -m \"Polecat \u003cname\u003e reports stuck. Please intervene.\"\n```\n\n**Parallelism**: Use Task tool subagents to inspect multiple polecats concurrently.\n\n**ZFC Principle**: Trust agent_state from beads. Don't infer state from PID/tmux.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-7z50","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Inspect all active polecats","updated_at":"2026-03-01T05:53:22Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"44e90519b5aee3979316ee3ffab195534b0b212e42647b07f58ebc477af1b98e","created_at":"2026-03-01T05:58:36Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Send WITNESS_PING to Deacon for second-order monitoring.\n\nThe Witness fleet collectively monitors Deacon health - this prevents the\n\"who watches the watchers\" problem. If Deacon dies, Witnesses detect it.\n\n**Step 1: Send ping**\n```bash\ngt mail send deacon/ -s \"WITNESS_PING \u003crig\u003e\" -m \"Rig: \u003crig\u003e\nTimestamp: $(date -u +%Y-%m-%dT%H:%M:%SZ)\nPatrol: \u003ccycle-number\u003e\"\n```\n\n**Step 2: Check Deacon health**\n```bash\n# Check Deacon agent bead for last_activity\nbd list --type=agent --json | jq '.[] | select(.description | contains(\"deacon\"))'\n```\n\nLook at the `last_activity` timestamp. If stale (\u003e5 minutes since last update):\n- Deacon may be dead or stuck\n\n**Step 3: Escalate if needed**\n```bash\n# If Deacon appears down\ngt mail send mayor/ -s \"ALERT: Deacon appears unresponsive\" -m \"No Deacon activity for \u003e5 minutes.\nLast seen: \u003ctimestamp\u003e\nWitness: \u003crig\u003e/witness\"\n```\n\nNote: Multiple Witnesses may send this alert. Mayor should handle deduplication.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-epfl","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Ping Deacon for health check","updated_at":"2026-03-01T05:58:36Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"ead488f77faa5470891d5165d00802ca440a319bab30e836ba891a6b3190044d","created_at":"2026-03-01T05:53:22Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Check inbox and handle messages.\n\n```bash\ngt mail inbox\n```\n\nFor each message:\n\n**POLECAT_STARTED**:\nA new polecat has started working. Acknowledge and archive.\n```bash\n# Acknowledge startup (optional: log for activity tracking)\ngt mail archive \u003cmessage-id\u003e\n```\nNo action needed beyond acknowledgment - archive immediately.\n\n**POLECAT_DONE / LIFECYCLE:Shutdown**:\n\n*EPHEMERAL MODEL*: Polecats are truly ephemeral - done at MR submission,\nrecyclable immediately. Once the branch is pushed (cleanup_status=clean),\nthe polecat can be nuked. The MR lifecycle continues independently in the\nRefinery. If conflicts arise, Refinery creates a NEW conflict-resolution\ntask for a NEW polecat.\n\nPolecat lifecycle: spawning ‚Üí working ‚Üí mr_submitted ‚Üí nuked\nMR lifecycle: created ‚Üí queued ‚Üí processed ‚Üí merged (handled by Refinery)\n\nThe handler (HandlePolecatDone) will:\n1. Check cleanup_status from agent bead\n2. If \"clean\" (branch pushed): AUTO-NUKE immediately, archive mail\n3. If dirty: Create cleanup wisp for manual intervention\n\n```bash\n# The handler does this automatically:\n# - For clean state: gt polecat nuke \u003cname\u003e ‚Üí archive mail\n# - For dirty state: create wisp ‚Üí process in next step\n```\n\nCleanup wisps are only created when something is wrong (uncommitted changes,\nunpushed commits). Most POLECAT_DONE messages result in immediate nuke.\n\n**MERGED**:\nA branch was merged successfully. This is informational in the ephemeral model\nsince the polecat was already nuked after MR submission.\n\nIf a cleanup wisp exists (dirty state), complete the cleanup:\n```bash\n# Find the cleanup wisp for this polecat\nbd list --wisp --labels=polecat:\u003cname\u003e,state:merge-requested --status=open\n\n# If found, proceed with full polecat nuke:\ngt polecat nuke \u003cname\u003e\n\n# Burn the cleanup wisp\nbd close \u003cwisp-id\u003e\n```\nArchive after cleanup is complete.\n\n**HELP / Blocked**:\nAssess the request. Can you help? If not, escalate to Mayor:\n```bash\ngt mail send mayor/ -s \"Escalation: \u003cpolecat\u003e needs help\" -m \"\u003cdetails\u003e\"\n```\nArchive after handling (escalated or resolved):\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**HANDOFF**:\nRead predecessor context. Continue from where they left off.\nArchive after absorbing context:\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**SWARM_START**:\nMayor initiating batch polecat work. Initialize swarm tracking.\n```bash\n# Parse swarm info from mail body: {\"swarm_id\": \"batch-123\", \"beads\": [\"bd-a\", \"bd-b\"]}\nbd create --wisp --title \"swarm:\u003cswarm_id\u003e\" --description \"Tracking batch: \u003cswarm_id\u003e\" --labels swarm,swarm_id:\u003cswarm_id\u003e,total:\u003cN\u003e,completed:0,start:\u003ctimestamp\u003e\n```\nArchive after creating swarm tracking wisp:\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**Hygiene principle**: Archive messages after they're fully processed.\nKeep only: active work, unprocessed requests. Inbox should be near-empty.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-gsua","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Process witness mail","updated_at":"2026-03-01T05:53:22Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"e8a4b34ce33ec02d2113398c6fdcce6cc146c4d13eeafc65e3dc59d23270e88f","created_at":"2026-03-01T05:58:36Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Verify inbox hygiene before ending patrol cycle.\n\n**Step 1: Check inbox state**\n```bash\ngt mail inbox\n```\n\nIn the ephemeral model, most POLECAT_DONE messages are handled immediately\n(auto-nuke) and archived. Inbox should contain ONLY:\n- Unprocessed messages (just arrived, will handle next cycle)\n- MERGED notifications (informational, archive after reading)\n\n**Step 2: Archive any stale messages**\n\nLook for messages that were processed but not archived:\n- POLECAT_STARTED older than this cycle ‚Üí archive\n- POLECAT_DONE that was auto-nuked ‚Üí should be archived already\n- MERGED notifications ‚Üí archive after acknowledging\n- HELP/Blocked that was escalated ‚Üí archive\n- SWARM_START that created tracking wisp ‚Üí archive\n\n```bash\n# For each stale message found:\ngt mail archive \u003cmessage-id\u003e\n```\n\n**Step 3: Verify cleanup wisp hygiene**\n\nIn the ephemeral model, cleanup wisps should be rare (only for dirty polecats):\n```bash\nbd list --wisp --labels=cleanup --status=open\n```\n\n- state:pending ‚Üí Needs investigation in process-cleanups\n- state:merge-requested ‚Üí Legacy state, handle in inbox-check\n\nIf cleanup wisps are accumulating, investigate why polecats aren't clean.\n\n**Goal**: Inbox should be nearly empty. Cleanup wisps should be rare.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-j3ih","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"End-of-cycle inbox hygiene","updated_at":"2026-03-01T05:58:36Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"84f3780dec0e69ac7ad64fc9cceea8049250bdec10365d96e75457fd7900e326","created_at":"2026-03-01T05:58:36Z","created_by":"","crystallizes":0,"defer_until":null,"description":"End of patrol cycle decision.\n\n**If context LOW** (can continue patrolling):\n1. Generate a brief summary of this patrol cycle\n2. Squash the current wisp:\n```bash\nbd mol squash \u003cmol-id\u003e --summary \"\u003cpatrol-summary\u003e\"\n```\n3. Create a new patrol wisp:\n```bash\nbd mol wisp mol-witness-patrol\n```\n4. Continue executing from the inbox-check step of the new wisp\n\n**If context HIGH** (approaching limit):\n1. Write handoff mail with notable observations:\n```bash\ngt handoff -s \"Witness patrol handoff\" -m \"\u003cobservations\u003e\"\n```\n2. Exit cleanly - the daemon will respawn a fresh Witness session\n\n**IMPORTANT**: You must either create a new wisp (context LOW) or exit (context HIGH).\nNever leave the session without work on your hook.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-n5vm","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Loop or exit for respawn","updated_at":"2026-03-01T05:58:36Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/witness","await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"3183ecfe2787341fb0cc53af9af9d9271e52b3646f38ca9a4f7b1e60230cd056","created_at":"2026-03-01T05:58:36Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Per-rig worker monitor patrol loop.\n\nThe Witness is the Pit Boss for your rig. You watch polecats, nudge them toward\ncompletion, verify clean git state before kills, and escalate stuck workers.\n\n**You do NOT do implementation work.** Your job is oversight, not coding.\n\n## Ephemeral Polecat Model\n\nPolecats are truly ephemeral - done at MR submission, recyclable immediately:\n\n```\nPolecat lifecycle: spawning ‚Üí working ‚Üí mr_submitted ‚Üí nuked\nMR lifecycle:      created ‚Üí queued ‚Üí processed ‚Üí merged (Refinery handles)\n```\n\nOnce a polecat's branch is pushed (cleanup_status=clean), the polecat can be\nnuked immediately. The MR continues independently in the Refinery. If conflicts\narise, Refinery creates a NEW conflict-resolution task for a NEW polecat.\n\n**Key principle**: Polecat lifecycle is separate from MR lifecycle.\n\n## Design Philosophy\n\nThis patrol follows Gas Town principles:\n- **Discovery over tracking**: Observe reality each cycle, don't maintain state\n- **Events over state**: POLECAT_DONE mail triggers immediate cleanup\n- **Ephemeral by default**: Clean polecats are nuked immediately, no waiting\n- **Cleanup wisps for exceptions**: Only created when intervention needed\n- **Task tool for parallelism**: Subagents inspect polecats, not molecule arms\n\n## Patrol Shape (Linear, Deacon-style)\n\n```\ninbox-check ‚îÄ‚ñ∫ process-cleanups ‚îÄ‚ñ∫ check-refinery ‚îÄ‚ñ∫ survey-workers\n                                                            ‚îÇ\n         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n         ‚ñº\n  check-timer-gates ‚îÄ‚ñ∫ check-swarm ‚îÄ‚ñ∫ ping-deacon ‚îÄ‚ñ∫ patrol-cleanup ‚îÄ‚ñ∫ context-check ‚îÄ‚ñ∫ loop-or-exit\n```\n\nNo dynamic arms. No fanout gates. No persistent nudge counters.\nState is discovered each cycle from reality (tmux, beads, mail).","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-nhuv","is_template":0,"issue_type":"epic","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"hooked","target":"","timeout_ns":0,"title":"mol-witness-patrol","updated_at":"2026-03-01T05:58:36Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"e8a4b34ce33ec02d2113398c6fdcce6cc146c4d13eeafc65e3dc59d23270e88f","created_at":"2026-03-01T05:53:22Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Verify inbox hygiene before ending patrol cycle.\n\n**Step 1: Check inbox state**\n```bash\ngt mail inbox\n```\n\nIn the ephemeral model, most POLECAT_DONE messages are handled immediately\n(auto-nuke) and archived. Inbox should contain ONLY:\n- Unprocessed messages (just arrived, will handle next cycle)\n- MERGED notifications (informational, archive after reading)\n\n**Step 2: Archive any stale messages**\n\nLook for messages that were processed but not archived:\n- POLECAT_STARTED older than this cycle ‚Üí archive\n- POLECAT_DONE that was auto-nuked ‚Üí should be archived already\n- MERGED notifications ‚Üí archive after acknowledging\n- HELP/Blocked that was escalated ‚Üí archive\n- SWARM_START that created tracking wisp ‚Üí archive\n\n```bash\n# For each stale message found:\ngt mail archive \u003cmessage-id\u003e\n```\n\n**Step 3: Verify cleanup wisp hygiene**\n\nIn the ephemeral model, cleanup wisps should be rare (only for dirty polecats):\n```bash\nbd list --wisp --labels=cleanup --status=open\n```\n\n- state:pending ‚Üí Needs investigation in process-cleanups\n- state:merge-requested ‚Üí Legacy state, handle in inbox-check\n\nIf cleanup wisps are accumulating, investigate why polecats aren't clean.\n\n**Goal**: Inbox should be nearly empty. Cleanup wisps should be rare.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-ny1i","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"End-of-cycle inbox hygiene","updated_at":"2026-03-01T05:53:22Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"a195205fcbce7b83708d8b22669b5e20a2e18dfa3d680bb897c573522b14f801","created_at":"2026-03-01T05:48:05Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Check own context usage.\n\nIf context is HIGH (\u003e80%):\n- Ensure any notes are written to handoff mail\n- Prepare for session restart\n\nIf context is LOW:\n- Can continue patrolling","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-osfo","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Check own context limit","updated_at":"2026-03-01T05:48:05Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"84f3780dec0e69ac7ad64fc9cceea8049250bdec10365d96e75457fd7900e326","created_at":"2026-03-01T05:48:05Z","created_by":"","crystallizes":0,"defer_until":null,"description":"End of patrol cycle decision.\n\n**If context LOW** (can continue patrolling):\n1. Generate a brief summary of this patrol cycle\n2. Squash the current wisp:\n```bash\nbd mol squash \u003cmol-id\u003e --summary \"\u003cpatrol-summary\u003e\"\n```\n3. Create a new patrol wisp:\n```bash\nbd mol wisp mol-witness-patrol\n```\n4. Continue executing from the inbox-check step of the new wisp\n\n**If context HIGH** (approaching limit):\n1. Write handoff mail with notable observations:\n```bash\ngt handoff -s \"Witness patrol handoff\" -m \"\u003cobservations\u003e\"\n```\n2. Exit cleanly - the daemon will respawn a fresh Witness session\n\n**IMPORTANT**: You must either create a new wisp (context LOW) or exit (context HIGH).\nNever leave the session without work on your hook.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-pd7m","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Loop or exit for respawn","updated_at":"2026-03-01T05:48:05Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"84f3780dec0e69ac7ad64fc9cceea8049250bdec10365d96e75457fd7900e326","created_at":"2026-03-01T05:53:22Z","created_by":"","crystallizes":0,"defer_until":null,"description":"End of patrol cycle decision.\n\n**If context LOW** (can continue patrolling):\n1. Generate a brief summary of this patrol cycle\n2. Squash the current wisp:\n```bash\nbd mol squash \u003cmol-id\u003e --summary \"\u003cpatrol-summary\u003e\"\n```\n3. Create a new patrol wisp:\n```bash\nbd mol wisp mol-witness-patrol\n```\n4. Continue executing from the inbox-check step of the new wisp\n\n**If context HIGH** (approaching limit):\n1. Write handoff mail with notable observations:\n```bash\ngt handoff -s \"Witness patrol handoff\" -m \"\u003cobservations\u003e\"\n```\n2. Exit cleanly - the daemon will respawn a fresh Witness session\n\n**IMPORTANT**: You must either create a new wisp (context LOW) or exit (context HIGH).\nNever leave the session without work on your hook.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-popx","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Loop or exit for respawn","updated_at":"2026-03-01T05:53:22Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"5ab14df17634a15f81aa6dda2327e0abc60e558936e057cd1b3a2bfd55a667b7","created_at":"2026-03-01T05:48:05Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Ensure the refinery is alive and processing merge requests.\n\n```bash\n# Check if refinery session exists\ngt session status \u003crig\u003e/refinery\n\n# Check for pending merge requests\nbd list --type=merge-request --status=open\n```\n\nIf MRs waiting AND refinery not running:\n```bash\ngt session start \u003crig\u003e/refinery\ngt mail send \u003crig\u003e/refinery -s \"PATROL: Wake up\" -m \"Merge requests in queue. Please process.\"\n```\n\nIf refinery running but queue stale (\u003e30 min), send nudge.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-rrk4","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Ensure refinery is alive","updated_at":"2026-03-01T05:48:05Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"5ab14df17634a15f81aa6dda2327e0abc60e558936e057cd1b3a2bfd55a667b7","created_at":"2026-03-01T05:58:36Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Ensure the refinery is alive and processing merge requests.\n\n```bash\n# Check if refinery session exists\ngt session status \u003crig\u003e/refinery\n\n# Check for pending merge requests\nbd list --type=merge-request --status=open\n```\n\nIf MRs waiting AND refinery not running:\n```bash\ngt session start \u003crig\u003e/refinery\ngt mail send \u003crig\u003e/refinery -s \"PATROL: Wake up\" -m \"Merge requests in queue. Please process.\"\n```\n\nIf refinery running but queue stale (\u003e30 min), send nudge.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-spao","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Ensure refinery is alive","updated_at":"2026-03-01T05:58:36Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"c27e4a64c486d9f3fd710d687e3a5571cc3cde46f0ea97b84562bec0021ef247","created_at":"2026-03-01T05:53:22Z","created_by":"","crystallizes":0,"defer_until":null,"description":"If Mayor started a batch (SWARM_START), check if all polecats have completed.\n\n**Step 1: Find active swarm tracking wisps**\n```bash\nbd list --wisp --labels=swarm --status=open\n```\nIf no active swarm, skip this step.\n\n**Step 2: Count completed polecats for this swarm**\n\nExtract from wisp labels: swarm_id, total, completed, start timestamp.\nCheck how many cleanup wisps have been closed for this swarm's polecats.\n\n**Step 3: If all complete, notify Mayor**\n```bash\ngt mail send mayor/ -s \"SWARM_COMPLETE: \u003cswarm_id\u003e\" -m \"All \u003ctotal\u003e polecats merged.\nDuration: \u003cminutes\u003e minutes\nSwarm: \u003cswarm_id\u003e\"\n\n# Close the swarm tracking wisp\nbd close \u003cswarm-wisp-id\u003e --reason \"All polecats merged\"\n```\n\nNote: Runs every patrol cycle. Notification sent exactly once when all complete.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-sxfs","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Check if active swarm is complete","updated_at":"2026-03-01T05:53:22Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"44e90519b5aee3979316ee3ffab195534b0b212e42647b07f58ebc477af1b98e","created_at":"2026-03-01T05:48:05Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Send WITNESS_PING to Deacon for second-order monitoring.\n\nThe Witness fleet collectively monitors Deacon health - this prevents the\n\"who watches the watchers\" problem. If Deacon dies, Witnesses detect it.\n\n**Step 1: Send ping**\n```bash\ngt mail send deacon/ -s \"WITNESS_PING \u003crig\u003e\" -m \"Rig: \u003crig\u003e\nTimestamp: $(date -u +%Y-%m-%dT%H:%M:%SZ)\nPatrol: \u003ccycle-number\u003e\"\n```\n\n**Step 2: Check Deacon health**\n```bash\n# Check Deacon agent bead for last_activity\nbd list --type=agent --json | jq '.[] | select(.description | contains(\"deacon\"))'\n```\n\nLook at the `last_activity` timestamp. If stale (\u003e5 minutes since last update):\n- Deacon may be dead or stuck\n\n**Step 3: Escalate if needed**\n```bash\n# If Deacon appears down\ngt mail send mayor/ -s \"ALERT: Deacon appears unresponsive\" -m \"No Deacon activity for \u003e5 minutes.\nLast seen: \u003ctimestamp\u003e\nWitness: \u003crig\u003e/witness\"\n```\n\nNote: Multiple Witnesses may send this alert. Mayor should handle deduplication.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-t02y","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Ping Deacon for health check","updated_at":"2026-03-01T05:48:05Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"a195205fcbce7b83708d8b22669b5e20a2e18dfa3d680bb897c573522b14f801","created_at":"2026-03-01T05:53:22Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Check own context usage.\n\nIf context is HIGH (\u003e80%):\n- Ensure any notes are written to handoff mail\n- Prepare for session restart\n\nIf context is LOW:\n- Can continue patrolling","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-tj6i","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Check own context limit","updated_at":"2026-03-01T05:53:22Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/witness","await_id":"","await_type":"","close_reason":"patrol cycle complete: Cycle 6: Rig idle. No polecats, no MRs, no mail. Deacon alive. Max backoff.","closed_at":"2026-03-01T05:53:22Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"3183ecfe2787341fb0cc53af9af9d9271e52b3646f38ca9a4f7b1e60230cd056","created_at":"2026-03-01T05:48:05Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Patrol report: Cycle 6: Rig idle. No polecats, no MRs, no mail. Deacon alive. Max backoff.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-u6y0","is_template":0,"issue_type":"epic","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"closed","target":"","timeout_ns":0,"title":"mol-witness-patrol","updated_at":"2026-03-01T05:53:22Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"44e90519b5aee3979316ee3ffab195534b0b212e42647b07f58ebc477af1b98e","created_at":"2026-03-01T05:53:22Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Send WITNESS_PING to Deacon for second-order monitoring.\n\nThe Witness fleet collectively monitors Deacon health - this prevents the\n\"who watches the watchers\" problem. If Deacon dies, Witnesses detect it.\n\n**Step 1: Send ping**\n```bash\ngt mail send deacon/ -s \"WITNESS_PING \u003crig\u003e\" -m \"Rig: \u003crig\u003e\nTimestamp: $(date -u +%Y-%m-%dT%H:%M:%SZ)\nPatrol: \u003ccycle-number\u003e\"\n```\n\n**Step 2: Check Deacon health**\n```bash\n# Check Deacon agent bead for last_activity\nbd list --type=agent --json | jq '.[] | select(.description | contains(\"deacon\"))'\n```\n\nLook at the `last_activity` timestamp. If stale (\u003e5 minutes since last update):\n- Deacon may be dead or stuck\n\n**Step 3: Escalate if needed**\n```bash\n# If Deacon appears down\ngt mail send mayor/ -s \"ALERT: Deacon appears unresponsive\" -m \"No Deacon activity for \u003e5 minutes.\nLast seen: \u003ctimestamp\u003e\nWitness: \u003crig\u003e/witness\"\n```\n\nNote: Multiple Witnesses may send this alert. Mayor should handle deduplication.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-unhg","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Ping Deacon for health check","updated_at":"2026-03-01T05:53:22Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"3260c70b5a3ded2a74852e3822583939822a91499ad18453e258f0783bf03ae7","created_at":"2026-03-01T05:48:05Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Check for expired timer gates and escalate as needed.\n\nTimer gates are async wait conditions with a timeout. When the timeout expires,\nthe gate should be escalated to the overseer for human intervention.\n\n**Step 1: Run timer gate check**\n```bash\nbd gate check --type=timer --escalate\n```\n\nThis command:\n1. Finds all open gate issues with await_type=timer\n2. Checks if `now \u003e created_at + timeout`\n3. Escalates expired gates via `gt escalate` (HIGH severity)\n4. Reports summary of gate status\n\n**Step 2: Review output**\n\nIf expired gates were found and escalated:\n- The escalation creates an audit trail bead\n- Overseer will be notified via mail\n- Gate remains open until manually resolved\n\nIf no expired gates:\n- Continue patrol normally\n\n**Note**: Timer gates do NOT auto-close on expiration. They escalate.\nThis ensures human oversight of timeout conditions.\n\n**Parallelism**: This is a single command, no parallel execution needed.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-uz54","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Check timer gates for expiration","updated_at":"2026-03-01T05:48:05Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"beads/refinery","await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"9ab01b8342cbb535eb92efe264b986664239bbe4ffeee5a800fb4f18b0006c3e","created_at":"2026-02-26T11:29:08Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Merge queue processor patrol loop.\n\nThe Refinery is the Engineer in the engine room. You process polecat branches, merging them to main one at a time with sequential rebasing.\n\n**The Scotty Test**: Before proceeding past any failure, ask yourself: \"Would Scotty walk past a warp core leak because it existed before his shift?\"\n\n## Merge Flow\n\nThe Refinery receives MERGE_READY mail from Witnesses when polecats complete work:\n\n```\nWitness                    Refinery                      Git\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGE_READY              ‚îÇ                           ‚îÇ\n   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (verify branch)                   ‚îÇ\n   ‚îÇ                          ‚îÇ fetch \u0026 rebase            ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (run tests)                       ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ                    (if pass)                         ‚îÇ\n   ‚îÇ                          ‚îÇ merge \u0026 push              ‚îÇ\n   ‚îÇ                          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\u003e‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n   ‚îÇ MERGED                   ‚îÇ                           ‚îÇ\n   ‚îÇ\u003c‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                           ‚îÇ\n   ‚îÇ                          ‚îÇ                           ‚îÇ\n```\n\nAfter successful merge, Refinery sends MERGED mail back to Witness so it can\ncomplete cleanup (nuke the polecat worktree).","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-w13866","is_template":0,"issue_type":"epic","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"pinned","target":"","timeout_ns":0,"title":"mol-refinery-patrol","updated_at":"2026-02-27T10:12:04Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"7c99aa23cfd9b4bde70cb6c3ccf0835f1a6dfb6072041665b12cc9f26a77a654","created_at":"2026-03-01T05:48:05Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Process cleanup wisps (exception handling for dirty polecats).\n\nIn the ephemeral model, cleanup wisps are only created when a polecat has\ndirty state (uncommitted changes, unpushed commits) that prevented immediate\nnuke. Most polecats are nuked immediately on POLECAT_DONE and never create wisps.\n\n```bash\n# Find all cleanup wisps\nbd list --wisp --labels=cleanup --status=open\n```\n\nIf no wisps, skip this step (most common case in ephemeral model).\n\nFor each cleanup wisp, investigate and resolve the dirty state:\n\n## State: pending (needs investigation)\n\n1. **Extract polecat name** from wisp title/labels\n\n2. **Diagnose the problem**:\n```bash\ncd polecats/\u003cname\u003e\ngit status                    # What's uncommitted?\ngit stash list                # Any stashed work?\ngit log origin/main..HEAD     # Any unpushed commits?\n```\n\n3. **Resolution options**:\n   - **Uncommitted changes**: Commit and push, then nuke\n   - **Stashed work**: Pop and commit, or discard if not valuable\n   - **Unpushed commits**: Push to origin, then nuke\n   - **All valuable work lost**: Escalate to Mayor for recovery\n\n4. **If resolvable locally**: Fix and nuke\n```bash\n# Example: push unpushed commits\ngit push origin HEAD\n\n# Then nuke\ngt polecat nuke \u003cname\u003e\n\n# Close the wisp\nbd close \u003cwisp-id\u003e --reason \"Resolved: pushed commits, nuked\"\n```\n\n5. **If needs escalation**: Send RECOVERY_NEEDED to Mayor\n```bash\ngt mail send mayor/ -s \"RECOVERY_NEEDED \u003crig\u003e/\u003cpolecat\u003e\" \\\n  -m \"Cleanup Status: \u003cstatus\u003e\nBranch: \u003cbranch\u003e\nIssue: \u003cissue-id\u003e\n\nCannot auto-resolve. Please advise.\"\n```\nLeave wisp open until Mayor resolves.\n\n## State: merge-requested (legacy, rare)\n\nThis state was used before the ephemeral model. If found, the polecat is\nwaiting for a MERGED signal. The inbox-check step handles these.\n\n**Parallelism**: Use Task tool subagents to process multiple cleanups concurrently.\nEach cleanup is independent - perfect for parallel execution.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-y5qe","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Process pending cleanup wisps","updated_at":"2026-03-01T05:48:05Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"d81ca1af3c484491288322516d7630e31bd9481bcad12a1341bedde2b663c5c8","created_at":"2026-03-01T05:48:05Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Survey all polecats using agent beads (ZFC: trust what agents report).\n\n**Step 1: List polecat agent beads**\n\n```bash\nbd list --type=agent --json\n```\n\nFilter the JSON output for entries where description contains `role_type: polecat`.\nEach polecat agent bead has fields in its description:\n- `role_type: polecat`\n- `rig: \u003crig-name\u003e`\n- `agent_state: running|orphaned|stuck|done`\n- `hook_bead: \u003ccurrent-work-id\u003e`\n\n**Step 2: For each polecat, check agent_state**\n\n| agent_state | Meaning | Action |\n|-------------|---------|--------|\n| running | Actively working | Check progress (Step 3) |\n| orphaned | Crashed before self-nuke | Auto-nuke if clean (Step 3a) |\n| stuck | Self-reported stuck | Handle stuck protocol |\n| done | Work complete | Verify cleanup triggered (see Step 4a) |\n\n**Step 3: For running polecats, assess progress**\n\nCheck the hook_bead field to see what they're working on:\n```bash\nbd show \u003chook_bead\u003e  # See current step/issue\n```\n\nYou can also verify they're responsive:\n```bash\ntmux capture-pane -t gt-\u003crig\u003e-\u003cname\u003e -p | tail -20\n```\n\nLook for:\n- Recent tool activity ‚Üí making progress\n- Inactive at prompt ‚Üí may need nudge\n- Error messages ‚Üí may need help\n\n**Step 3a: For orphaned polecats, auto-nuke if clean**\n\nWhen a polecat has no hook_bead, it likely crashed before running gt done (orphaned). Check if it's safe to nuke:\n\n```bash\n# Check git status in the polecat's worktree\ncd polecats/\u003cname\u003e\ngit status --porcelain         # Should be empty (clean)\ngit log origin/main..HEAD      # Should have no unpushed commits\n```\n\n**If clean** (no uncommitted changes, no unpushed commits):\n```bash\n# Safe to nuke - no work to lose\ngt polecat nuke \u003cname\u003e\n```\nLog the auto-nuke for audit purposes. No escalation needed.\n\n**If dirty** (uncommitted or unpushed work):\n```bash\n# Escalate to Mayor - polecat has work that might be valuable\ngt mail send mayor/ -s \\\"ORPHAN_DIRTY: \u003cpolecat\u003e has uncommitted work\\\" \\\n  -m \\\"Polecat: \u003cname\u003e\nState: orphaned (crashed before self-nuke)\nGit status: \u003cuncommitted-files\u003e\nUnpushed commits: \u003ccount\u003e\n\nPlease advise: recover work or discard?\\\"\n```\n\n**Rationale**: Orphaned polecats with clean git state are pure overhead. They have\nno work and no state worth preserving. Nuking them immediately frees resources\nand reduces noise. Only escalate when there's actual work at risk.\n\n**Step 4: Decide action**\n\n| Observation | Action |\n|-------------|--------|\n| agent_state=running, recent activity | None |\n| agent_state=running, inactive 5-15 min | Gentle nudge |\n| agent_state=running, inactive 15+ min | Direct nudge with deadline |\n| agent_state=stuck | Assess and help or escalate |\n| agent_state=done | Verify cleanup triggered (see Step 4a) |\n\n**Step 4a: Handle agent_state=done**\n\nIn the ephemeral model, polecats with agent_state=done and cleanup_status=clean\nshould already be nuked by HandlePolecatDone. Finding one here indicates:\n\n1. **Stale agent bead** - polecat was nuked but bead remains\n   ```bash\n   # Verify polecat doesn't exist anymore\n   ls polecats/\u003cname\u003e 2\u003e/dev/null || echo \"Already nuked\"\n   ```\n   If nuked, the agent bead is stale. Clean it up or ignore.\n\n2. **Cleanup wisp exists** - polecat has dirty state needing intervention\n   ```bash\n   bd list --wisp --labels=polecat:\u003cname\u003e --status=open\n   ```\n   Process in process-cleanups step.\n\n3. **No wisp, polecat exists** - POLECAT_DONE mail was missed\n   Try auto-nuke directly (ephemeral model):\n   ```bash\n   # Check cleanup_status and nuke if clean\n   gt polecat nuke \u003cname\u003e  # Will fail if dirty\n   ```\n   If nuke fails (dirty state), create cleanup wisp for investigation.\n\n**Step 5: Execute nudges**\n```bash\ngt nudge \u003crig\u003e/polecats/\u003cname\u003e \"How's progress? Need help?\"\n```\n\n**Step 6: Escalate if needed**\n```bash\ngt mail send mayor/ -s \"Escalation: \u003cpolecat\u003e stuck\" \\\n  -m \"Polecat \u003cname\u003e reports stuck. Please intervene.\"\n```\n\n**Parallelism**: Use Task tool subagents to inspect multiple polecats concurrently.\n\n**ZFC Principle**: Trust agent_state from beads. Don't infer state from PID/tmux.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-y9g5","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Inspect all active polecats","updated_at":"2026-03-01T05:48:05Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"a195205fcbce7b83708d8b22669b5e20a2e18dfa3d680bb897c573522b14f801","created_at":"2026-03-01T05:58:36Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Check own context usage.\n\nIf context is HIGH (\u003e80%):\n- Ensure any notes are written to handoff mail\n- Prepare for session restart\n\nIf context is LOW:\n- Can continue patrolling","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-yo44","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Check own context limit","updated_at":"2026-03-01T05:58:36Z","waiters":"","wisp_type":"","work_type":""}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"ead488f77faa5470891d5165d00802ca440a319bab30e836ba891a6b3190044d","created_at":"2026-03-01T05:48:05Z","created_by":"","crystallizes":0,"defer_until":null,"description":"Check inbox and handle messages.\n\n```bash\ngt mail inbox\n```\n\nFor each message:\n\n**POLECAT_STARTED**:\nA new polecat has started working. Acknowledge and archive.\n```bash\n# Acknowledge startup (optional: log for activity tracking)\ngt mail archive \u003cmessage-id\u003e\n```\nNo action needed beyond acknowledgment - archive immediately.\n\n**POLECAT_DONE / LIFECYCLE:Shutdown**:\n\n*EPHEMERAL MODEL*: Polecats are truly ephemeral - done at MR submission,\nrecyclable immediately. Once the branch is pushed (cleanup_status=clean),\nthe polecat can be nuked. The MR lifecycle continues independently in the\nRefinery. If conflicts arise, Refinery creates a NEW conflict-resolution\ntask for a NEW polecat.\n\nPolecat lifecycle: spawning ‚Üí working ‚Üí mr_submitted ‚Üí nuked\nMR lifecycle: created ‚Üí queued ‚Üí processed ‚Üí merged (handled by Refinery)\n\nThe handler (HandlePolecatDone) will:\n1. Check cleanup_status from agent bead\n2. If \"clean\" (branch pushed): AUTO-NUKE immediately, archive mail\n3. If dirty: Create cleanup wisp for manual intervention\n\n```bash\n# The handler does this automatically:\n# - For clean state: gt polecat nuke \u003cname\u003e ‚Üí archive mail\n# - For dirty state: create wisp ‚Üí process in next step\n```\n\nCleanup wisps are only created when something is wrong (uncommitted changes,\nunpushed commits). Most POLECAT_DONE messages result in immediate nuke.\n\n**MERGED**:\nA branch was merged successfully. This is informational in the ephemeral model\nsince the polecat was already nuked after MR submission.\n\nIf a cleanup wisp exists (dirty state), complete the cleanup:\n```bash\n# Find the cleanup wisp for this polecat\nbd list --wisp --labels=polecat:\u003cname\u003e,state:merge-requested --status=open\n\n# If found, proceed with full polecat nuke:\ngt polecat nuke \u003cname\u003e\n\n# Burn the cleanup wisp\nbd close \u003cwisp-id\u003e\n```\nArchive after cleanup is complete.\n\n**HELP / Blocked**:\nAssess the request. Can you help? If not, escalate to Mayor:\n```bash\ngt mail send mayor/ -s \"Escalation: \u003cpolecat\u003e needs help\" -m \"\u003cdetails\u003e\"\n```\nArchive after handling (escalated or resolved):\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**HANDOFF**:\nRead predecessor context. Continue from where they left off.\nArchive after absorbing context:\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**SWARM_START**:\nMayor initiating batch polecat work. Initialize swarm tracking.\n```bash\n# Parse swarm info from mail body: {\"swarm_id\": \"batch-123\", \"beads\": [\"bd-a\", \"bd-b\"]}\nbd create --wisp --title \"swarm:\u003cswarm_id\u003e\" --description \"Tracking batch: \u003cswarm_id\u003e\" --labels swarm,swarm_id:\u003cswarm_id\u003e,total:\u003cN\u003e,completed:0,start:\u003ctimestamp\u003e\n```\nArchive after creating swarm tracking wisp:\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**Hygiene principle**: Archive messages after they're fully processed.\nKeep only: active work, unprocessed requests. Inbox should be near-empty.","design":"","due_at":null,"ephemeral":1,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"bd-wisp-z510","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":"","source_system":"","spec_id":"","status":"open","target":"","timeout_ns":0,"title":"Process witness mail","updated_at":"2026-03-01T05:48:05Z","waiters":"","wisp_type":"","work_type":""}
